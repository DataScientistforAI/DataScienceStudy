
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>비선형 시계열 알고리즘 &#8212; Data Science Study</title>
    
  <link rel="stylesheet" href="../_static/css/index.73d71520a4ca3b99cfee5594769eaaae.css">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../_static/sphinx-book-theme.40e2e510f6b7d1648584402491bb10fe.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.3da636dd464baa7582d2.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.d31b09fe5c1d09cb49b26a786de4a05d.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="MyST cheat sheet" href="../reference/cheatsheet.html" />
    <link rel="prev" title="기계학습(Machine Learning) 알고리즘" href="3_Algorithms_ML_TS_Linear.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../index.html">
  
  
  <h1 class="site-logo" id="site-title">Data Science Study</h1>
  
</a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../intro.html">
   Books with Jupyter
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Get started
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../start/overview.html">
   Overview
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../start/build.html">
   Build your book
  </a>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../start/publish.html">
   Publish your book online
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../publish/gh-pages.html">
     GitHub Pages and Actions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../publish/netlify.html">
     Publish with Netlify
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../customize/config.html">
   Configure book settings
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../customize/toc.html">
   Table of contents structure
  </a>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../file-types/index.html">
   Types of content source files
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../file-types/markdown.html">
     Markdown files
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../file-types/notebooks.html">
     Jupyter Notebook files
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../file-types/myst-notebooks.html">
     Notebooks written entirely in Markdown
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../file-types/restructuredtext.html">
     reStructuredText files
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Write book content
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../content/myst.html">
   MyST Markdown overview
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../content/content-blocks.html">
   Special content blocks
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../content/citations.html">
   References and citations
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../content/math.html">
   Math and equations
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../content/figures.html">
   Images and figures
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../content/layout.html">
   Control the page layout
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../content/execute.html">
   Execute and cache your pages
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../content/code-outputs.html">
   Formatting code outputs
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Make your book interactive
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../interactive/launchbuttons.html">
   Launch buttons for interactivity
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../interactive/hiding.html">
   Hide or remove content
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../interactive/interactive.html">
   Interactive data visualizations
  </a>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../interactive/comments.html">
   Commenting and annotating
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../interactive/comments/hypothesis.html">
     Hypothesis
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../interactive/comments/utterances.html">
     Utterances
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Advanced and miscellaneous
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../advanced/pdf.html">
   PDFs for your book
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../advanced/sphinx.html">
   Custom Sphinx configuration
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../advanced/advanced.html">
   How-to and FAQ
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../contribute/intro.html">
   Contribute to Jupyter Book
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Analysis of Time Series Data
 </span>
</p>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="1_Data_Analysis_Cycle.html">
   데이터 분석의 단계별 목적 이해하기 (분석 싸이클 이해)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="1_Data_Analysis_Cycle.html#id5">
   분석을 이해하고 공감하는 자세 및 방향
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="1_Data_Analysis_Cycle.html#id10">
   분석 단계별 의사결정을 위한 수학/통계적 언어를 이해하기
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2_Learning_TimeSeries.html">
   학습방향과 알고리즘(Learning Style and Algorithms)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2_Learning_TimeSeries.html#id2">
   시계열 데이터/분석과 기계학습의 차이
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2_Learning_TimeSeries.html#id8">
   (시계열) 회귀분석 요약
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2_Learning_TimeSeries.html#id12">
   시계열 분석
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="3_Algorithms_ML_TS_Linear.html">
   기계학습(Machine Learning) 알고리즘
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="3_Algorithms_ML_TS_Linear.html#id6">
   시계열 알고리즘
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   비선형 시계열 알고리즘
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="#id9">
   다변량 시계열 알고리즘
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Reference
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference external" href="https://executablebooks.org/en/latest/gallery.html">
   Gallery of Jupyter Books
   <i class="fas fa-external-link-alt">
   </i>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../reference/cheatsheet.html">
   MyST cheat sheet
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../reference/cli.html">
   The command-line interface
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../reference/glossary.html">
   Glossary
  </a>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/TimeSeriesData/4_Algorithms_TS_NonLinear.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

        <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/DataScientistforAI/DataScienceStudy"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/DataScientistforAI/DataScienceStudy/issues/new?title=Issue%20on%20page%20%2FTimeSeriesData/4_Algorithms_TS_NonLinear.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/DataScientistforAI/DataScienceStudy/master?urlpath=tree/TimeSeriesData/4_Algorithms_TS_NonLinear.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <a class="colab-button" href="https://colab.research.google.com"/github/DataScientistforAI/DataScienceStudy/blob/master/TimeSeriesData/4_Algorithms_TS_NonLinear.ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Launch Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="../_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        
    </div>
</div>

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   비선형 시계열 알고리즘
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#state-space-models">
     상태 공간 모형(State Space Models)
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#simple-exponential-smoothing">
       지수평활법(Simple Exponential Smoothing)
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#by-holt">
       선형 추세 알고리즘 by Holt
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#by-holt-winter">
       계절 알고리즘 by Holt-Winter
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id2">
       지수평활법 알고리즘 분류 요약
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#ets-error-trend-seasonal">
       ETS(Error/Trend/Seasonal) 알고리즘
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#arima">
       상태공간 모형과 ARIMA 모형의 관계
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#local-level-model">
         로컬레벨 모형(Local Level Model)
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#id3">
         실습: 로컬레벨 모형 데이터생성 및 이해
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#id4">
         로컬선형레벨 모형
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#id5">
         실습: 로컬선형레벨 모형 데이터생성 및 이해
        </a>
       </li>
      </ul>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id6">
       상태공간모형 기반의 시계열 “구조화모형”
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#id7">
         실습: 구조화모형을 사용한 성분 분리
        </a>
       </li>
      </ul>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id8">
       확장 알고리즘 및 응용 예시
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#hmm">
         실습: HMM 데이터생성 및 이해
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#kalman-filter">
         실습: Kalman Filter 데이터생성 및 이해
        </a>
       </li>
      </ul>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id9">
   다변량 시계열 알고리즘
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#vector-autoregressive-model">
     벡터자기회귀 모형(Vector Autoregressive Model)
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#var">
       VAR 모듈 정리
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id10">
       실습: VAR 데이터생성 및 이해
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id11">
       실습: 거시경제 VAR 모형화 및 해석
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#granger-causality-model">
     그래인저 인과관계 모형(Granger Causality Model)
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id12">
       인과관계? 상관관계?
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#granger-causality">
       Granger Causality 이해
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#granger">
       실습: 닭과 달걀의 생산량을 통한 Granger 인과관계 이해
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id13">
       실습: 삼성전자와 삼성전자 우선주 Granger 인과관계 이해
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#cointegration-model">
     공적분 모형(Cointegration Model)
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#cointegration">
       실습: Cointegration 데이터 생성 및 이해
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id14">
       실습: 페어 트레이딩 Cointegration 모형화 및 해석
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
</ul>

        </nav>
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <center><img src='Image/Contents_Part4.png' width='800'></center><div class="section" id="id1">
<h1>비선형 시계열 알고리즘<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h1>
<div class="section" id="state-space-models">
<h2>상태 공간 모형(State Space Models)<a class="headerlink" href="#state-space-models" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><p><strong>“시계열 생성 구조를 관측식(Observation Equation)과 상태 전이식(State Transition Equation) 두 개의 수식으로 정의하는 시계열 모형”</strong></p>
<ul class="simple">
<li><p><strong>관측식(Observation Equation)</strong><br />
: 현재의 상태 <span class="math notranslate nohighlight">\(x_t\)</span>와 잡음(에러) <span class="math notranslate nohighlight">\(\upsilon_t\)</span>에 의해 실제로 측정가능한 출력 <span class="math notranslate nohighlight">\(y_t\)</span>를 생성하는 관계식</p></li>
</ul>
</div></blockquote>
<p>\begin{align*}
y_t = f(x_t, \upsilon_t)<br />
\end{align*}</p>
<blockquote>
<div><ul class="simple">
<li><p><strong>상태 전이식(State Transition Equation)</strong><br />
: 이전의 상태 <span class="math notranslate nohighlight">\(x_{t-1}\)</span>와 현재 생성된 잡음(에러) <span class="math notranslate nohighlight">\(w_t\)</span>에 의해 현재의 상태 <span class="math notranslate nohighlight">\(x_t\)</span>가 생성되는 관계식</p></li>
</ul>
</div></blockquote>
<p>\begin{align*}
x_t = g(x_{t-1}, w_t)<br />
\end{align*}</p>
<blockquote>
<div><ul class="simple">
<li><p><strong>동적 시스템(Dynamic System)</strong><br />
: 입력 시계열을 받아 출력 시계열을 내놓는 시스템<br />
: (예시) ARMA 모형의 경우 백색잡음 <span class="math notranslate nohighlight">\(\epsilon_t\)</span>를 입력받아 <span class="math notranslate nohighlight">\(y_t\)</span>를 출력하는 동적 시스템</p></li>
</ul>
</div></blockquote>
<blockquote>
<div><ul class="simple">
<li><p><strong>상태 변수(State Variable)</strong><br />
: 동적 시스템의 현재 상태를 정의하는 값의 집합<br />
: (예시) AR(<span class="math notranslate nohighlight">\(p\)</span>) 모형의 동적시스템은 <span class="math notranslate nohighlight">\(p\)</span>개의 과거 <span class="math notranslate nohighlight">\(Y\)</span>값 <span class="math notranslate nohighlight">\(\{Y_{t-1}, Y_{t-2}, \cdots, Y_{t-p}\}\)</span>이 상태변수<br />
: (예시) ARMA(<span class="math notranslate nohighlight">\(p,q\)</span>) 모형의 동적시스템은 <span class="math notranslate nohighlight">\(p\)</span>개의 과거 <span class="math notranslate nohighlight">\(Y\)</span>값 <span class="math notranslate nohighlight">\(\{Y_{t-1}, Y_{t-2}, \cdots, Y_{t-p}\}\)</span>과 <span class="math notranslate nohighlight">\(q\)</span>개의 과거 <span class="math notranslate nohighlight">\(\epsilon\)</span>값 <span class="math notranslate nohighlight">\(\{\epsilon_{t-1}, \epsilon_{t-2}, \cdots, \epsilon_{t-q}\}\)</span>이 상태변수</p></li>
</ul>
</div></blockquote>
<p>\begin{align*}
\text{Equation of AR}(p) &amp;&amp; Y_t = \phi_1 Y_{t-1} +  \cdots + \phi_p Y_{t-p} + \epsilon_t
\end{align*}</p>
<p>\begin{align*}
\text{Equation of ARMA}(p,q) &amp;&amp; Y_t = \phi_1 Y_{t-1} +  \cdots + \phi_p Y_{t-p} + \theta_1 \epsilon_{t-1}  \cdots  + \theta_q \epsilon_{t-q} + \epsilon_t
\end{align*}</p>
<center><img src='Image/SSM_Example.png' width='500'></center><div class="section" id="simple-exponential-smoothing">
<h3>지수평활법(Simple Exponential Smoothing)<a class="headerlink" href="#simple-exponential-smoothing" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><p><strong>“추세나 계절성 패턴이 없는 경우 적합”</strong><br />
<strong>“미래 시계열 데이터는 과거 특정기간 동안의 평균값이며 그 이전의 값들은 미래에 어떠한 정보도 주지 않는다”</strong></p>
</div></blockquote>
<p>\begin{align*}
\hat{Y}<em>{t+1} &amp; = \dfrac{1}{T}\displaystyle \sum</em>{i=0}^{T} Y_{t-i} \ &amp; or \
\hat{Y}<em>{t+1} &amp; = \dfrac{\alpha}{T}\displaystyle \sum</em>{i=1}^{T} (1-\alpha)^i Y_{t-i} \
\end{align*}</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">statsmodels.tsa.api</span> <span class="kn">import</span> <span class="n">SimpleExpSmoothing</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">location</span> <span class="o">=</span> <span class="s1">&#39;./Data/BikeSharingDemand/Bike_Sharing_Demand_Full.csv&#39;</span>
<span class="n">raw_all</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">location</span><span class="p">)</span>

<span class="c1"># Simple Exponential Smoothing</span>
<span class="n">target</span> <span class="o">=</span> <span class="n">raw_all</span><span class="o">.</span><span class="n">loc</span><span class="p">[:</span><span class="mi">24</span><span class="o">*</span><span class="mi">7</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;count&#39;</span><span class="p">]</span>
<span class="n">target</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">6</span><span class="p">),</span> <span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">400</span><span class="p">))</span>

<span class="n">fit1</span> <span class="o">=</span> <span class="n">SimpleExpSmoothing</span><span class="p">(</span><span class="n">target</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">smoothing_level</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">optimized</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">fcast1</span> <span class="o">=</span> <span class="n">fit1</span><span class="o">.</span><span class="n">forecast</span><span class="p">(</span><span class="mi">24</span><span class="p">)</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\alpha=0.2$&#39;</span><span class="p">)</span>
<span class="n">fcast1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">fit1</span><span class="o">.</span><span class="n">fittedvalues</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span>  <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>

<span class="n">fit2</span> <span class="o">=</span> <span class="n">SimpleExpSmoothing</span><span class="p">(</span><span class="n">target</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">smoothing_level</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span> <span class="n">optimized</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">fcast2</span> <span class="o">=</span> <span class="n">fit2</span><span class="o">.</span><span class="n">forecast</span><span class="p">(</span><span class="mi">24</span><span class="p">)</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\alpha=0.6$&#39;</span><span class="p">)</span>
<span class="n">fcast2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">fit2</span><span class="o">.</span><span class="n">fittedvalues</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>

<span class="n">fit3</span> <span class="o">=</span> <span class="n">SimpleExpSmoothing</span><span class="p">(</span><span class="n">target</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">fcast3</span> <span class="o">=</span> <span class="n">fit3</span><span class="o">.</span><span class="n">forecast</span><span class="p">(</span><span class="mi">24</span><span class="p">)</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\alpha=</span><span class="si">%s</span><span class="s1">$&#39;</span><span class="o">%</span><span class="k">fit3</span>.model.params[&#39;smoothing_level&#39;])
<span class="n">fcast3</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">fit3</span><span class="o">.</span><span class="n">fittedvalues</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">FileNotFoundError</span><span class="g g-Whitespace">                         </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="n">b67374db9c10</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span> 
<span class="g g-Whitespace">      </span><span class="mi">5</span> <span class="n">location</span> <span class="o">=</span> <span class="s1">&#39;./Data/BikeSharingDemand/Bike_Sharing_Demand_Full.csv&#39;</span>
<span class="ne">----&gt; </span><span class="mi">6</span> <span class="n">raw_all</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">location</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">7</span> 
<span class="g g-Whitespace">      </span><span class="mi">8</span> <span class="c1"># Simple Exponential Smoothing</span>

<span class="nn">~/opt/anaconda3/lib/python3.7/site-packages/pandas/io/parsers.py</span> in <span class="ni">parser_f</span><span class="nt">(filepath_or_buffer, sep, delimiter, header, names, index_col, usecols, squeeze, prefix, mangle_dupe_cols, dtype, engine, converters, true_values, false_values, skipinitialspace, skiprows, skipfooter, nrows, na_values, keep_default_na, na_filter, verbose, skip_blank_lines, parse_dates, infer_datetime_format, keep_date_col, date_parser, dayfirst, cache_dates, iterator, chunksize, compression, thousands, decimal, lineterminator, quotechar, quoting, doublequote, escapechar, comment, encoding, dialect, error_bad_lines, warn_bad_lines, delim_whitespace, low_memory, memory_map, float_precision)</span>
<span class="g g-Whitespace">    </span><span class="mi">674</span>         <span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">675</span> 
<span class="ne">--&gt; </span><span class="mi">676</span>         <span class="k">return</span> <span class="n">_read</span><span class="p">(</span><span class="n">filepath_or_buffer</span><span class="p">,</span> <span class="n">kwds</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">677</span> 
<span class="g g-Whitespace">    </span><span class="mi">678</span>     <span class="n">parser_f</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">=</span> <span class="n">name</span>

<span class="nn">~/opt/anaconda3/lib/python3.7/site-packages/pandas/io/parsers.py</span> in <span class="ni">_read</span><span class="nt">(filepath_or_buffer, kwds)</span>
<span class="g g-Whitespace">    </span><span class="mi">446</span> 
<span class="g g-Whitespace">    </span><span class="mi">447</span>     <span class="c1"># Create the parser.</span>
<span class="ne">--&gt; </span><span class="mi">448</span>     <span class="n">parser</span> <span class="o">=</span> <span class="n">TextFileReader</span><span class="p">(</span><span class="n">fp_or_buf</span><span class="p">,</span> <span class="o">**</span><span class="n">kwds</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">449</span> 
<span class="g g-Whitespace">    </span><span class="mi">450</span>     <span class="k">if</span> <span class="n">chunksize</span> <span class="ow">or</span> <span class="n">iterator</span><span class="p">:</span>

<span class="nn">~/opt/anaconda3/lib/python3.7/site-packages/pandas/io/parsers.py</span> in <span class="ni">__init__</span><span class="nt">(self, f, engine, **kwds)</span>
<span class="g g-Whitespace">    </span><span class="mi">878</span>             <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="s2">&quot;has_index_names&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwds</span><span class="p">[</span><span class="s2">&quot;has_index_names&quot;</span><span class="p">]</span>
<span class="g g-Whitespace">    </span><span class="mi">879</span> 
<span class="ne">--&gt; </span><span class="mi">880</span>         <span class="bp">self</span><span class="o">.</span><span class="n">_make_engine</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">engine</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">881</span> 
<span class="g g-Whitespace">    </span><span class="mi">882</span>     <span class="k">def</span> <span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

<span class="nn">~/opt/anaconda3/lib/python3.7/site-packages/pandas/io/parsers.py</span> in <span class="ni">_make_engine</span><span class="nt">(self, engine)</span>
<span class="g g-Whitespace">   </span><span class="mi">1112</span>     <span class="k">def</span> <span class="nf">_make_engine</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">engine</span><span class="o">=</span><span class="s2">&quot;c&quot;</span><span class="p">):</span>
<span class="g g-Whitespace">   </span><span class="mi">1113</span>         <span class="k">if</span> <span class="n">engine</span> <span class="o">==</span> <span class="s2">&quot;c&quot;</span><span class="p">:</span>
<span class="ne">-&gt; </span><span class="mi">1114</span>             <span class="bp">self</span><span class="o">.</span><span class="n">_engine</span> <span class="o">=</span> <span class="n">CParserWrapper</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">f</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1115</span>         <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">1116</span>             <span class="k">if</span> <span class="n">engine</span> <span class="o">==</span> <span class="s2">&quot;python&quot;</span><span class="p">:</span>

<span class="nn">~/opt/anaconda3/lib/python3.7/site-packages/pandas/io/parsers.py</span> in <span class="ni">__init__</span><span class="nt">(self, src, **kwds)</span>
<span class="g g-Whitespace">   </span><span class="mi">1889</span>         <span class="n">kwds</span><span class="p">[</span><span class="s2">&quot;usecols&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">usecols</span>
<span class="g g-Whitespace">   </span><span class="mi">1890</span> 
<span class="ne">-&gt; </span><span class="mi">1891</span>         <span class="bp">self</span><span class="o">.</span><span class="n">_reader</span> <span class="o">=</span> <span class="n">parsers</span><span class="o">.</span><span class="n">TextReader</span><span class="p">(</span><span class="n">src</span><span class="p">,</span> <span class="o">**</span><span class="n">kwds</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1892</span>         <span class="bp">self</span><span class="o">.</span><span class="n">unnamed_cols</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_reader</span><span class="o">.</span><span class="n">unnamed_cols</span>
<span class="g g-Whitespace">   </span><span class="mi">1893</span> 

<span class="nn">pandas/_libs/parsers.pyx</span> in <span class="ni">pandas._libs.parsers.TextReader.__cinit__</span><span class="nt">()</span>

<span class="nn">pandas/_libs/parsers.pyx</span> in <span class="ni">pandas._libs.parsers.TextReader._setup_parser_source</span><span class="nt">()</span>

<span class="ne">FileNotFoundError</span>: [Errno 2] File ./Data/BikeSharingDemand/Bike_Sharing_Demand_Full.csv does not exist: &#39;./Data/BikeSharingDemand/Bike_Sharing_Demand_Full.csv&#39;
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="by-holt">
<h3>선형 추세 알고리즘 by Holt<a class="headerlink" href="#by-holt" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><p><strong>“간단 지수평활법에 추세를 반영한 예측 알고리즘”</strong></p>
</div></blockquote>
<p>\begin{align*}
\text{Main equation}  &amp;&amp; \hat{Y}<em>{t+h} &amp;= \ell</em>{t} + hb_{t} \
\text{Level equation} &amp;&amp; \ell_{t} &amp;= \alpha Y_{t} + (1 - \alpha)(\ell_{t-1} + b_{t-1}) \
\text{Trend equation} &amp;&amp; b_{t}    &amp;= \beta^<em>(\ell_{t} - \ell_{t-1}) + (1 -\beta^</em>)b_{t-1}<br />
\end{align*}</p>
<p>\begin{align*}
where~0 \leq \beta^* \leq 1~is~the~smoothing~parameter~for~the~trend
\end{align*}</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>Year</p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(t\)</span></p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(Y_t\)</span></p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(ℓ_t\)</span></p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(b_t\)</span></p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(\hat{Y_t}\)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>2014</p></td>
<td><p>0</p></td>
<td><p></p></td>
<td><p>17.55</p></td>
<td><p>4.31</p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p>2015</p></td>
<td><p>1</p></td>
<td><p>17.55</p></td>
<td><p>18.41</p></td>
<td><p>3.62</p></td>
<td><p>21.86</p></td>
</tr>
<tr class="row-even"><td><p>2016</p></td>
<td><p>2</p></td>
<td><p>21.86</p></td>
<td><p>21.89</p></td>
<td><p>3.59</p></td>
<td><p>22.03</p></td>
</tr>
<tr class="row-odd"><td><p>2017</p></td>
<td><p>3</p></td>
<td><p>23.89</p></td>
<td><p>24.21</p></td>
<td><p>3.33</p></td>
<td><p>25.48</p></td>
</tr>
<tr class="row-even"><td><p>2018</p></td>
<td><p>4</p></td>
<td><p>26.93</p></td>
<td><p>27.05</p></td>
<td><p>3.24</p></td>
<td><p>27.54</p></td>
</tr>
</tbody>
</table>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;always&#39;</span><span class="p">)</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">statsmodels.tsa.api</span> <span class="kn">import</span> <span class="n">Holt</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">location</span> <span class="o">=</span> <span class="s1">&#39;./Data/BikeSharingDemand/Bike_Sharing_Demand_Full.csv&#39;</span>
<span class="n">raw_all</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">location</span><span class="p">)</span>

<span class="c1"># Holt&#39;s Linear Trend</span>
<span class="n">target</span> <span class="o">=</span> <span class="n">raw_all</span><span class="o">.</span><span class="n">loc</span><span class="p">[:</span><span class="mi">24</span><span class="o">*</span><span class="mi">7</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;count&#39;</span><span class="p">]</span>
<span class="n">target</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">6</span><span class="p">),</span> <span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">400</span><span class="p">))</span>

<span class="n">fit1</span> <span class="o">=</span> <span class="n">Holt</span><span class="p">(</span><span class="n">target</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">fcast1</span> <span class="o">=</span> <span class="n">fit1</span><span class="o">.</span><span class="n">forecast</span><span class="p">(</span><span class="mi">24</span><span class="p">)</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s2">&quot;Holt&#39;s linear trend&quot;</span><span class="p">)</span>
<span class="n">fcast1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">fit1</span><span class="o">.</span><span class="n">fittedvalues</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span>  <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>

<span class="n">fit2</span> <span class="o">=</span> <span class="n">Holt</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">exponential</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">fcast2</span> <span class="o">=</span> <span class="n">fit2</span><span class="o">.</span><span class="n">forecast</span><span class="p">(</span><span class="mi">24</span><span class="p">)</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s2">&quot;Exponential weighted trend&quot;</span><span class="p">)</span>
<span class="n">fcast2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">fit2</span><span class="o">.</span><span class="n">fittedvalues</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>

<span class="n">fit3</span> <span class="o">=</span> <span class="n">Holt</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">damped</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">fcast3</span> <span class="o">=</span> <span class="n">fit3</span><span class="o">.</span><span class="n">forecast</span><span class="p">(</span><span class="mi">24</span><span class="p">)</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s2">&quot;Additive damped trend&quot;</span><span class="p">)</span>
<span class="n">fcast3</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">fit3</span><span class="o">.</span><span class="n">fittedvalues</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/4_Algorithms_TS_NonLinear_6_0.png" src="../_images/4_Algorithms_TS_NonLinear_6_0.png" />
</div>
</div>
</div>
<div class="section" id="by-holt-winter">
<h3>계절 알고리즘 by Holt-Winter<a class="headerlink" href="#by-holt-winter" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><p><strong>“선형 추세 알고리즘에 계절성을 반영한 예측 알고리즘”</strong></p>
</div></blockquote>
<ul class="simple">
<li><p><strong>Additive Seasonal Method:</strong> <span class="math notranslate nohighlight">\(Y_t = T_t + S_t + R_t\)</span>, 계절성 변화의 크기가 시간 흐름에 따라 일정한 경우 선호</p></li>
</ul>
<p>\begin{align*}
\text{Main equation}     &amp;&amp; \hat{Y}<em>{t+h} &amp;= \ell</em>{t} + hb_{t} + s_{t-m+h_{m}^{+}} \
\text{Level equation}    &amp;&amp; \ell_{t} &amp;= \alpha(Y_{t} - s_{t-m}) + (1 - \alpha)(\ell_{t-1} + b_{t-1}) \
\text{Trend equation}    &amp;&amp; b_{t} &amp;= \beta^<em>(\ell_{t} - \ell_{t-1}) + (1 - \beta^</em>)b_{t-1} \
\text{Seasonal equation} &amp;&amp; s_{t} &amp;= \gamma (y_{t}-\ell_{t-1}-b_{t-1}) + (1-\gamma)s_{t-m} \
\end{align*}</p>
<p>\begin{align*}
where~h_{m}^{+} = \lfloor(h-1)/m\rfloor+1~ensures~that~estimates~of~the~sesonal~indices~come~from~the~final~year~of~the~sample \
\end{align*}</p>
<ul class="simple">
<li><p><strong>Multiplicative Seasonal Method:</strong> <span class="math notranslate nohighlight">\(Y_t = T_t \times S_t \times R_t\)</span>, 계절성 변화의 크기가 시간 흐름에 비례하여 변경되는 경우 선호</p></li>
</ul>
<p>\begin{align*}
\text{Main equation}     &amp;&amp; \hat{Y}<em>{t+h} &amp;= (\ell</em>{t} + hb_{t})s_{t-m+h_{m}^{+}} \
\text{Level equation}    &amp;&amp; \ell_{t} &amp;= \alpha \frac{Y_{t}}{s_{t-m}} + (1 - \alpha)(\ell_{t-1} + b_{t-1}) \
\text{Trend equation}    &amp;&amp; b_{t} &amp;= \beta^<em>(\ell_{t}-\ell_{t-1}) + (1 - \beta^</em>)b_{t-1} \
\text{Seasonal equation} &amp;&amp; s_{t} &amp;= \gamma \frac{y_{t}}{(\ell_{t-1} + b_{t-1})} + (1 - \gamma)s_{t-m} \
\end{align*}</p>
<ul class="simple">
<li><p><strong>Damped Seasonal Method:</strong> Additive와 Multiplicative 모두 사용되며 장기 예측시 무한정 증가/감소를 방지</p></li>
</ul>
<p>\begin{align*}
\text{Main equation}     &amp;&amp; \hat{Y}<em>{t+h} &amp;= \left[\ell</em>{t} + (\phi+\phi^2 + \dots + \phi^{h})b_{t}\right]s_{t+h-m(k+1)} \
\text{Level equation}    &amp;&amp; \ell_{t} &amp;= \alpha(y_{t} / s_{t-m}) + (1 - \alpha)(\ell_{t-1} + \phi b_{t-1}) \
\text{Trend equation}    &amp;&amp; b_{t} &amp;= \beta^<em>(\ell_{t} - \ell_{t-1}) + (1 - \beta^</em>)\phi b_{t-1} \
\text{Seasonal equation} &amp;&amp; s_{t} &amp;= \gamma \frac{y_{t}}{(\ell_{t-1} + \phi b_{t-1})} + (1 - \gamma)s_{t-m} \
\end{align*}</p>
<blockquote>
<div><p><strong>Summary of Smoothing Parameters:</strong></p>
</div></blockquote>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>Level</p></th>
<th class="head"><p>Trend</p></th>
<th class="head"><p>Seasonality</p></th>
<th class="head"><p>Damping</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\alpha\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\beta\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\gamma\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\phi\)</span></p></td>
</tr>
</tbody>
</table>
<ul class="simple">
<li><p><strong>Example of Estimation Process:</strong></p></li>
</ul>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>-</p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(t\)</span></p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(Y_t\)</span></p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(\ell_t\)</span></p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(b_t\)</span></p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(s_t\)</span></p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(\hat{Y}_t\)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>2004 Q1</p></td>
<td><p>-3</p></td>
<td><p>-</p></td>
<td><p>-</p></td>
<td><p>-</p></td>
<td><p>1.24</p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p>2004 Q2</p></td>
<td><p>-2</p></td>
<td><p>-</p></td>
<td><p>-</p></td>
<td><p>-</p></td>
<td><p>0.77</p></td>
<td><p>-</p></td>
</tr>
<tr class="row-even"><td><p>2004 Q3</p></td>
<td><p>-1</p></td>
<td><p>-</p></td>
<td><p>-</p></td>
<td><p>-</p></td>
<td><p>0.96</p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p>2004 Q4</p></td>
<td><p>0</p></td>
<td><p>-</p></td>
<td><p>32.49</p></td>
<td><p>0.7</p></td>
<td><p>1.02</p></td>
<td><p>-</p></td>
</tr>
<tr class="row-even"><td><p>2005 Q1</p></td>
<td><p>1</p></td>
<td><p>42.21</p></td>
<td><p>33.51</p></td>
<td><p>0.71</p></td>
<td><p>1.24</p></td>
<td><p>41.29</p></td>
</tr>
<tr class="row-odd"><td><p>2005 Q2</p></td>
<td><p>2</p></td>
<td><p>24.65</p></td>
<td><p>33.24</p></td>
<td><p>0.68</p></td>
<td><p>0.77</p></td>
<td><p>26.36</p></td>
</tr>
<tr class="row-even"><td><p>2005 Q3</p></td>
<td><p>3</p></td>
<td><p>32.67</p></td>
<td><p>33.94</p></td>
<td><p>0.68</p></td>
<td><p>0.96</p></td>
<td><p>32.62</p></td>
</tr>
<tr class="row-odd"><td><p>2005 Q4</p></td>
<td><p>4</p></td>
<td><p>37.26</p></td>
<td><p>35.4</p></td>
<td><p>0.7</p></td>
<td><p>1.02</p></td>
<td><p>35.44</p></td>
</tr>
<tr class="row-even"><td><p>-</p></td>
<td><p>⋮</p></td>
<td><p>⋮</p></td>
<td><p>⋮</p></td>
<td><p>⋮</p></td>
<td><p>⋮</p></td>
<td><p>⋮</p></td>
</tr>
<tr class="row-odd"><td><p>2015 Q1</p></td>
<td><p>41</p></td>
<td><p>73.26</p></td>
<td><p>58.57</p></td>
<td><p>0.66</p></td>
<td><p>1.24</p></td>
<td><p>72.59</p></td>
</tr>
<tr class="row-even"><td><p>2015 Q2</p></td>
<td><p>42</p></td>
<td><p>47.7</p></td>
<td><p>60.42</p></td>
<td><p>0.69</p></td>
<td><p>0.77</p></td>
<td><p>45.62</p></td>
</tr>
<tr class="row-odd"><td><p>2015 Q3</p></td>
<td><p>43</p></td>
<td><p>61.1</p></td>
<td><p>62.17</p></td>
<td><p>0.72</p></td>
<td><p>0.96</p></td>
<td><p>58.77</p></td>
</tr>
<tr class="row-even"><td><p>2015 Q4</p></td>
<td><p>44</p></td>
<td><p>66.06</p></td>
<td><p>63.62</p></td>
<td><p>0.75</p></td>
<td><p>1.02</p></td>
<td><p>64.38</p></td>
</tr>
<tr class="row-odd"><td><p>-</p></td>
<td><p><span class="math notranslate nohighlight">\(h\)</span></p></td>
<td><p>-</p></td>
<td><p>-</p></td>
<td><p>-</p></td>
<td><p>-</p></td>
<td><p><span class="math notranslate nohighlight">\(\hat{Y}_{T+h}\)</span></p></td>
</tr>
<tr class="row-even"><td><p>2016 Q1</p></td>
<td><p>1</p></td>
<td><p>-</p></td>
<td><p>-</p></td>
<td><p>-</p></td>
<td><p>-</p></td>
<td><p>80.09</p></td>
</tr>
<tr class="row-odd"><td><p>2016 Q2</p></td>
<td><p>2</p></td>
<td><p>-</p></td>
<td><p>-</p></td>
<td><p>-</p></td>
<td><p>-</p></td>
<td><p>50.15</p></td>
</tr>
<tr class="row-even"><td><p>2016 Q3</p></td>
<td><p>3</p></td>
<td><p>-</p></td>
<td><p>-</p></td>
<td><p>-</p></td>
<td><p>-</p></td>
<td><p>63.34</p></td>
</tr>
<tr class="row-odd"><td><p>2016 Q4</p></td>
<td><p>4</p></td>
<td><p>-</p></td>
<td><p>-</p></td>
<td><p>-</p></td>
<td><p>-</p></td>
<td><p>68.18</p></td>
</tr>
<tr class="row-even"><td><p>2017 Q1</p></td>
<td><p>5</p></td>
<td><p>-</p></td>
<td><p>-</p></td>
<td><p>-</p></td>
<td><p>-</p></td>
<td><p>83.8</p></td>
</tr>
<tr class="row-odd"><td><p>2017 Q2</p></td>
<td><p>6</p></td>
<td><p>-</p></td>
<td><p>-</p></td>
<td><p>-</p></td>
<td><p>-</p></td>
<td><p>52.45</p></td>
</tr>
<tr class="row-even"><td><p>2017 Q3</p></td>
<td><p>7</p></td>
<td><p>-</p></td>
<td><p>-</p></td>
<td><p>-</p></td>
<td><p>-</p></td>
<td><p>66.21</p></td>
</tr>
<tr class="row-odd"><td><p>2017 Q4</p></td>
<td><p>8</p></td>
<td><p>-</p></td>
<td><p>-</p></td>
<td><p>-</p></td>
<td><p>-</p></td>
<td><p>71.23</p></td>
</tr>
</tbody>
</table>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">statsmodels.tsa.api</span> <span class="kn">import</span> <span class="n">ExponentialSmoothing</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">location</span> <span class="o">=</span> <span class="s1">&#39;./Data/BikeSharingDemand/Bike_Sharing_Demand_Full.csv&#39;</span>
<span class="n">raw_all</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">location</span><span class="p">)</span>

<span class="c1"># Holt-Winter&#39;s Seasonal</span>
<span class="n">target</span> <span class="o">=</span> <span class="n">raw_all</span><span class="o">.</span><span class="n">loc</span><span class="p">[:</span><span class="mi">24</span><span class="o">*</span><span class="mi">7</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;count&#39;</span><span class="p">]</span>
<span class="n">target</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">6</span><span class="p">),</span> <span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">400</span><span class="p">))</span>

<span class="n">fit1</span> <span class="o">=</span> <span class="n">ExponentialSmoothing</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">seasonal_periods</span><span class="o">=</span><span class="mi">24</span><span class="p">,</span> <span class="n">trend</span><span class="o">=</span><span class="s1">&#39;add&#39;</span><span class="p">,</span> <span class="n">seasonal</span><span class="o">=</span><span class="s1">&#39;add&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">use_boxcox</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">fcast1</span> <span class="o">=</span> <span class="n">fit1</span><span class="o">.</span><span class="n">forecast</span><span class="p">(</span><span class="mi">24</span><span class="p">)</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s2">&quot;Non-damped&quot;</span><span class="p">)</span>
<span class="n">fcast1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">fit1</span><span class="o">.</span><span class="n">fittedvalues</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>

<span class="n">fit2</span> <span class="o">=</span> <span class="n">ExponentialSmoothing</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">seasonal_periods</span><span class="o">=</span><span class="mi">24</span><span class="p">,</span> <span class="n">trend</span><span class="o">=</span><span class="s1">&#39;add&#39;</span><span class="p">,</span> <span class="n">seasonal</span><span class="o">=</span><span class="s1">&#39;add&#39;</span><span class="p">,</span> <span class="n">damped</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">use_boxcox</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">fcast2</span> <span class="o">=</span> <span class="n">fit2</span><span class="o">.</span><span class="n">forecast</span><span class="p">(</span><span class="mi">24</span><span class="p">)</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s2">&quot;Damped&quot;</span><span class="p">)</span>
<span class="n">fcast2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">fit2</span><span class="o">.</span><span class="n">fittedvalues</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span>  <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/4_Algorithms_TS_NonLinear_8_0.png" src="../_images/4_Algorithms_TS_NonLinear_8_0.png" />
</div>
</div>
</div>
<div class="section" id="id2">
<h3>지수평활법 알고리즘 분류 요약<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p><strong>알고리즘 옵션 분류</strong></p></li>
</ul>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>Trend Component</p></th>
<th class="head"><p>Seasonal Component</p></th>
<th class="head"><p>-</p></th>
<th class="head"><p>-</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>-</p></td>
<td><p>N</p></td>
<td><p>A</p></td>
<td><p>M</p></td>
</tr>
<tr class="row-odd"><td><p>-</p></td>
<td><p>(None)</p></td>
<td><p>(Additive)</p></td>
<td><p>(Multiplicative)</p></td>
</tr>
<tr class="row-even"><td><p>N (None)</p></td>
<td><p>(N,N)</p></td>
<td><p>(N,A)</p></td>
<td><p>(N,M)</p></td>
</tr>
<tr class="row-odd"><td><p>A (Additive)</p></td>
<td><p>(A,N)</p></td>
<td><p>(A,A)</p></td>
<td><p>(A,M)</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(A_d\)</span> (Additive damped)</p></td>
<td><p>(<span class="math notranslate nohighlight">\(A_d\)</span>,N)</p></td>
<td><p>(<span class="math notranslate nohighlight">\(A_d\)</span>,A)</p></td>
<td><p>(<span class="math notranslate nohighlight">\(A_d\)</span>,M)</p></td>
</tr>
</tbody>
</table>
<ul class="simple">
<li><p><strong>각 분류별 알고리즘</strong></p></li>
</ul>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>Short hand</p></th>
<th class="head"><p>Method</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>(N,N)</p></td>
<td><p>Simple exponential smoothing</p></td>
</tr>
<tr class="row-odd"><td><p>(A,N)</p></td>
<td><p>Holt’s linear method</p></td>
</tr>
<tr class="row-even"><td><p>(<span class="math notranslate nohighlight">\(A_d\)</span>,N)</p></td>
<td><p>Additive damped trend method</p></td>
</tr>
<tr class="row-odd"><td><p>(A,A)</p></td>
<td><p>Additive Holt-Winters’ method</p></td>
</tr>
<tr class="row-even"><td><p>(A,M)</p></td>
<td><p>Multiplicative Holt-Winters’ method</p></td>
</tr>
<tr class="row-odd"><td><p>(<span class="math notranslate nohighlight">\(A_d\)</span>,M)</p></td>
<td><p>Holt-Winters’ damped method</p></td>
</tr>
</tbody>
</table>
<center><img src='Image/TS_ExponentialSmoothing.png' width='800'></center> </div>
<div class="section" id="ets-error-trend-seasonal">
<h3>ETS(Error/Trend/Seasonal) 알고리즘<a class="headerlink" href="#ets-error-trend-seasonal" title="Permalink to this headline">¶</a></h3>
<p><strong>1) ETS(A,N,N): simple exponential smoothing with additive errors</strong><br />
<strong>2) ETS(M,N,N): simple exponential smoothing with multiplicative errors</strong><br />
<strong>3) ETS(A,A,N): Holt’s linear method with additive errors</strong><br />
<strong>4) ETS(M,A,N): Holt’s linear method with multiplicative errors</strong></p>
<center><img src='Image/TS_ETS_Equation.png' width='800'></center> 
<center><img src='Image/TS_ETS_Figure.png' width='600'></center> 
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>Model</p></th>
<th class="head"><p>Forecast variance: <span class="math notranslate nohighlight">\(\sigma_h^2\)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>(A,N,N)</p></td>
<td><p><span class="math notranslate nohighlight">\(\sigma_h^2 = \sigma^2\big[1 + \alpha^2(h-1)\big]\)</span></p></td>
</tr>
<tr class="row-odd"><td><p>(A,A,N)</p></td>
<td><p><span class="math notranslate nohighlight">\(\sigma_h^2 = \sigma^2\Big[1 + (h-1)\big\{\alpha^2 + \alpha\beta h + \frac16\beta^2h(2h-1)\big\}\Big]\)</span></p></td>
</tr>
<tr class="row-even"><td><p>(A,<span class="math notranslate nohighlight">\(A_d\)</span>,N)</p></td>
<td><p><span class="math notranslate nohighlight">\(\sigma_h^2 = \sigma^2\biggl[1 + \alpha^2(h-1) + \frac{\beta\phi h}{(1-\phi)^2} \left\{2\alpha(1-\phi) +\beta\phi\right\} \\ \mbox{} - \frac{\beta\phi(1-\phi^h)}{(1-\phi)^2(1-\phi^2)} \left\{ 2\alpha(1-\phi^2)+ \beta\phi(1+2\phi-\phi^h)\right\}\biggr]\)</span></p></td>
</tr>
<tr class="row-odd"><td><p>(A,N,A)</p></td>
<td><p><span class="math notranslate nohighlight">\(\sigma_h^2 = \sigma^2\Big[1 + \alpha^2(h-1) + \gamma k(2\alpha+\gamma)\Big]\)</span></p></td>
</tr>
<tr class="row-even"><td><p>(A,A,A)</p></td>
<td><p><span class="math notranslate nohighlight">\(\sigma_h^2 = \sigma^2\Big[1 + (h-1)\big\{\alpha^2 + \alpha\beta h + \frac16\beta^2h(2h-1)\big\} \\ \mbox{} + \gamma k \big\{2\alpha+ \gamma + \beta m (k+1)\big\} \Big]\)</span></p></td>
</tr>
<tr class="row-odd"><td><p>(A,<span class="math notranslate nohighlight">\(A_d\)</span>,A)</p></td>
<td><p><span class="math notranslate nohighlight">\(\sigma_h^2 = \sigma^2\biggl[1 + \alpha^2(h-1) + \gamma k(2\alpha+\gamma) \\ \mbox{} +\frac{\beta\phi h}{(1-\phi)^2} \left\{2\alpha(1-\phi) + \beta\phi \right\} \\ \mbox{} - \frac{\beta\phi(1-\phi^h)}{(1-\phi)^2(1-\phi^2)} \left\{ 2\alpha(1-\phi^2)+ \beta\phi(1+2\phi-\phi^h)\right\} \\ \mbox{} + \frac{2\beta\gamma\phi}{(1-\phi)(1-\phi^m)}\left\{k(1-\phi^m) - \phi^m(1-\phi^{mk})\right\}\biggr]\)</span></p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="arima">
<h3>상태공간 모형과 ARIMA 모형의 관계<a class="headerlink" href="#arima" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><p><strong>동적 선형모형(Dynamics Linear Model) vs. ARIMA 모형</strong></p>
<ul class="simple">
<li><p>모든 ARIMA 모형은 동일한 출력(Measurement)을 가지는 동적 선형 모형으로 표현가능하며, 조합 방법은 무한함</p></li>
<li><p>모든 동적 선형모형 출력은 ARIMA 모형으로 표현 가능</p></li>
</ul>
</div></blockquote>
<ul class="simple">
<li><p><strong>상태공간모형 <span class="math notranslate nohighlight">\(\Longrightarrow\)</span> ARMA</strong></p></li>
</ul>
<p>\begin{align*}
\text{Main Equation of State Space Model} &amp;&amp; Y_{t} &amp;= A_t X_{t} =  A_t (I- \Phi_t L)^{-1} w_t \
\text{where} &amp;&amp; X_{t} &amp;= \Phi_t X_{t-1} + w_t \
&amp;&amp; &amp;= \Phi_t L X_{t} + w_t \
&amp;&amp; (I- \Phi_t L) X_{t} &amp;=  w_t \
&amp;&amp; X_{t} &amp;=  (I- \Phi_t L)^{-1} w_t \
\end{align*}</p>
<ul class="simple">
<li><p><strong>ARMA(p,q) <span class="math notranslate nohighlight">\(\Longrightarrow\)</span> 상태공간모형</strong> : 상태변수를 정하는 방법이 무한하기에 표준형식(Canonical Form)을 따름</p></li>
</ul>
<p>\begin{align*}
\text{Main Equation of ARMA(p,q)} &amp;&amp; Y_t &amp;= \phi_1 Y_{t-1} + \phi_2 Y_{t-2} + \cdots + \phi_p Y_{t-p} + e_t + \theta_1 e_{t-1} + \theta_2 e_{t-2} + \cdots + \theta_q e_{t-q} \
\text{let <span class="math notranslate nohighlight">\(r=max(p,q+1)\)</span>} &amp;&amp; Y_{t} &amp;= \phi_1 Y_{t-1} + \phi_2 Y_{t-2} + \cdots + \phi_r Y_{t-r} + e_t + \theta_1 e_{t-1} + \theta_2 e_{t-2} + \cdots + \theta_{r-1} e_{t-(r-1)} \
\text{Insert State Space} &amp;&amp; Y_t &amp;=
\begin{bmatrix} 1 &amp; 0 &amp; \cdots &amp; 0 \end{bmatrix}
\begin{bmatrix}
x_{t,1} \ x_{t,2} \ \vdots  \ x_{t,r-1} \ x_{t,r} \
\end{bmatrix} \
\text{where} &amp;&amp; x_{1,t} &amp;= \phi_1 x_{1,t-1} + x_{2,t-1} + e_t \
&amp;&amp; x_{2,t} &amp;= \phi_2 x_{1,t-1} + x_{3,t-1} + \theta_1 e_t \
&amp;&amp; x_{3,t} &amp;= \phi_3 x_{1,t-1} + x_{4,t-1} + \theta_2 e_t \
&amp;&amp; &amp; \vdots \
&amp;&amp; x_{r-1,t} &amp;= \phi_{r-1} x_{1,t-1} + x_{r,t-1} + \theta_{r-2} e_t \
&amp;&amp; x_{r,t} &amp;= \phi_{r} x_{1,t-1} + \theta_{r-1} e_t \
\text{Induced} &amp;&amp; x_{1,t} &amp;= \phi_1 x_{1,t-1} + \phi_2 x_{1,t-2} + \cdots + \phi_r x_{1,t-r} + e_t +  \theta_1 e_t + \cdots + \theta_{r-1} e_{t-(r-1)} \
\text{State Space Form} &amp;&amp; Y_t &amp;=
\begin{bmatrix} 1 &amp; 0 &amp; \cdots &amp; 0 \end{bmatrix}
\begin{bmatrix}
x_{t,1} \ x_{t,2} \ \vdots  \ x_{t,r-1} \ x_{t,r} \
\end{bmatrix} \
\text{where} &amp;&amp;
\begin{bmatrix}
x_{t,1} \ x_{t,2} \ \vdots  \ x_{t,r-1} \ x_{t,r} \
\end{bmatrix}
&amp;= \begin{bmatrix}
\phi_1     &amp;      1 &amp;      0 &amp; \cdots &amp;      0 \
\phi_2     &amp;      0 &amp;      1 &amp; \cdots &amp;      0 \
\vdots     &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots \
\phi_{r-1} &amp;      0 &amp;      1 &amp; \cdots &amp;      1 \
\phi_r     &amp;      0 &amp;      0 &amp; \cdots &amp;      0 \
\end{bmatrix}
\begin{bmatrix}
x_{t-1,1} \ x_{t-1,2} \ \vdots  \ x_{t-1,r-1} \ x_{t-1,r} \
\end{bmatrix}
+
\begin{bmatrix}
1 &amp; \theta_1 &amp; \cdots &amp; \theta_{r-1}
\end{bmatrix}
\begin{bmatrix}
e_{1} \ e_{2} \ \vdots  \ e_{r-1} \ e_{r} \
\end{bmatrix}
\end{align*}</p>
<ul class="simple">
<li><p><strong>ARIMA(p,d,q) <span class="math notranslate nohighlight">\(\Longrightarrow\)</span> 상태공간모형</strong> : <span class="math notranslate nohighlight">\(\Delta^d Y_t = ARMA(p,q)\)</span></p></li>
</ul>
<p>\begin{align*}
\text{Each Equation of <span class="math notranslate nohighlight">\(\Delta^d Y_t\)</span>} &amp;&amp; \Delta^{1} Y_{t} &amp;= Y_t - Y_{t-1} \
&amp;&amp; \Delta^{2} Y_{t} &amp;= \Delta^{1} Y_{t}- \Delta^{1} Y_{t-1} \
&amp;&amp; &amp; \vdots \
&amp;&amp; \Delta^{d} Y_{t} &amp;= \Delta^{d-1} Y_{t}- \Delta^{d-1} Y_{t-1} \
\text{State Space Form} &amp;&amp; Y_t &amp;=
\begin{bmatrix} 1 &amp; 1 &amp; \cdots &amp; 1 &amp; 1 &amp; 0 &amp; \cdots &amp; 0 \end{bmatrix}
\begin{bmatrix}
Y_{t} \ \Delta Y_{t-1} \ \vdots  \ \Delta^{d-1} Y_{t-1} \ \Delta^{d} Y_{t-1} \
x_{t,2} \ \vdots  \ x_{t,r-1} \ x_{t,r} \ \end{bmatrix} \
\text{where} &amp;&amp;
\begin{bmatrix}
Y_{t-1} \ \Delta Y_{t-1} \ \vdots  \ \Delta^{d-1} Y_{t-1} \ \Delta^{d} Y_{t} \
x_{t,2} \ \vdots  \ x_{t,r-1} \ x_{t,r} \
\end{bmatrix}
&amp;= \begin{bmatrix}
1      &amp;      1 &amp; \cdots &amp;      1 &amp;          1 &amp;      0 &amp;      0 &amp;\cdots &amp;      0 \
0      &amp;      1 &amp; \cdots &amp;      1 &amp;          1 &amp;      0 &amp;      0 &amp;\cdots &amp;      0 \
\vdots &amp; \vdots &amp; \vdots &amp; \vdots &amp;     \vdots &amp;      0 &amp;      0 &amp;\cdots &amp;      0 \
0      &amp;      0 &amp; \cdots &amp;      1 &amp;          1 &amp;      0 &amp;      0 &amp; \cdots &amp;      0 \
0      &amp;      0 &amp; \cdots &amp;      0 &amp;     \phi_1 &amp;      1 &amp;      0 &amp; \cdots &amp;      0 \
0      &amp;      0 &amp; \cdots &amp;      0 &amp;     \phi_2 &amp;      0 &amp;      1 &amp; \cdots &amp;      0 \
0      &amp;      0 &amp; \cdots &amp;      0 &amp;     \vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots \
0      &amp;      0 &amp; \cdots &amp;      0 &amp; \phi_{r-1} &amp;      0 &amp;      1 &amp; \cdots &amp;      1 \
0      &amp;      0 &amp; \cdots &amp;      0 &amp;     \phi_r &amp;      0 &amp;      0 &amp; \cdots &amp;      0 \
\end{bmatrix}
\begin{bmatrix}
Y_{t-2} \ \Delta Y_{t-2} \ \vdots  \ \Delta^{d-1} Y_{t-2} \ \Delta^{d} Y_{t-1} \ x_{t-1,2} \
\vdots  \ x_{t-1,r-1} \ x_{t-1,r} \
\end{bmatrix} \
&amp;&amp; &amp;+
\begin{bmatrix}
0 &amp; \cdots &amp; 0 &amp; 1 &amp; \theta_1 &amp; \cdots &amp; \theta_{r-1}
\end{bmatrix}
\begin{bmatrix}
0 \ 0 \ \vdots  \ 0 \ e_{1} \ e_{2} \ \vdots  \ e_{r-1} \ e_{r} \
\end{bmatrix}
\end{align*}</p>
<div class="section" id="local-level-model">
<h4>로컬레벨 모형(Local Level Model)<a class="headerlink" href="#local-level-model" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div><p>랜덤워크 모형에 관측잡음이 추가된 것으로 랜덤워크 과정을 따르는 단변수 상태변수 <span class="math notranslate nohighlight">\(\mu_t\)</span>를 가짐
\begin{align*}
\mu_t &amp;= \mu_{t-1} + w_t &amp;,;;; &amp; w_t \sim N(0, \sigma_w^2) \
Y_{t} &amp;= \mu_{t} + v_t &amp;,;;; &amp; v_t \sim {N}(0, \sigma_v^2) \
\end{align*}</p>
</div></blockquote>
<ul class="simple">
<li><p><strong>로컬레벨 모형 <span class="math notranslate nohighlight">\(\Longrightarrow\)</span> ARIMA 모형</strong></p></li>
</ul>
<blockquote>
<div><p><strong>로컬레벨 모형은 ARIMA(0,1,1)의 다른표현</strong></p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\Delta Y_t\)</span>는 <span class="math notranslate nohighlight">\(MA(1)\)</span> 모형을 따르고 <span class="math notranslate nohighlight">\(Y_t\)</span>는 <span class="math notranslate nohighlight">\(ARIMA(0,1,1)\)</span> 모형을 따름</p></li>
</ul>
</div></blockquote>
<p>\begin{align*}
\text{Setting of <span class="math notranslate nohighlight">\(\mu_t\)</span>} &amp;&amp; \mu_t &amp;= Y_t - v_t \
\text{Equation of Local Level Model} &amp;&amp; Y_t - v_t &amp;= Y_{t-1} - v_{t-1} + w_t \
\text{Equation of ARIMA Model} &amp;&amp; \Delta Y_t &amp;= Y_t - Y_{t-1} = w_t + v_t - v_{t-1} \
\text{Expectation} &amp;&amp; \text{E} \left( \Delta Y_t \right) &amp;= \text{E} \left( w_t + v_t - v_{t-1} \right) =0 \
\text{Variance} &amp;&amp; \text{E} ( \Delta Y_t^2 ) &amp;= \text{E} \left[ (w_t + v_t - v_{t-1})(w_{t} + v_{t} - v_{t-1}) \right] \
&amp;&amp; &amp;= \text{E} \left( w_t^2 + v_t^2 + v_{t-1}^2 \right) \
&amp;&amp; &amp;= \sigma_w^2 + 2\sigma_v^2 \
\text{Autocorrelation(1)} &amp;&amp; \text{E} ( \Delta Y_t \Delta Y_{t-1} ) &amp;= \text{E} \left[ (w_t + v_t - v_{t-1})(w_{t-1} + v_{t-1} - v_{t-2}) \right] \
&amp;&amp; &amp;= - \text{E} \left( v_{t-1}^2 \right) \
&amp;&amp; &amp;= -\sigma_v^2 \
\text{Autocorrelation(<span class="math notranslate nohighlight">\(l\)</span>)} &amp;&amp; \text{E} ( \Delta Y_t \Delta Y_{t-l} ) &amp;= 0, ;;; \text{for } l &gt; 1
\end{align*}</p>
<ul class="simple">
<li><p><strong>ARIMA 모형과의 차이점:</strong></p></li>
</ul>
<blockquote>
<div><p><strong>ARIMA(0,1,1)이 아닌 로컬 레벨 모형을 사용하는 이유는 다음과 같이 이유와 가정 때문</strong></p>
<ul class="simple">
<li><p>우리가 관심을 가지는 값은 어떤 이유에 의해 반드시 랜덤 워크 모형을 따라야 한다.</p></li>
<li><p>그런데 시계열 자료 <span class="math notranslate nohighlight">\(Y_t\)</span>는 랜덤 워크 모형을 따르지 않는다. (ARIMA(0,1,1) 모형을 따름)</p></li>
<li><p>그러므로 시계열 자료 <span class="math notranslate nohighlight">\(Y_t\)</span>는 우리가 원하는 랜덤 워크 <span class="math notranslate nohighlight">\(\mu_t\)</span>에 관측 잡음이 더해진 걸로 가정하자.</p></li>
<li><p>이제 변경된 풀어야 하는 문제는 시계열 자료 <span class="math notranslate nohighlight">\(Y_t\)</span>를 사용하여 랜덤 워크 모형을 따르는, 잡음을 제거한 원래의 값 <span class="math notranslate nohighlight">\(\mu_t\)</span>이다.</p></li>
</ul>
</div></blockquote>
<ul class="simple">
<li><p><strong>예시문제1:</strong></p>
<ol class="simple">
<li><p>어떤 섬 근처에서 배가 엔진을 끄고 정지해 있다.</p></li>
<li><p>이 배는 파도에 의한 브라운 운동(Brown montion)을 하게 된다.</p></li>
<li><p>파도의 랜덤한 힘에 밀려 배의 위치는 다음과 같은 수식으로 변화된다.<br />
\begin{align*}
\mu_t = \mu_{t-1} + w_t
\end{align*}</p></li>
<li><p>매 시간마다 배의 선원은 섬으로부터의 거리 <span class="math notranslate nohighlight">\(Y_t\)</span>를 배에 있는 초음파 거리계(ultrasonic range finder)로 측정한다.</p></li>
<li><p>이러한 경우에 정확한 거리 <span class="math notranslate nohighlight">\(\mu_t\)</span>를 알고자 하는 것이 바로 로컬 레벨 모형의 필터링(filtering) 문제가 된다.</p></li>
</ol>
</li>
<li><p><strong>예시문제2:</strong></p>
<ol class="simple">
<li><p>효율적인 시장에서 거래되는 주식의 가격, 즉 주가는 일반적으로 랜덤 워크를 따르는 것으로 생각할 수 있다.</p></li>
<li><p>시장 미시구조 잡음이 있는 주가로부터 근본적인 주식의 내재 가치 즉, 랜덤 워크를 따르는 가치를 추정하고자 하는 경우도 로컬 레벨 모형의 필터링 문제로 볼 수 있다.</p></li>
</ol>
</li>
</ul>
</div>
<div class="section" id="id3">
<h4>실습: 로컬레벨 모형 데이터생성 및 이해<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="nn">sm</span>
<span class="kn">from</span> <span class="nn">statsmodels.tsa.statespace.kalman_filter</span> <span class="kn">import</span> <span class="n">KalmanFilter</span>

<span class="c1"># 데이터 생성</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">123</span><span class="p">)</span>
<span class="n">model_generator</span> <span class="o">=</span> <span class="n">KalmanFilter</span><span class="p">(</span><span class="n">k_endog</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">k_states</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                               <span class="n">transition</span><span class="o">=</span><span class="p">[[</span><span class="mi">1</span><span class="p">]],</span> <span class="n">selection</span><span class="o">=</span><span class="p">[[</span><span class="mi">1</span><span class="p">]],</span> <span class="n">state_cov</span><span class="o">=</span><span class="p">[[</span><span class="mi">1</span><span class="p">]],</span>
                               <span class="n">design</span><span class="o">=</span><span class="p">[[</span><span class="mi">1</span><span class="p">]],</span> <span class="n">obs_cov</span><span class="o">=</span><span class="p">[[</span><span class="mi">1</span><span class="p">]])</span>
<span class="n">y_gener</span><span class="p">,</span> <span class="n">x_gener</span> <span class="o">=</span> <span class="n">model_generator</span><span class="o">.</span><span class="n">simulate</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>

<span class="c1"># 데이터 생성</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y_gener</span><span class="p">,</span> <span class="s1">&#39;r:&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Observation Values&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_gener</span><span class="p">,</span> <span class="s1">&#39;g-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;State Values&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Simulation of Local Level Model ($\sigma_w^2 = 1$, $\sigma_v^2 = 1$)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/4_Algorithms_TS_NonLinear_14_0.png" src="../_images/4_Algorithms_TS_NonLinear_14_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 데이터 생성</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">123</span><span class="p">)</span>
<span class="n">model_generator</span> <span class="o">=</span> <span class="n">KalmanFilter</span><span class="p">(</span><span class="n">k_endog</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">k_states</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                               <span class="n">transition</span><span class="o">=</span><span class="p">[[</span><span class="mi">1</span><span class="p">]],</span> <span class="n">selection</span><span class="o">=</span><span class="p">[[</span><span class="mi">1</span><span class="p">]],</span> <span class="n">state_cov</span><span class="o">=</span><span class="p">[[</span><span class="mi">10</span><span class="p">]],</span>
                               <span class="n">design</span><span class="o">=</span><span class="p">[[</span><span class="mi">1</span><span class="p">]],</span> <span class="n">obs_cov</span><span class="o">=</span><span class="p">[[</span><span class="mi">1</span><span class="p">]])</span>
<span class="n">y_gener</span><span class="p">,</span> <span class="n">x_gener</span> <span class="o">=</span> <span class="n">model_generator</span><span class="o">.</span><span class="n">simulate</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>

<span class="c1"># 데이터 생성</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y_gener</span><span class="p">,</span> <span class="s1">&#39;r:&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Observation Values&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_gener</span><span class="p">,</span> <span class="s1">&#39;g-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;State Values&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Simulation of Local Level Model ($\sigma_w^2 = 10$, $\sigma_v^2 = 1$)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/4_Algorithms_TS_NonLinear_15_0.png" src="../_images/4_Algorithms_TS_NonLinear_15_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 데이터 생성</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">123</span><span class="p">)</span>
<span class="n">model_generator</span> <span class="o">=</span> <span class="n">KalmanFilter</span><span class="p">(</span><span class="n">k_endog</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">k_states</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                               <span class="n">transition</span><span class="o">=</span><span class="p">[[</span><span class="mi">1</span><span class="p">]],</span> <span class="n">selection</span><span class="o">=</span><span class="p">[[</span><span class="mi">1</span><span class="p">]],</span> <span class="n">state_cov</span><span class="o">=</span><span class="p">[[</span><span class="mi">1</span><span class="p">]],</span>
                               <span class="n">design</span><span class="o">=</span><span class="p">[[</span><span class="mi">1</span><span class="p">]],</span> <span class="n">obs_cov</span><span class="o">=</span><span class="p">[[</span><span class="mi">10</span><span class="p">]])</span>
<span class="n">y_gener_target</span><span class="p">,</span> <span class="n">x_gener_target</span> <span class="o">=</span> <span class="n">model_generator</span><span class="o">.</span><span class="n">simulate</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>

<span class="c1"># 데이터 생성</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y_gener_target</span><span class="p">,</span> <span class="s1">&#39;r:&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Observation Values&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_gener_target</span><span class="p">,</span> <span class="s1">&#39;g-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;State Values&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Simulation of Local Level Model ($\sigma_w^2 = 10$, $\sigma_v^2 = 1$)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># 로컬레벨모형 추정</span>
<span class="n">fit</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">UnobservedComponents</span><span class="p">(</span><span class="n">y_gener_target</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="s1">&#39;local level&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">fit</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/4_Algorithms_TS_NonLinear_16_0.png" src="../_images/4_Algorithms_TS_NonLinear_16_0.png" />
<div class="output text_html"><table class="simpletable">
<caption>Unobserved Components Results</caption>
<tr>
  <th>Dep. Variable:</th>           <td>y</td>        <th>  No. Observations:  </th>    <td>100</td>  
</tr>
<tr>
  <th>Model:</th>              <td>local level</td>   <th>  Log Likelihood     </th> <td>-279.818</td>
</tr>
<tr>
  <th>Date:</th>            <td>Fri, 13 Mar 2020</td> <th>  AIC                </th>  <td>563.636</td>
</tr>
<tr>
  <th>Time:</th>                <td>23:32:03</td>     <th>  BIC                </th>  <td>568.827</td>
</tr>
<tr>
  <th>Sample:</th>                  <td>0</td>        <th>  HQIC               </th>  <td>565.736</td>
</tr>
<tr>
  <th></th>                      <td> - 100</td>      <th>                     </th>     <td> </td>   
</tr>
<tr>
  <th>Covariance Type:</th>        <td>opg</td>       <th>                     </th>     <td> </td>   
</tr>
</table>
<table class="simpletable">
<tr>
          <td></td>            <th>coef</th>     <th>std err</th>      <th>z</th>      <th>P>|z|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>sigma2.irregular</th> <td>   13.0642</td> <td>    2.660</td> <td>    4.911</td> <td> 0.000</td> <td>    7.850</td> <td>   18.278</td>
</tr>
<tr>
  <th>sigma2.level</th>     <td>    0.7263</td> <td>    0.431</td> <td>    1.684</td> <td> 0.092</td> <td>   -0.119</td> <td>    1.572</td>
</tr>
</table>
<table class="simpletable">
<tr>
  <th>Ljung-Box (Q):</th>          <td>43.72</td> <th>  Jarque-Bera (JB):  </th> <td>1.48</td>
</tr>
<tr>
  <th>Prob(Q):</th>                <td>0.32</td>  <th>  Prob(JB):          </th> <td>0.48</td>
</tr>
<tr>
  <th>Heteroskedasticity (H):</th> <td>1.01</td>  <th>  Skew:              </th> <td>0.06</td>
</tr>
<tr>
  <th>Prob(H) (two-sided):</th>    <td>0.98</td>  <th>  Kurtosis:          </th> <td>2.41</td>
</tr>
</table><br/><br/>Warnings:<br/>[1] Covariance matrix calculated using the outer product of gradients (complex-step).</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 추정치 시각화</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y_gener_target</span><span class="p">,</span> <span class="s1">&#39;r:&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Observation Values&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_gener_target</span><span class="p">,</span> <span class="s1">&#39;g-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;State Values&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fit</span><span class="o">.</span><span class="n">filtered_state</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;b-.&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Estimation of State Values&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Kalman Filtering of Local Level Model&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># 레벨추정 성분 시각화</span>
<span class="n">fit</span><span class="o">.</span><span class="n">plot_components</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># 잔차진단</span>
<span class="n">fit</span><span class="o">.</span><span class="n">plot_diagnostics</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/4_Algorithms_TS_NonLinear_17_0.png" src="../_images/4_Algorithms_TS_NonLinear_17_0.png" />
<img alt="../_images/4_Algorithms_TS_NonLinear_17_1.png" src="../_images/4_Algorithms_TS_NonLinear_17_1.png" />
<img alt="../_images/4_Algorithms_TS_NonLinear_17_2.png" src="../_images/4_Algorithms_TS_NonLinear_17_2.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 예측</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">forecast</span> <span class="o">=</span> <span class="n">fit</span><span class="o">.</span><span class="n">get_forecast</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y_gener_target</span><span class="p">,</span> <span class="s1">&#39;r:&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Observation Values&quot;</span><span class="p">)</span>
<span class="n">forecast_ci</span> <span class="o">=</span> <span class="n">forecast</span><span class="o">.</span><span class="n">conf_int</span><span class="p">()</span>
<span class="n">forecast_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y_gener_target</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">y_gener_target</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">forecast_ci</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">forecast_index</span><span class="p">,</span> <span class="n">forecast</span><span class="o">.</span><span class="n">predicted_mean</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Observation Values&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">forecast_index</span><span class="p">,</span> <span class="n">forecast_ci</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">forecast_ci</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/4_Algorithms_TS_NonLinear_18_0.png" src="../_images/4_Algorithms_TS_NonLinear_18_0.png" />
</div>
</div>
</div>
<div class="section" id="id4">
<h4>로컬선형레벨 모형<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div><p>랜덤 워크 모형의 관측값이 다시 누적된 것으로 랜덤워크 과정을 따르는 단변수 상태변수 <span class="math notranslate nohighlight">\(\beta_t\)</span>를 가짐
\begin{align*}
&amp;&amp; \beta_t &amp;= \beta_{t-1} + w_{\beta,t} &amp;,;;; &amp; w_{\beta,t} \sim N(0, \sigma_\beta^2) \
&amp;&amp; \mu_t &amp;= \mu_{t-1} + \beta_{t-1} + w_{\mu,t} &amp;,;;; &amp; w_{\mu,t} \sim N(0, \sigma_\mu^2) \
&amp;&amp; Y_{t} &amp;= \mu_{t} + v_t &amp;,;;; &amp; v_t \sim {N}(0, \sigma_v^2) \
\text{Matrix Form} &amp;&amp;
\begin{bmatrix}
\beta_t \ \mu_t
\end{bmatrix}
&amp;=
\begin{bmatrix}
1 &amp; 0 \ 1 &amp; 1 \
\end{bmatrix}
\begin{bmatrix}
\beta_{t-1} \ \mu_{t-1}
\end{bmatrix}</p>
</div></blockquote>
<ul class="simple">
<li></li>
</ul>
<p>\begin{bmatrix}
w_{\beta,t} \ w_{\mu,t}
\end{bmatrix}
\end{align*}</p>
<ul class="simple">
<li><p><strong>로컬선형레벨 모형 <span class="math notranslate nohighlight">\(\Longrightarrow\)</span> ARIMA 모형</strong></p></li>
</ul>
<blockquote>
<div><p><strong>로컬선형레벨 모형은 ARIMA(0,2,2)의 다른표현</strong></p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\Delta^2 Y_t\)</span>는 <span class="math notranslate nohighlight">\(MA(2)\)</span> 모형을 따르고 <span class="math notranslate nohighlight">\(Y_t\)</span>는 <span class="math notranslate nohighlight">\(ARIMA(0,2,2)\)</span> 모형을 따름</p></li>
</ul>
</div></blockquote>
<p>\begin{align*}
\text{Setting of <span class="math notranslate nohighlight">\(\mu_t\)</span>} &amp;&amp; \mu_t &amp;= Y_t - v_t \
\text{Equation of Local Level Model} &amp;&amp; Y_t - v_t &amp;= Y_{t-1} - v_{t-1} + \beta_{t-1} + w_{\mu,t} \
&amp;&amp; \Delta Y_t &amp;= Y_t - Y_{t-1} = \beta_{t-1} + w_{\mu,t} + v_t - v_{t-1} \
\text{Equation of Local Level Model(<span class="math notranslate nohighlight">\(\beta\)</span>)} &amp;&amp; \beta_{t-1} &amp;= \Delta Y_t - w_{\mu,t} - v_t + v_{t-1} \
&amp;&amp; \Delta Y_{t+1} - w_{\mu,t+1} - v_{t+1} + v_{t} &amp;= \Delta Y_t - w_{\mu,t} - v_t + v_{t-1}  + w_{\beta,t} \
&amp;&amp; \Delta Y_{t+1} - \Delta Y_t &amp;= w_{\mu,t+1} + v_{t+1} - v_{t} - w_{\mu,t} - v_t + v_{t-1}  + w_{\beta,t} \
\text{Equation of ARIMA Model} &amp;&amp; \Delta^2 Y_{t+1} &amp;= w_{\mu,t+1} + v_{t+1} - v_{t} - w_{\mu,t} - v_t + v_{t-1}  + w_{\beta,t} \
\end{align*}</p>
<ul class="simple">
<li><p><strong>예시문제1:</strong></p>
<ol class="simple">
<li><p>어떤 섬 근처에서 배가 엔진을 끄고 정지해 다가 어느 시점에 일정 속도로 움직이기 시작했다.</p></li>
<li><p>배의 속도 <span class="math notranslate nohighlight">\(\beta_t\)</span>는 일정하게 유지하고자 하지만 기관의 특성상 조금씩 속도의 변화가 누적될 수 있고, 이 속도 변화 <span class="math notranslate nohighlight">\(w_{\beta,t}\)</span>는 가우시안 정규 분포를 따른다고 가정하자.</p></li>
<li><p>또한 배의 속도 <span class="math notranslate nohighlight">\(\beta_t\)</span>에 의해 배의 위치 <span class="math notranslate nohighlight">\(\mu_t\)</span>는 변화하게 되는데 이 경우에도 파도의 힘에 의해 조금씩 앞뒤로 위치가 바뀔 수 있고 이 미세한 위치 변화 <span class="math notranslate nohighlight">\(w_{\mu,t}\)</span>도 가우시안 정규 분포를 따른다고 가정하자.</p></li>
<li><p>매 시간마다 배의 선원은 섬으로부터의 거리 <span class="math notranslate nohighlight">\(Y_t\)</span>를 배에 있는 초음파 거리계(ultrasonic range finder)로 측정한다.</p></li>
<li><p>이러한 경우에 정확한 거리 <span class="math notranslate nohighlight">\(\mu_t\)</span>를 알고자 하는 것이 바로 로컬 레벨 모형의 필터링(filtering) 문제가 된다.<br />
(*로컬 선형 추세 모형은 오차가 큰 GPS 신호를 사용한 네비게이션에서 차량의 정확한 위치를 추정하는데도 사용된다.)</p></li>
</ol>
</li>
<li><p><strong>예시문제2:</strong></p>
<ol class="simple">
<li><p>거시경제(macro economics) 모형에서 사용하는 대부분의 지표값은 시간이 지나며 선형적 혹은 지수함수적으로 증가하는 경우가 많다.</p></li>
<li><p>이러한 시계열 값은 모두 로컬 선형 추세 모형으로 모형화가 가능하다.</p></li>
</ol>
</li>
</ul>
</div>
<div class="section" id="id5">
<h4>실습: 로컬선형레벨 모형 데이터생성 및 이해<a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="nn">sm</span>
<span class="kn">from</span> <span class="nn">statsmodels.tsa.statespace.kalman_filter</span> <span class="kn">import</span> <span class="n">KalmanFilter</span>

<span class="c1"># 데이터 생성</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">model_generator</span> <span class="o">=</span> <span class="n">KalmanFilter</span><span class="p">(</span><span class="n">k_endog</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">k_states</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">transition</span><span class="o">=</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]],</span> 
                               <span class="n">state_intercept</span><span class="o">=</span><span class="p">[[</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">]],</span> <span class="n">selection</span><span class="o">=</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]],</span> <span class="n">state_cov</span><span class="o">=</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]],</span>
                               <span class="n">design</span><span class="o">=</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]],</span> <span class="n">obs_cov</span><span class="o">=</span><span class="p">[[</span><span class="mi">500</span><span class="p">]])</span>
<span class="n">y_gener</span><span class="p">,</span> <span class="n">x_gener</span> <span class="o">=</span> <span class="n">model_generator</span><span class="o">.</span><span class="n">simulate</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>

<span class="c1"># 데이터 생성</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y_gener</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Observation Values&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_gener</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Speed State&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_gener</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Position State&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Local Level Trend Model&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># 로컬선형레벨모형 추정</span>
<span class="n">fit</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">UnobservedComponents</span><span class="p">(</span><span class="n">y_gener</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="s1">&#39;local linear trend&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">fit</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/4_Algorithms_TS_NonLinear_21_0.png" src="../_images/4_Algorithms_TS_NonLinear_21_0.png" />
<div class="output text_html"><table class="simpletable">
<caption>Unobserved Components Results</caption>
<tr>
  <th>Dep. Variable:</th>            <td>y</td>         <th>  No. Observations:  </th>    <td>100</td>  
</tr>
<tr>
  <th>Model:</th>           <td>local linear trend</td> <th>  Log Likelihood     </th> <td>-454.188</td>
</tr>
<tr>
  <th>Date:</th>             <td>Fri, 13 Mar 2020</td>  <th>  AIC                </th>  <td>914.377</td>
</tr>
<tr>
  <th>Time:</th>                 <td>23:32:12</td>      <th>  BIC                </th>  <td>922.132</td>
</tr>
<tr>
  <th>Sample:</th>                   <td>0</td>         <th>  HQIC               </th>  <td>917.513</td>
</tr>
<tr>
  <th></th>                       <td> - 100</td>       <th>                     </th>     <td> </td>   
</tr>
<tr>
  <th>Covariance Type:</th>         <td>opg</td>        <th>                     </th>     <td> </td>   
</tr>
</table>
<table class="simpletable">
<tr>
          <td></td>            <th>coef</th>     <th>std err</th>      <th>z</th>      <th>P>|z|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>sigma2.irregular</th> <td>  455.8288</td> <td>   79.801</td> <td>    5.712</td> <td> 0.000</td> <td>  299.423</td> <td>  612.235</td>
</tr>
<tr>
  <th>sigma2.level</th>     <td> 2.012e-06</td> <td>   28.472</td> <td> 7.07e-08</td> <td> 1.000</td> <td>  -55.805</td> <td>   55.805</td>
</tr>
<tr>
  <th>sigma2.trend</th>     <td>    0.4817</td> <td>    0.497</td> <td>    0.969</td> <td> 0.332</td> <td>   -0.492</td> <td>    1.456</td>
</tr>
</table>
<table class="simpletable">
<tr>
  <th>Ljung-Box (Q):</th>          <td>48.05</td> <th>  Jarque-Bera (JB):  </th> <td>0.72</td> 
</tr>
<tr>
  <th>Prob(Q):</th>                <td>0.18</td>  <th>  Prob(JB):          </th> <td>0.70</td> 
</tr>
<tr>
  <th>Heteroskedasticity (H):</th> <td>0.68</td>  <th>  Skew:              </th> <td>-0.15</td>
</tr>
<tr>
  <th>Prob(H) (two-sided):</th>    <td>0.28</td>  <th>  Kurtosis:          </th> <td>2.72</td> 
</tr>
</table><br/><br/>Warnings:<br/>[1] Covariance matrix calculated using the outer product of gradients (complex-step).</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 추정치 시각화</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y_gener</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Observation Values&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_gener</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Speed State&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_gener</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Position State&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fit</span><span class="o">.</span><span class="n">filtered_state</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Filtered Position State&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fit</span><span class="o">.</span><span class="n">filtered_state</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Filtered Speed State&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Kalman Filtering of Local Linear Trend Model&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># 레벨추정 성분 시각화</span>
<span class="n">fit</span><span class="o">.</span><span class="n">plot_components</span><span class="p">(</span><span class="n">legend_loc</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># 잔차진단</span>
<span class="n">fit</span><span class="o">.</span><span class="n">plot_diagnostics</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/4_Algorithms_TS_NonLinear_22_0.png" src="../_images/4_Algorithms_TS_NonLinear_22_0.png" />
<img alt="../_images/4_Algorithms_TS_NonLinear_22_1.png" src="../_images/4_Algorithms_TS_NonLinear_22_1.png" />
<img alt="../_images/4_Algorithms_TS_NonLinear_22_2.png" src="../_images/4_Algorithms_TS_NonLinear_22_2.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 예측</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">forecast</span> <span class="o">=</span> <span class="n">fit</span><span class="o">.</span><span class="n">get_forecast</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y_gener</span><span class="p">,</span> <span class="s1">&#39;r:&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Observation Values&quot;</span><span class="p">)</span>
<span class="n">forecast_ci</span> <span class="o">=</span> <span class="n">forecast</span><span class="o">.</span><span class="n">conf_int</span><span class="p">()</span>
<span class="n">forecast_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y_gener</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">y_gener</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">forecast_ci</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">forecast_index</span><span class="p">,</span> <span class="n">forecast</span><span class="o">.</span><span class="n">predicted_mean</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Observation Values&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">forecast_index</span><span class="p">,</span> <span class="n">forecast_ci</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">forecast_ci</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/4_Algorithms_TS_NonLinear_23_0.png" src="../_images/4_Algorithms_TS_NonLinear_23_0.png" />
</div>
</div>
</div>
</div>
<div class="section" id="id6">
<h3>상태공간모형 기반의 시계열 “구조화모형”<a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><p><strong>개별적 동적 특성(Dynamics, Transition Equation)을 정의할 수 있는 성분의 합 등으로 구성된 모형을 구조적 모형 또는 구조화 모형(Structural Model)</strong></p>
<ul class="simple">
<li><p>로컬 선형추세 모형에서 볼 수 있듯 상태공간모형의 장점은 실제로 관측된 하나의 시계열 자료로 부터 복수의 상태변수 시계열자료를 추정할 수 있다는 점</p></li>
<li><p>각각의 상태변수가 동적특성(Dynamics), 즉 상태 전이식(State Transition Equantion)에 대한 가정 필요</p></li>
<li><p>하나의 시계열 자료가 실제 여러개의 보이지 않는 성분들(Unobserved Components)이 합쳐진 것이라고 가정하고 각각의 성분을 추정하는 것이 가능(시계열 성분분리 가능)</p></li>
<li><p>각 성분의 동적특성을 이미 알거나 가정해야 하며 각 동적 특성이 구별가능할 정도로 충분이 달라야 함</p></li>
<li><p>보이지 않는 성분을 추정하는 모형이므로 Unobserved Component 모형이라고도 불림</p></li>
<li><p>예시: 시계열 = 추세성분 + 계절성성분 + ARMA성분</p></li>
</ul>
</div></blockquote>
<blockquote>
<div><p>\begin{align*}
\text{Main Equation} &amp;&amp; Y_{T} &amp;= T_{t} + S_{t} + A_{t} \
\text{Each Equations} &amp;&amp; T_{t} &amp;= \Phi_T T_{t-1} + w_{T,t} \
&amp;&amp; S_{t} &amp;= \Phi_S S_{t-1} + w_{S,t} \
&amp;&amp; A_{t} &amp;= \Phi_A A_{t-1} + w_{A,t} \
\text{Matrix Form} &amp;&amp;
Y_{T} &amp;=
\begin{bmatrix}
1 &amp; 1 &amp; 1
\end{bmatrix}
\begin{bmatrix}
T_{t} \ S_{t} \ A_{t} \
\end{bmatrix}</p>
</div></blockquote>
<ul class="simple">
<li><p>v_t \
\text{where} &amp;&amp;
\begin{bmatrix}
T_{t} \ S_{t} \ A_{t} \
\end{bmatrix}
&amp;=
\begin{bmatrix}
\Phi_T &amp;   0     &amp;        \
0      &amp; \Phi_S  &amp;      0 \
0      &amp;      0  &amp; \Phi_A \
\end{bmatrix}
\begin{bmatrix}
T_{t-1} \ S_{t-1} \ A_{t-1} \
\end{bmatrix}</p></li>
<li></li>
</ul>
<p>\begin{bmatrix}
w_{T,t} \ w_{S,t} \ w_{A,t} \
\end{bmatrix} \
\end{align*}</p>
<ul class="simple">
<li><p><strong>구조화모형 성분:</strong></p>
<ol class="simple">
<li><p>추세(Trend) 성분</p></li>
<li><p>계절성(Seasonal) 성분</p></li>
<li><p>주기적(Cyclical) 성분</p></li>
<li><p>AR(Autoregressive) 성분</p></li>
<li><p>회귀(Regression) 성분</p></li>
</ol>
</li>
</ul>
<p><strong>1) 추세(Trend) 성분:</strong> 로컬레벨 모형이나 로컬선형추세 모형도 추세성분 모형의 일종</p>
<ul class="simple">
<li><p>레벨모형
\begin{align*}
\text{Fixed Intercept} &amp;&amp; y_t &amp;= \mu \
\text{Deterministic Constant} &amp;&amp; y_t &amp;= \mu + \varepsilon_t \
\text{Local Level} &amp;&amp; y_t &amp;= \mu_t + \varepsilon_t \
&amp;&amp; \mu_t &amp;= \mu_{t-1} + \eta_t \
\end{align*}</p></li>
<li><p>결정론적 추세
\begin{align*}
\text{Fixed Slope} &amp;&amp; y_t &amp;= \mu_t \
&amp;&amp; \mu_t &amp;= \mu_{t-1} + \beta \
\text{Deterministic Trend} &amp;&amp; y_t &amp;= \mu_t + \varepsilon_t \
&amp;&amp; \mu_t &amp;= \mu_{t-1} + \beta \
\text{Local Linear Deterministic Trend} &amp;&amp; y_t &amp;= \mu_t + \varepsilon_t \
&amp;&amp; \mu_t &amp;= \mu_{t-1} + \beta + \eta_t \
\end{align*}</p></li>
<li><p>확률론적 추세
\begin{align*}
\text{Random Walk} &amp;&amp; y_t &amp;= \mu_t \
&amp;&amp; \mu_t &amp;= \mu_{t-1} + \eta_t \
\text{Random Walk with Drift} &amp;&amp; y_t &amp;= \mu_t \
&amp;&amp; \mu_t &amp;= \mu_{t-1} + \beta + \eta_t \
\text{Local Linear Trend} &amp;&amp; y_t &amp;= \mu_t + \varepsilon_t \
&amp;&amp; \mu_t &amp;= \mu_{t-1} + \beta_{t-1} + \eta_t \
&amp;&amp; \beta_t &amp;= \beta_{t-1} + \zeta_t \
\end{align*}</p></li>
</ul>
<p><strong>2) 계절성(Seasonality) 성분:</strong> 주기가 명확한 성분</p>
<blockquote>
<div><ul class="simple">
<li><p>분기/월/요일/시간 등에 결정되는 반복적 요소는 계절성 성분, 주기적(Cyclical) 성분과는 구분됨</p></li>
<li><p>주기내의 값이 원래 일정(Level or Flat)해야 하는 것이 주기성에 의해 흔들린다고 보는 것</p></li>
<li><p>계절성 성분은 한 주기 내 각 성분의 합이 0이 되는 모형을 사용하며, 여기에 추가적으로 가우시안 잡음이 더해질 수 있음</p></li>
<li><p>예시: 4개의 계절성을 가지는 경우</p></li>
</ul>
</div></blockquote>
<blockquote>
<div><p>\begin{align*}
\text{4 Seasonality} &amp;&amp; S_t + S_{t-1} + S_{t-2} + S_{t-3} &amp;= w_{S,t} \
\text{Matrix Form} &amp;&amp;
\begin{bmatrix}
S_{t} \ S_{t-1} \ S_{t-2} \
\end{bmatrix}
&amp;=
\begin{bmatrix}
-1 &amp; -1 &amp; -1 \  1 &amp;  0 &amp;  0 \  0 &amp;  1 &amp;  0 \
\end{bmatrix}
\begin{bmatrix}
S_{t-1} \ S_{t-2} \ S_{t-3} \
\end{bmatrix}</p>
</div></blockquote>
<ul class="simple">
<li></li>
</ul>
<p>\begin{bmatrix}
w_{S, t} \ 0 \ 0 \
\end{bmatrix} \
\end{align*}</p>
<p><strong>3) 주기적(Cyclical) 성분:</strong> 주기가 명확하지 않거나 크기가 일정하지 않은 성분</p>
<blockquote>
<div><ul class="simple">
<li><p>모수 <span class="math notranslate nohighlight">\(\lambda_c\)</span>를 가지는 하모닉 상태 변수 쌍(pair)으로 모형화가 가능</p></li>
<li><p>만약 <span class="math notranslate nohighlight">\(\rho_c\)</span>가 1보다 작으면 점차 감소하는(damped) 주기적 성분</p></li>
</ul>
</div></blockquote>
<blockquote>
<div><p>\begin{align*}
\text{Pairwise Cycle}
&amp;&amp; c_{t}   &amp; = \rho_c (  \tilde c_{t} \cos \lambda_c t + \tilde c_{t}^* \sin \lambda_c t) + \tilde w_{t} \
&amp;&amp; c_{t}^* &amp; = \rho_c (- \tilde c_{t} \sin \lambda_c t + \tilde c_{t}^* \cos \lambda_c t) + \tilde w_{t}^* \
\text{Matrix Form} &amp;&amp;
\begin{bmatrix}
c_{t} \ c_{t}^* \
\end{bmatrix}
&amp;= \rho_c
\begin{bmatrix}
\cos \lambda_c t &amp; \sin \lambda_c t \ -\sin \lambda_c t &amp; \cos \lambda_c t \
\end{bmatrix}
\begin{bmatrix}
c_{t-1} \ c_{t-1}^* \
\end{bmatrix}</p>
</div></blockquote>
<ul class="simple">
<li></li>
</ul>
<p>\begin{bmatrix}
w_{C, t} \ w_{C, t}^* \
\end{bmatrix} \
&amp;&amp; &amp; \text{(<em>행렬식의 계수는 시간에 따라 계속 변화함)}
\end{align</em>}</p>
<p><strong>4) AR 성분:</strong> 일반적인 AR(p) 성분 모형도 상태 변수 형태로 변환 가능</p>
<p><strong>5) 회귀 성분:</strong> 내부 이노베이션 과정을 입력으로 가지는 것이 아니라 외부(Exogenous) 입력신호를 선형회귀식 형태로 가지는 성분</p>
<div class="section" id="id7">
<h4>실습: 구조화모형을 사용한 성분 분리<a class="headerlink" href="#id7" title="Permalink to this headline">¶</a></h4>
<p>\begin{align*}
y_t &amp; = \mu_t + \eta_t \
\mu_{t+1} &amp; = \mu_t + \epsilon_{t+1} \
\eta_{t+1} &amp; = \eta_t \cos \lambda_\eta + \eta_t^* \sin \lambda_\eta + \tilde \omega_t \qquad &amp; \tilde \omega_t \sim N(0, \sigma_{\tilde \omega}^2) \
\eta_{t+1}^* &amp; = -\eta_t \sin \lambda_\eta + \eta_t^* \cos \lambda_\eta + \tilde \omega_t^* &amp; \tilde \omega_t^* \sim N(0, \sigma_{\tilde \omega}^2)
\end{align*}</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="nn">sm</span>
<span class="kn">from</span> <span class="nn">statsmodels.tsa.statespace.kalman_filter</span> <span class="kn">import</span> <span class="n">KalmanFilter</span>
<span class="kn">import</span> <span class="nn">pandas_datareader.data</span> <span class="k">as</span> <span class="nn">web</span>

<span class="c1"># 데이터 로딩</span>
<span class="n">unemployment_US</span> <span class="o">=</span> <span class="n">web</span><span class="o">.</span><span class="n">DataReader</span><span class="p">(</span><span class="s1">&#39;UNRATE&#39;</span><span class="p">,</span> <span class="s1">&#39;fred&#39;</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="s1">&#39;1954-01-01&#39;</span><span class="p">)</span>
<span class="n">unemployment_US</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/4_Algorithms_TS_NonLinear_26_0.png" src="../_images/4_Algorithms_TS_NonLinear_26_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 구조화모형 추정</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">UnobservedComponents</span><span class="p">(</span><span class="n">unemployment_US</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="s1">&#39;rwalk&#39;</span><span class="p">,</span> <span class="n">cycle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                                  <span class="n">stochastic_cycle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">damped_cycle</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;powell&#39;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>

<span class="c1"># 추정 시각화</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">unemployment_US</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">unemployment_US</span><span class="o">.</span><span class="n">UNRATE</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Unemployment Rate&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">unemployment_US</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">result</span><span class="o">.</span><span class="n">level</span><span class="o">.</span><span class="n">smoothed</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Random Walk&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Level/Trend Component&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Cycle Component&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">unemployment_US</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">result</span><span class="o">.</span><span class="n">cycle</span><span class="o">.</span><span class="n">smoothed</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Cyclic&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># 잔차진단</span>
<span class="n">result</span><span class="o">.</span><span class="n">plot_diagnostics</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Optimization terminated successfully.
         Current function value: -0.278485
         Iterations: 8
         Function evaluations: 424
</pre></div>
</div>
<div class="output text_html"><table class="simpletable">
<caption>Unobserved Components Results</caption>
<tr>
  <th>Dep. Variable:</th>            <td>UNRATE</td>           <th>  No. Observations:  </th>    <td>794</td>  
</tr>
<tr>
  <th>Model:</th>                  <td>random walk</td>        <th>  Log Likelihood     </th>  <td>221.117</td>
</tr>
<tr>
  <th></th>                 <td>+ damped stochastic cycle</td> <th>  AIC                </th> <td>-434.235</td>
</tr>
<tr>
  <th>Date:</th>                <td>Fri, 13 Mar 2020</td>      <th>  BIC                </th> <td>-415.541</td>
</tr>
<tr>
  <th>Time:</th>                    <td>23:32:22</td>          <th>  HQIC               </th> <td>-427.050</td>
</tr>
<tr>
  <th>Sample:</th>                 <td>01-01-1954</td>         <th>                     </th>     <td> </td>   
</tr>
<tr>
  <th></th>                       <td>- 02-01-2020</td>        <th>                     </th>     <td> </td>   
</tr>
<tr>
  <th>Covariance Type:</th>            <td>opg</td>            <th>                     </th>     <td> </td>   
</tr>
</table>
<table class="simpletable">
<tr>
         <td></td>            <th>coef</th>     <th>std err</th>      <th>z</th>      <th>P>|z|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>sigma2.level</th>    <td>    0.0146</td> <td>    0.005</td> <td>    2.879</td> <td> 0.004</td> <td>    0.005</td> <td>    0.025</td>
</tr>
<tr>
  <th>sigma2.cycle</th>    <td>    0.0167</td> <td>    0.005</td> <td>    3.403</td> <td> 0.001</td> <td>    0.007</td> <td>    0.026</td>
</tr>
<tr>
  <th>frequency.cycle</th> <td>    0.0698</td> <td>    0.005</td> <td>   13.611</td> <td> 0.000</td> <td>    0.060</td> <td>    0.080</td>
</tr>
<tr>
  <th>damping.cycle</th>   <td>    0.9896</td> <td>    0.004</td> <td>  238.884</td> <td> 0.000</td> <td>    0.982</td> <td>    0.998</td>
</tr>
</table>
<table class="simpletable">
<tr>
  <th>Ljung-Box (Q):</th>          <td>170.99</td> <th>  Jarque-Bera (JB):  </th> <td>86.95</td>
</tr>
<tr>
  <th>Prob(Q):</th>                 <td>0.00</td>  <th>  Prob(JB):          </th> <td>0.00</td> 
</tr>
<tr>
  <th>Heteroskedasticity (H):</th>  <td>0.48</td>  <th>  Skew:              </th> <td>0.48</td> 
</tr>
<tr>
  <th>Prob(H) (two-sided):</th>     <td>0.00</td>  <th>  Kurtosis:          </th> <td>4.32</td> 
</tr>
</table><br/><br/>Warnings:<br/>[1] Covariance matrix calculated using the outer product of gradients (complex-step).</div><img alt="../_images/4_Algorithms_TS_NonLinear_27_2.png" src="../_images/4_Algorithms_TS_NonLinear_27_2.png" />
<img alt="../_images/4_Algorithms_TS_NonLinear_27_3.png" src="../_images/4_Algorithms_TS_NonLinear_27_3.png" />
</div>
</div>
<ul class="simple">
<li><p><strong>주기적 성분 대신 AR(4) 모형 대체</strong></p></li>
</ul>
<p>\begin{align*}
y_t &amp; = \mu_t + \eta_t \
\mu_{t+1} &amp; = \mu_t + \epsilon_{t+1} \
\phi(L) \eta_t &amp; = \nu_t
\end{align*}</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 구조화모형 추정</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">UnobservedComponents</span><span class="p">(</span><span class="n">unemployment_US</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="s1">&#39;rwalk&#39;</span><span class="p">,</span> <span class="n">autoregressive</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;powell&#39;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>

<span class="c1"># 추정 시각화</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">unemployment_US</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">unemployment_US</span><span class="o">.</span><span class="n">UNRATE</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Unemployment Rate&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">unemployment_US</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">result</span><span class="o">.</span><span class="n">level</span><span class="o">.</span><span class="n">smoothed</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Random Walk&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Level/Trend Component&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;AR Component&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">unemployment_US</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">result</span><span class="o">.</span><span class="n">autoregressive</span><span class="o">.</span><span class="n">smoothed</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;AR&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># 잔차진단</span>
<span class="n">result</span><span class="o">.</span><span class="n">plot_diagnostics</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Optimization terminated successfully.
         Current function value: -0.324535
         Iterations: 8
         Function evaluations: 614
</pre></div>
</div>
<div class="output text_html"><table class="simpletable">
<caption>Unobserved Components Results</caption>
<tr>
  <th>Dep. Variable:</th>        <td>UNRATE</td>      <th>  No. Observations:  </th>    <td>794</td>  
</tr>
<tr>
  <th>Model:</th>              <td>random walk</td>   <th>  Log Likelihood     </th>  <td>257.681</td>
</tr>
<tr>
  <th></th>                      <td>+ AR(4)</td>     <th>  AIC                </th> <td>-503.362</td>
</tr>
<tr>
  <th>Date:</th>            <td>Fri, 13 Mar 2020</td> <th>  BIC                </th> <td>-475.307</td>
</tr>
<tr>
  <th>Time:</th>                <td>23:32:27</td>     <th>  HQIC               </th> <td>-492.580</td>
</tr>
<tr>
  <th>Sample:</th>             <td>01-01-1954</td>    <th>                     </th>     <td> </td>   
</tr>
<tr>
  <th></th>                   <td>- 02-01-2020</td>   <th>                     </th>     <td> </td>   
</tr>
<tr>
  <th>Covariance Type:</th>        <td>opg</td>       <th>                     </th>     <td> </td>   
</tr>
</table>
<table class="simpletable">
<tr>
        <td></td>          <th>coef</th>     <th>std err</th>      <th>z</th>      <th>P>|z|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>sigma2.level</th> <td>    0.0172</td> <td>    0.003</td> <td>    6.277</td> <td> 0.000</td> <td>    0.012</td> <td>    0.023</td>
</tr>
<tr>
  <th>sigma2.ar</th>    <td>    0.0109</td> <td>    0.003</td> <td>    3.579</td> <td> 0.000</td> <td>    0.005</td> <td>    0.017</td>
</tr>
<tr>
  <th>ar.L1</th>        <td>    1.0368</td> <td>    0.064</td> <td>   16.127</td> <td> 0.000</td> <td>    0.911</td> <td>    1.163</td>
</tr>
<tr>
  <th>ar.L2</th>        <td>    0.4734</td> <td>    0.103</td> <td>    4.580</td> <td> 0.000</td> <td>    0.271</td> <td>    0.676</td>
</tr>
<tr>
  <th>ar.L3</th>        <td>   -0.3340</td> <td>    0.122</td> <td>   -2.729</td> <td> 0.006</td> <td>   -0.574</td> <td>   -0.094</td>
</tr>
<tr>
  <th>ar.L4</th>        <td>   -0.1866</td> <td>    0.075</td> <td>   -2.490</td> <td> 0.013</td> <td>   -0.333</td> <td>   -0.040</td>
</tr>
</table>
<table class="simpletable">
<tr>
  <th>Ljung-Box (Q):</th>          <td>75.39</td> <th>  Jarque-Bera (JB):  </th> <td>45.00</td>
</tr>
<tr>
  <th>Prob(Q):</th>                <td>0.00</td>  <th>  Prob(JB):          </th> <td>0.00</td> 
</tr>
<tr>
  <th>Heteroskedasticity (H):</th> <td>0.49</td>  <th>  Skew:              </th> <td>0.25</td> 
</tr>
<tr>
  <th>Prob(H) (two-sided):</th>    <td>0.00</td>  <th>  Kurtosis:          </th> <td>4.06</td> 
</tr>
</table><br/><br/>Warnings:<br/>[1] Covariance matrix calculated using the outer product of gradients (complex-step).</div><img alt="../_images/4_Algorithms_TS_NonLinear_29_2.png" src="../_images/4_Algorithms_TS_NonLinear_29_2.png" />
<img alt="../_images/4_Algorithms_TS_NonLinear_29_3.png" src="../_images/4_Algorithms_TS_NonLinear_29_3.png" />
</div>
</div>
</div>
</div>
<div class="section" id="id8">
<h3>확장 알고리즘 및 응용 예시<a class="headerlink" href="#id8" title="Permalink to this headline">¶</a></h3>
<p><strong>1) 확률적 변동성 모형 (Stochastic Volatility Model)</strong></p>
<blockquote>
<div><ul class="simple">
<li><p>정적 변동성 모형: ARCH(Autoregressive conditional heteroskedasticity), GARCH(Generalized Autoregressive conditional heteroskedasticity)</p></li>
<li><p>정적 변동성 모형과 달리 변동성 자체를 하나의 독립적인 상태 변수로 가정</p></li>
<li><p>널리 사용되는 Heston 모형은 다음과 같이 분산(Variance) 상태 변수 <span class="math notranslate nohighlight">\(\nu_t\)</span>를 가지는 연속 시간 모형</p></li>
</ul>
</div></blockquote>
<p>\begin{align*}
dS_t   &amp;= \mu S_t,dt + \sqrt{\nu_t} S_t,dW^S_t  \
d\nu_t &amp;= \kappa(\theta - \nu_t),dt + \xi \sqrt{\nu_t},dW^{\nu}_t
\end{align*}</p>
<p><strong>2) 히든 마코프 모형 (HMM: Hidden Markov Model)</strong></p>
<blockquote>
<div><ul class="simple">
<li><p>상태 변수  <span class="math notranslate nohighlight">\(x\)</span> 값이 연속 확률변수가 아니라 1차원 이산 확률변수(Discrete Random Variable)인 경우 히든 마코프 모형이 됨</p></li>
<li><p>히든 마코프 모형의 상태 전이식은 다음과 같은 조건부 확률로 정의됨</p></li>
<li><p>주로 음성 처리에서 많이 사용되지만 경제학 분야에서도 구조적 변화에 의한 시계열 특성이 변화하는 경우에 사용됨</p></li>
</ul>
</div></blockquote>
<ul class="simple">
<li><p><strong>독립 혼합 모형(Independent Mixuture Model)</strong></p></li>
</ul>
<blockquote>
<div><p><strong>연속 확률변수임에도 단일 확률분포를 가지지 않고 복수의 확률분포를 가지는 경우, 독립적 이산 확률분포로 복수의 확률분포를 추정하는 모형</strong>
\begin{align*}
p(y) &amp;= \sum_{i=1}^m {P}(C=i)\cdot {P}(Y=y|C=i) \
&amp;= \sum_{i=1}^m \delta_i p_i(y)
\end{align*}</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(p(y)\)</span>: 전체 Independent Mixuture 분포</p></li>
<li><p><span class="math notranslate nohighlight">\(pi(y)\)</span>: Independent Mixuture 각 성분(Component)의 개별적인 연속 확률분포</p></li>
<li><p><span class="math notranslate nohighlight">\(\delta_i\)</span>: Mixing Parameter로 특정시간의 모든 성분 중 특정한 <span class="math notranslate nohighlight">\(pi(y)\)</span>가 선택될 확률(이산 확률 분포)</p></li>
<li><p><span class="math notranslate nohighlight">\(\sum \delta_i\)</span>: Mixing Parameter에 대한 확률 제한 조건</p></li>
</ul>
</div></blockquote>
<blockquote>
<div><ul class="simple">
<li><p><strong>예시: 베르누이-정규 혼합모형(Binomial Normal-Mixture Model)</strong>
- 베르누이 확률변수의 값에 따라 두개의 서로다른 연속정규분포 중 하나를 선택하는 확률분포
<center><img src='Image/HMM_Normal-Mixture.png' width='500'></center></p></li>
</ul>
</div></blockquote>
<ul class="simple">
<li><p><strong>마코프 체인(Markov Chain)</strong></p></li>
</ul>
<blockquote>
<div><ul class="simple">
<li><p><strong>마코프 체인(Markov Chain):</strong> 다음과 같은 특성을 가진 이산시간 확률 프로세스
\begin{align*}
P(C_{t+1} \mid C_t, \cdots, C_1) = P(C_{t+1} \mid C_t)
\end{align*}</p></li>
<li><p><strong>전이확률(Transition Probability):</strong> <span class="math notranslate nohighlight">\(t\)</span>시간 동안 특정 상태 <span class="math notranslate nohighlight">\(i\)</span>에서 다른 상태 <span class="math notranslate nohighlight">\(j\)</span>로 전이할 확률
\begin{align*}
\gamma_{ij}(t) = P(C_{s+t}=j|C_{s}=i)
\end{align*}</p></li>
<li><p><strong>전이행렬(Transition Matrix):</strong> 모든 상태조합에 대한 전이확률
\begin{align*}
\Gamma(t) = { \gamma_{ij}(t) }, ;;; \Gamma = \Gamma(1)
\end{align*}</p></li>
<li><p><strong>체프먼-콜모고로프 방정식(Chapman-Kolmogorov Equation):</strong> 시간 <span class="math notranslate nohighlight">\(t+u\)</span>의 전이확률행렬은 시간<span class="math notranslate nohighlight">\(t\)</span>의 전이확률행렬과 시간 <span class="math notranslate nohighlight">\(u\)</span>의 전이확률행렬의 곱
\begin{align*}
\Gamma(t+u) = \Gamma(t)\Gamma(u)
\end{align*}</p></li>
<li><p><strong>디코드(Decode):</strong> 관측된 HMM 모형의 연혹 확률변수 값으로 내부의 이산 확률변수 값을 추정하는 과정</p></li>
</ul>
</div></blockquote>
<ul class="simple">
<li><p><strong>히든 마코프 모형(Hidden Markov Model)</strong></p></li>
</ul>
<blockquote>
<div><p><strong>독립 혼합 모형에서 연속 확률분포를 선택하는 이산확률과정 <span class="math notranslate nohighlight">\(C_t\)</span>가 마코프 체인이고 연속확률분포 <span class="math notranslate nohighlight">\(Y_t\)</span>가 그 시점의 이산 확률과정의 값에만 의존하는 모형</strong></p>
<ul class="simple">
<li><p>연속 확률 분포의 값 <span class="math notranslate nohighlight">\(X_t\)</span>만 측정 가능하고 이산 확률 과정의 값 <span class="math notranslate nohighlight">\(C_t\)</span>는 측정 불가
\begin{align*}
P(C_t \mid |C_{t-1}, \cdots, C_1) = P(C_t \mid C_{t-1}) \
P(Y_t \mid Y_t, \cdots, Y_1, C_t, \cdots, C_1) = P(Y_t \mid C_t)
\end{align*}
<center><img src='Image/HMM_General.png' width='500'></center></p></li>
</ul>
</div></blockquote>
<ul class="simple">
<li><p><strong>HMM 모듈 정리</strong></p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">hmmlearn</span> <span class="kn">import</span> <span class="n">hmm</span>
</pre></div>
</div>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>클래스 이름</p></th>
<th class="head"><p>용도</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>GaussianHMM</p></td>
<td><p>Hidden Markov Model with Gaussian emissions</p></td>
</tr>
<tr class="row-odd"><td><p>GMMHMM</p></td>
<td><p>Hidden Markov Model with Gaussian mixture emissions</p></td>
</tr>
<tr class="row-even"><td><p>MultinomialHMM</p></td>
<td><p>Hidden Markov Model with multinomial (discrete) emissions</p></td>
</tr>
</tbody>
</table>
<ul class="simple">
<li><p><strong>GaussianHMM:</strong> 카테고리-다변수 정규분포 혼합 모형 시뮬레이션</p></li>
</ul>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>출력모듈</p></th>
<th class="head"><p>설명</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>startprob_</p></td>
<td><p>초기 확률 벡터</p></td>
</tr>
<tr class="row-odd"><td><p>transmat_</p></td>
<td><p>전이 확률 행렬</p></td>
</tr>
<tr class="row-even"><td><p>means_</p></td>
<td><p>정규 분포의 기댓값 벡터</p></td>
</tr>
<tr class="row-odd"><td><p>covars_</p></td>
<td><p>정규 분포의 공분산 행렬</p></td>
</tr>
</tbody>
</table>
<p><strong>3) 칼만 필터</strong></p>
<blockquote>
<div><ul class="simple">
<li><p>선형 동적 모형에 대한 필터링 문제와 스무딩 문제를 푸는 방법 중 가장 널리 쓰임</p></li>
<li><p>칼만 필터는 확률 변수의 분포를 갱신하는 베이지안 필터(Bayesian Filter)의 한 종류</p></li>
<li><p>가우시안 분포를 가지는 선형 시스템이라는 제약 조건을 훌륭하게 사용하여 상태 변수의 평균과 분산을 간단히 갱신하는 효율적 알고리즘
\begin{align*}
\text{Main Equation} &amp;&amp; \alpha_t &amp;= T_t \alpha_{t-1} + c_t + R_t \eta_t \
&amp;&amp; y_t &amp;= Z_t \alpha_t + d_t + \varepsilon_t \
\text{where} &amp;&amp; &amp; \text{<span class="math notranslate nohighlight">\(\alpha_t\)</span>: State Vector} \
&amp;&amp; &amp; \text{<span class="math notranslate nohighlight">\(T_t\)</span>: Transition Matrix} \
&amp;&amp; &amp; \text{<span class="math notranslate nohighlight">\(c_t\)</span>: State Intercept Vector} \
&amp;&amp; &amp; \text{<span class="math notranslate nohighlight">\(R_t\)</span>: Selection Matrix} \
&amp;&amp; &amp; \text{<span class="math notranslate nohighlight">\(\eta_t \sim N(0, Q_t)\)</span>: Innovation Process Vector} \
&amp;&amp; &amp; \text{<span class="math notranslate nohighlight">\(Q_t\)</span>: State Covariance Matrix} \
&amp;&amp; &amp; \text{<span class="math notranslate nohighlight">\(y_t\)</span>: Observation Vector} \
&amp;&amp; &amp; \text{<span class="math notranslate nohighlight">\(Z_t\)</span>: Design Matrix} \
&amp;&amp; &amp; \text{<span class="math notranslate nohighlight">\(d_t\)</span>: Observation Intercept Vector} \
&amp;&amp; &amp; \text{<span class="math notranslate nohighlight">\(\epsilon_t \sim N(0, H_t)\)</span>: Observation Error Vector} \
&amp;&amp; &amp; \text{<span class="math notranslate nohighlight">\(H_t\)</span>: Observation Covariance Matrix} \
\end{align*}</p></li>
</ul>
</div></blockquote>
<ul class="simple">
<li><p><a class="reference external" href="http://www.statsmodels.org/dev/generated/statsmodels.tsa.statespace.kalman_filter.KalmanFilter.html"><strong>Falman Filter 모듈 정리</strong></a></p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">statsmodels.tsa.statespace.kalman_filter</span> <span class="kn">import</span> <span class="n">KalmanFilter</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">KalmanFilter</span><span class="p">(</span><span class="n">yt</span><span class="p">,</span> <span class="n">k_states</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">transition</span><span class="o">=</span><span class="p">[[</span><span class="mi">1</span><span class="p">]],</span> <span class="n">selection</span><span class="o">=</span><span class="p">[[</span><span class="mi">1</span><span class="p">]],</span>
                     <span class="n">state_cov</span><span class="o">=</span><span class="p">[[</span><span class="mi">10</span><span class="p">]],</span> <span class="n">design</span><span class="o">=</span><span class="p">[[</span><span class="mi">1</span><span class="p">]],</span> <span class="n">obs_cov</span><span class="o">=</span><span class="p">[[</span><span class="mi">100</span><span class="p">]])</span>
</pre></div>
</div>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>입력옵션</p></th>
<th class="head"><p>설명</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>k_endog</p></td>
<td><p>정수 혹은 배열. 배열인 경우에는 칼만필터를 적용할 실제 시계열 자료. 정수인 경우에는 출력 변수의 수</p></td>
</tr>
<tr class="row-odd"><td><p>k_states</p></td>
<td><p>정수. 상태 변수의 수</p></td>
</tr>
<tr class="row-even"><td><p>k_posdef</p></td>
<td><p>(옵션) 정수. 출력 잡음의 공분산 중 양 한정(Positive Definite)을 보장하는 차원의 수. 디폴트는 k_states</p></td>
</tr>
<tr class="row-odd"><td><p>transition</p></td>
<td><p>(옵션) 상태 전이 행렬(Transition Matrix). 디폴트는 0</p></td>
</tr>
<tr class="row-even"><td><p>state_intercept</p></td>
<td><p>(옵션) 상태 전이식의 절편(Intercept for the Transition Equation). 디폴트는 0</p></td>
</tr>
<tr class="row-odd"><td><p>selection</p></td>
<td><p>(옵션) 이노베이션 과정에 대한 선택 행렬(Selection Matrix). 디폴트는 0</p></td>
</tr>
<tr class="row-even"><td><p>state_cov</p></td>
<td><p>(옵션) 이노베이션 과정의 공분산 행렬. 디폴트는 0</p></td>
</tr>
<tr class="row-odd"><td><p>design</p></td>
<td><p>(옵션) 설계 행렬(Design Matrix). 디폴트는 0</p></td>
</tr>
<tr class="row-even"><td><p>obs_intercept</p></td>
<td><p>(옵션) 관측식의 절편(Intercept for the Observation Equation). 디폴트는 0</p></td>
</tr>
<tr class="row-odd"><td><p>obs_cov</p></td>
<td><p>(옵션) 관측 행렬의 공분산 행렬. 디폴트는 0</p></td>
</tr>
<tr class="row-even"><td><p>initial_state</p></td>
<td><p>(옵션) 배열. 초기 상태 변수 값</p></td>
</tr>
<tr class="row-odd"><td><p>initialization</p></td>
<td><p>(옵션) 다음 문자열 중 하나 {approximate_diffuse, stationary, known} (옵션) 상태 변수 초기화 방법</p></td>
</tr>
<tr class="row-even"><td><p>initial_variance</p></td>
<td><p>(옵션) 실수. 초기화 방법이 Approximate_diffuse 일 경우의 초기 분산 값. 디폴트는 1e6</p></td>
</tr>
<tr class="row-odd"><td><p>initial_state_cov</p></td>
<td><p>(옵션) 배열. 초기화 방법이 Known 일 경우 사용하는 분산 행렬</p></td>
</tr>
<tr class="row-even"><td><p>nobs</p></td>
<td><p>(옵션) 정수. k_endog가 정수인 경우에 시계열 자료의 길이를 표시</p></td>
</tr>
<tr class="row-odd"><td><p>loglikelihood_burn</p></td>
<td><p>(옵션) 정수. Log-likelihood를 기록하지 않는 Burn-in 구간의 길이. 디폴트는 0</p></td>
</tr>
<tr class="row-even"><td><p>tolerance</p></td>
<td><p>(옵션) 실수. 상태변수의 수렴 기준. 디폴트는 1e-19</p></td>
</tr>
</tbody>
</table>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>출력모듈</p></th>
<th class="head"><p>설명</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>simulate</p></td>
<td><p>모수가 모두 충족된 경우 시뮬레이션 수행</p></td>
</tr>
<tr class="row-odd"><td><p>initialize_known</p></td>
<td><p>초기 상태 생성 (상태값을 아는 경우)</p></td>
</tr>
<tr class="row-even"><td><p>initialize_stationary</p></td>
<td><p>초기 상태 생성 (정상 상태)</p></td>
</tr>
<tr class="row-odd"><td><p>initialize_approximate_diffuse</p></td>
<td><p>초기 상태 생성</p></td>
</tr>
<tr class="row-even"><td><p>filter</p></td>
<td><p>필터링. FilterResults 객체 출력</p></td>
</tr>
</tbody>
</table>
<p><strong>4) 마코프 체인 몬테카를로 (MCMC: Markov Chain Monte Carlo)</strong></p>
<blockquote>
<div><ul class="simple">
<li><p>상태 공간 모형의 확률 분포가 가우시안 정규 분포가 아니거나 정확한 분포의 수식을 알 수 없을 때 주로 활용</p></li>
<li><p>MCMC 방법은 특정한 마코프 체인 확률 과정을 사용하여 생성한 시뮬레이션을 통해 분포의 형상을 추정</p></li>
</ul>
</div></blockquote>
<p><strong>5) 응용 사례</strong></p>
<blockquote>
<div><ul class="simple">
<li><p>자동 제어(automatic), 항법(navigation) 시스템. 신호처리(signal processing) 분야에 많이 사용</p></li>
<li><p>최근에는 경제학이나 일반 시계열 모형에서도 상태 공간 모형이 일반화</p></li>
<li><p><a class="reference external" href="https://www.youtube.com/watch?v=B6vr1x6KDaY">도립진자</a>, <a class="reference external" href="https://www.youtube.com/watch?v=X2vvdJGxPkI">카메라 안정기</a>, <a class="reference external" href="https://www.youtube.com/watch?v=7BoDS9Gzsko">드론 항법 장치</a></p></li>
</ul>
</div></blockquote>
<ul class="simple">
<li><p><strong>기존 ARMA 모형에서 다루기 힘든 문제들을 해결하는데 도움</strong></p></li>
</ul>
<ol class="simple">
<li><p>시계열의 구조적 모형(structural model)</p></li>
<li><p>일부 누락된 데이터(missing data)가 있는 경우</p></li>
<li><p>시간에 따라 모형 계수가 변화(time-varing or switching)하는 경우</p></li>
<li><p>변수의 분포가 정규 분포가 아닌 경우</p></li>
</ol>
<div class="section" id="hmm">
<h4>실습: HMM 데이터생성 및 이해<a class="headerlink" href="#hmm" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># import numpy as np</span>
<span class="c1"># from hmmlearn import hmm</span>
<span class="c1"># import seaborn as sns</span>
<span class="c1"># import matplotlib.pyplot as plt</span>

<span class="c1"># # 데이터 생성</span>
<span class="c1"># np.random.seed(3)</span>
<span class="c1"># model = hmm.GaussianHMM(n_components=2, covariance_type=&quot;diag&quot;)</span>
<span class="c1"># model.startprob_ = np.array([0.9, 0.1])</span>
<span class="c1"># model.transmat_ = np.array([[0.95, 0.05], [0.15, 0.85]])</span>
<span class="c1"># model.means_ = np.array([[1.0], [-3.0]])</span>
<span class="c1"># model.covars_ = np.array([[15.0], [40.0]])</span>
<span class="c1"># X, Z = model.sample(500)</span>

<span class="c1"># # 데이터 시각화</span>
<span class="c1"># plt.figure(figsize=(10,6))</span>
<span class="c1"># sns.distplot(X)</span>
<span class="c1"># plt.show()</span>

<span class="c1"># plt.figure(figsize=(10,6))</span>
<span class="c1"># plt.subplot(311)</span>
<span class="c1"># plt.plot(X)</span>
<span class="c1"># plt.title(&quot;random variable&quot;)</span>
<span class="c1"># plt.subplot(312)</span>
<span class="c1"># plt.plot(Z)</span>
<span class="c1"># plt.title(&quot;discrete state&quot;)</span>
<span class="c1"># plt.subplot(313)</span>
<span class="c1"># plt.plot((1 + 0.01*X).cumprod())</span>
<span class="c1"># plt.title(&quot;X cumulated&quot;)</span>
<span class="c1"># plt.tight_layout()</span>
<span class="c1"># plt.show()</span>

<span class="c1"># # HMM 모델링</span>
<span class="c1"># fit = hmm.GaussianHMM(n_components=2, n_iter=len(X)).fit(X)</span>
<span class="c1"># Z_hat = fit.decode(X)[1]</span>
<span class="c1"># X_cum = (1 + 0.01*X).cumprod()</span>
<span class="c1"># X_cum_hat = X_cum.copy()</span>
<span class="c1"># X_cum_hat[Z_hat == 0] = np.nan</span>

<span class="c1"># # Generator 시각화</span>
<span class="c1"># plt.figure(figsize=(10,6))</span>
<span class="c1"># plt.subplot(211)</span>
<span class="c1"># plt.plot(X_cum, lw=5)</span>
<span class="c1"># plt.plot(X_cum_hat, &#39;r-&#39;, lw=5)</span>
<span class="c1"># plt.title(&quot;X cumulated&quot;)</span>
<span class="c1"># plt.subplot(212)</span>
<span class="c1"># plt.plot(Z, &#39;bo-&#39;)</span>
<span class="c1"># plt.plot(Z_hat, &#39;ro-&#39;)</span>
<span class="c1"># plt.title(&quot;discrete state&quot;)</span>
<span class="c1"># plt.tight_layout()</span>
<span class="c1"># plt.show()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="kalman-filter">
<h4>실습: Kalman Filter 데이터생성 및 이해<a class="headerlink" href="#kalman-filter" title="Permalink to this headline">¶</a></h4>
<p>\begin{align*}
\mu_t &amp;= \mu_{t-1} + w_t,;;;  &amp;w_t \sim N(\mu=0, \sigma^2=10) \
Y_{t} &amp;= \mu_{t}   + v_t,;;;  &amp;v_t \sim N(\mu=0, \sigma^2=100) \
\end{align*}</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">statsmodels.tsa.statespace.kalman_filter</span> <span class="kn">import</span> <span class="n">KalmanFilter</span>

<span class="c1"># 데이터 생성</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">123</span><span class="p">)</span>
<span class="n">model_generator</span> <span class="o">=</span> <span class="n">KalmanFilter</span><span class="p">(</span><span class="n">k_endog</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">k_states</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                               <span class="n">transition</span><span class="o">=</span><span class="p">[[</span><span class="mi">1</span><span class="p">]],</span> <span class="n">selection</span><span class="o">=</span><span class="p">[[</span><span class="mi">1</span><span class="p">]],</span> <span class="n">state_cov</span><span class="o">=</span><span class="p">[[</span><span class="mi">10</span><span class="p">]],</span>
                               <span class="n">design</span><span class="o">=</span><span class="p">[[</span><span class="mi">1</span><span class="p">]],</span> <span class="n">obs_cov</span><span class="o">=</span><span class="p">[[</span><span class="mi">100</span><span class="p">]])</span>
<span class="n">y_gener</span><span class="p">,</span> <span class="n">x_gener</span> <span class="o">=</span> <span class="n">model_generator</span><span class="o">.</span><span class="n">simulate</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>

<span class="c1"># 데이터 생성</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y_gener</span><span class="p">,</span> <span class="s1">&#39;r:&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Observation Values&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_gener</span><span class="p">,</span> <span class="s1">&#39;g-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;State Values&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Simulation of Local Level Model ($\sigma_w^2 = 10$, $\sigma_v^2 = 100$)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Kalman Filter 모델링</span>
<span class="n">fit</span> <span class="o">=</span> <span class="n">KalmanFilter</span><span class="p">(</span><span class="n">y_gener</span><span class="p">,</span> <span class="n">k_states</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                   <span class="n">transition</span><span class="o">=</span><span class="p">[[</span><span class="mi">1</span><span class="p">]],</span> <span class="n">selection</span><span class="o">=</span><span class="p">[[</span><span class="mi">1</span><span class="p">]],</span> <span class="n">state_cov</span><span class="o">=</span><span class="p">[[</span><span class="mi">10</span><span class="p">]],</span>
                   <span class="n">design</span><span class="o">=</span><span class="p">[[</span><span class="mi">1</span><span class="p">]],</span> <span class="n">obs_cov</span><span class="o">=</span><span class="p">[[</span><span class="mi">100</span><span class="p">]])</span>
<span class="n">fit</span><span class="o">.</span><span class="n">initialize_known</span><span class="p">([</span><span class="mi">0</span><span class="p">],</span> <span class="p">[[</span><span class="mi">1</span><span class="p">]])</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">fit</span><span class="o">.</span><span class="n">filter</span><span class="p">()</span>

<span class="c1"># 추정 시각화</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fit</span><span class="o">.</span><span class="n">obs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;r:&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Observation Values&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">filtered_state</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;b-.&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Estimations of State Values&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_gener</span><span class="p">,</span> <span class="s2">&quot;g-&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Real State Values&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;State Estimation of Local Level Model ($\sigma_w^2 = 10$, $\sigma_v^2 = 100$)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/4_Algorithms_TS_NonLinear_34_0.png" src="../_images/4_Algorithms_TS_NonLinear_34_0.png" />
<img alt="../_images/4_Algorithms_TS_NonLinear_34_1.png" src="../_images/4_Algorithms_TS_NonLinear_34_1.png" />
</div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="id9">
<h1>다변량 시계열 알고리즘<a class="headerlink" href="#id9" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><p><strong>필요성:</strong></p>
<ul>
<li><p>단변량 시계열(Simple/Multiple포함)은 종속변수(<span class="math notranslate nohighlight">\(Y_t\)</span>)가 독립변수들에만! 영향을 받는다는 큰 가정 존재</p></li>
<li><p>현실적으론 종속변수와 독립변수는 상호 영향을 주고받음</p>
<ul>
<li><p>예시: 개인 소득과 지출 중 어떤게 Y로 적합한가?라는 질문은 왜 하지 않는가?</p></li>
</ul>
</li>
</ul>
</li>
</ul>
<blockquote>
<div><p><strong>2차원(소득과 지출 모두를 종속변수) 과거1시점까지만을 고려하는 백터자기회귀 알고리즘</strong></p>
</div></blockquote>
<blockquote>
<div><p>\begin{align*}
\text{Equation of VAR(1)} &amp;&amp; Y_{[t]} &amp;= A Y_{[t-1]} + \epsilon_{[t]} \
\text{where} &amp;&amp; Y_{[t]} &amp;= \begin{bmatrix} Y_{1t} \ Y_{2t} \end{bmatrix},
A = \begin{bmatrix} \phi_{11} \phi_{12} \ \phi_{21} \phi_{22} \end{bmatrix},
Y_{[t-1]} = \begin{bmatrix} Y_{1t-1} \ Y_{2t-1} \end{bmatrix}, \
&amp;&amp; \epsilon_{[t]} &amp;= \begin{bmatrix} e_{1t} \ e_{2t} \end{bmatrix} \sim N(0, \textstyle \sum_{\epsilon_{[t]}}) \
\text{Each Equation of VAR(1)} &amp;&amp; Y_{1t} &amp;= \phi_{11} Y_{1t-1} + \phi_{12} Y_{2t-1} + e_{1t} \
&amp;&amp; Y_{2t} &amp;= \phi_{21} Y_{1t-1} + \phi_{22} Y_{2t-1} + e_{2t} \
\end{align*}</p>
</div></blockquote>
<div class="section" id="vector-autoregressive-model">
<h2>벡터자기회귀 모형(Vector Autoregressive Model)<a class="headerlink" href="#vector-autoregressive-model" title="Permalink to this headline">¶</a></h2>
<p><strong>1) VAR 알고리즘:</strong></p>
<blockquote>
<div><p><strong>단변량 시계열과 같이 평균 벡터와 공분산 벡터가 시차 <span class="math notranslate nohighlight">\(l\)</span>에만 의존하고 각각의 절대위치에 독립적이면 정상성(Stationary) 시계열</strong></p>
</div></blockquote>
<p>\begin{align*}
\text{Generalized Equation of VAR(1)} &amp;&amp; Y_{[t]} &amp;= A_1 Y_{[t-1]} + e_t \
\text{where} &amp;&amp; Y_{[t]} &amp;= \begin{bmatrix} Y_{1t} \ Y_{2t} \ \vdots \ Y_{kt} \end{bmatrix},
A_1 = \begin{bmatrix} \phi_{11}^1 \phi_{12}^1 \cdots \phi_{1k}^1 \ \phi_{21}^1 \phi_{22}^1 \cdots \phi_{2k}^1 \ \vdots \ \phi_{k1}^1 \phi_{k2}^1 \cdots \phi_{kk}^1 \end{bmatrix},
Y_{[t-1]} = \begin{bmatrix} Y_{1t-1} \ Y_{2t-1} \ \vdots \ Y_{kt-1} \end{bmatrix}, \
&amp;&amp; \epsilon_{[t]} &amp;= \begin{bmatrix} e_{1t} \ e_{2t} \ \vdots \ e_{kt} \end{bmatrix} \sim N(0, \textstyle \sum_{\epsilon_{[t]}}) \
\text{Each Equations} &amp;&amp; Y_{1t} &amp;= \phi_{11}^1 Y_{1t-1} + \phi_{12}^1 Y_{2t-1} + \cdots + \phi_{1k}^1 Y_{kt-1} + e_{1t} \
&amp;&amp; Y_{2t} &amp;= \phi_{21}^1 Y_{1t-1} + \phi_{22}^1 Y_{2t-1} + \cdots + \phi_{2k}^1 Y_{kt-1} + e_{2t} \
&amp;&amp; &amp; \vdots \
&amp;&amp; Y_{kt} &amp;= \phi_{k1}^1 Y_{1t-1} + \phi_{k2}^1 Y_{2t-1} + \cdots + \phi_{kk}^1 Y_{kt-1} + e_{kt} \
\end{align*}</p>
<p>\begin{align*}
\text{Generalized Equation of VAR(2)} &amp;&amp; Y_{[t]} &amp;= A_1 Y_{[t-1]} + A_2 Y_{[t-2]} + e_t \
\text{where} &amp;&amp; Y_{[t]} &amp;= \begin{bmatrix} Y_{1t} \ Y_{2t} \ \vdots \ Y_{kt} \end{bmatrix},
A_1 = \begin{bmatrix} \phi_{11}^1 \phi_{12}^1 \cdots \phi_{1k}^1 \ \phi_{21}^1 \phi_{22}^1 \cdots \phi_{2k}^1 \ \vdots \ \phi_{k1}^1 \phi_{k2}^1 \cdots \phi_{kk}^1 \end{bmatrix},
Y_{[t-1]} = \begin{bmatrix} Y_{1t-1} \ Y_{2t-1} \ \vdots \ Y_{kt-1} \end{bmatrix}, \
&amp;&amp; A_2 &amp;= \begin{bmatrix} \phi_{11}^2 \phi_{12}^2 \cdots \phi_{1k}^2 \ \phi_{21}^2 \phi_{22}^2 \cdots \phi_{2k}^2 \ \vdots \ \phi_{k1}^2 \phi_{k2}^2 \cdots \phi_{kk}^2 \end{bmatrix},
Y_{[t-2]} = \begin{bmatrix} Y_{1t-2} \ Y_{2t-2} \ \vdots \ Y_{kt-2} \end{bmatrix}, \
&amp;&amp; \epsilon_{[t]} &amp;= \begin{bmatrix} e_{1t} \ e_{2t} \ \vdots \ e_{kt} \end{bmatrix} \sim N(0, \textstyle \sum_{\epsilon_{[t]}}) \
\text{Each Equations} &amp;&amp; Y_{1t} &amp;= \phi_{11}^1 Y_{1t-1} + \phi_{12}^1 Y_{2t-1} + \cdots + \phi_{1k}^2 Y_{kt-2} + \phi_{11}^2 Y_{1t-2} + \phi_{12}^2 Y_{2t-2} + \cdots + \phi_{1k}^2 Y_{kt-2} + e_{1t} \
&amp;&amp; Y_{2t} &amp;= \phi_{21}^1 Y_{1t-1} + \phi_{22}^1 Y_{2t-1} + \cdots + \phi_{2k}^1 Y_{kt-1} + \phi_{21}^2 Y_{1t-2} + \phi_{22}^2 Y_{2t-2} + \cdots + \phi_{2k}^2 Y_{kt-2} + e_{2t} \
&amp;&amp; &amp; \vdots \
&amp;&amp; Y_{kt} &amp;= \phi_{k1}^1 Y_{1t-1} + \phi_{k2}^1 Y_{2t-1} + \cdots + \phi_{kk}^1 Y_{kt-1} + \phi_{k1}^2 Y_{1t-2} + \phi_{k2}^2 Y_{2t-2} + \cdots + \phi_{kk}^2 Y_{kt-2} + e_{kt} \
\end{align*}</p>
<p>\begin{align*}
\text{Generalized Equation of VAR(p)} &amp;&amp; Y_{[t]} &amp;= A_1 Y_{[t-1]} + A_2 Y_{[t-2]} + \cdots + A_p Y_{[t-p]} + \epsilon_{[t]} \
\text{Mean} &amp;&amp; \mu_{[t]} &amp;= \text{E}(Y_{[t]})
= \begin{bmatrix} \text{E}(Y_{1t}) \ \text{E}(Y_{2t}) \ \vdots \ \text{E}(Y_{kt}) \end{bmatrix}
= \begin{bmatrix} \mu_{1} \ \mu_{2}\ \vdots \ \mu_{k} \end{bmatrix} \
\text{Covariance} &amp;&amp; \Gamma(l) &amp;= \text{E}[(Y_{[t]} − \mu_{[t]})(Y_{[t]} − \mu_{[t]})^T ] \
&amp;&amp; &amp;= \begin{bmatrix}
\text{E}[(Y_{1t} − \mu_1)^2] &amp; \text{E}[(Y_{1t} − \mu_1)(Y_{2t} − \mu_2)] &amp; \cdots &amp; \text{E}[(Y_{1t} − \mu_1)(Y_{kt} − \mu_k)] \
\text{E}[(Y_{2t} − \mu_2)(Y_{1t} − \mu_1)] &amp; \text{E}[(Y_{2t} − \mu_2)^2] &amp; \cdots &amp; \text{E}[(Y_{2t} − \mu_2)(Y_{kt} − \mu_k)] \
\vdots &amp; \vdots &amp; \ddots &amp; \vdots \
\text{E}[(Y_{kt} − \mu_k)(Y_{1t} − \mu_1)]&amp; \text{E}[(Y_{kt} − \mu_k)(Y_{2t} − \mu_2)] &amp; \cdots  &amp; \text{E}[(Y_{kt} − \mu_k)^2]  \
\end{bmatrix} \
\text{Covariance Diagonal} &amp;&amp; D &amp;= \text{diag}(\sqrt{\Gamma_{11}}, \cdots, \sqrt{\Gamma_{kk}}) \
\text{Cross-correlation Matrix} &amp;&amp; \rho(l) &amp;= D^{−1}\Gamma(l)D^{−1} \
\end{align*}</p>
<p><strong>2) 임펄스 응답 함수(Impulse Response Function):</strong></p>
<blockquote>
<div><p><strong>VAR 모형은 여러개의 시계열 상호상관관계를 기반으로 각각의 변수가 다른 변수에 어떤 영향을 주는지 임펄스 반응 함수로 알 수 있음</strong></p>
<ul class="simple">
<li><p><strong>임펄스(Impulse):</strong> 어떤 시계열이 <span class="math notranslate nohighlight">\(t=0\)</span> 일 때 1이고, <span class="math notranslate nohighlight">\(t&lt;0\)</span> 또는 <span class="math notranslate nohighlight">\(t&gt;1\)</span> 일 때 0인 것</p></li>
<li><p><strong>임펄스 반응 함수(Impulse Response Function):</strong> 임펄스 형태의 시계열이 다른 시계열에 미치는 영향을 시간에 따라 표시</p></li>
</ul>
</div></blockquote>
<div class="section" id="var">
<h3>VAR 모듈 정리<a class="headerlink" href="#var" title="Permalink to this headline">¶</a></h3>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>클래스 이름</p></th>
<th class="head"><p>용도</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>VARProcess</p></td>
<td><p>미리 정해진 계수를 가진 <span class="math notranslate nohighlight">\(VAR\)</span> 모형</p></td>
</tr>
<tr class="row-odd"><td><p>VAR</p></td>
<td><p>주어진 자료의 계수를 추정하기 위한 <span class="math notranslate nohighlight">\(VAR\)</span> 모형</p></td>
</tr>
<tr class="row-even"><td><p>VARResults</p></td>
<td><p>주어진 자료로 추정된 <span class="math notranslate nohighlight">\(VAR\)</span> 모형</p></td>
</tr>
</tbody>
</table>
<p><strong>1) VARProcess</strong></p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>출력모듈</p></th>
<th class="head"><p>설명</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>acf([nlags])</p></td>
<td><p>이론적인 공분산 함수(autocovariance function) 계산</p></td>
</tr>
<tr class="row-odd"><td><p>acorr([nlags])</p></td>
<td><p>이론적인 자기상관계수 함수(autocorrelation function) 계산</p></td>
</tr>
<tr class="row-even"><td><p>forecast(y, steps)</p></td>
<td><p>최소자승 미래 예측값 계산</p></td>
</tr>
<tr class="row-odd"><td><p>forecast_cov(steps)</p></td>
<td><p>미래 예측 오차 공분산 행렬 계산</p></td>
</tr>
<tr class="row-even"><td><p>forecast_interval(y, steps[, alpha])</p></td>
<td><p>미래 구간 예측</p></td>
</tr>
<tr class="row-odd"><td><p>get_eq_index(name)</p></td>
<td><p>지정한 이름ㄹ 가진 정수 위치 반환</p></td>
</tr>
<tr class="row-even"><td><p>is_stable([verbose])</p></td>
<td><p>안정성 계산</p></td>
</tr>
<tr class="row-odd"><td><p>long_run_effects()</p></td>
<td><p>임펄스 함수의 장기 효과 계산</p></td>
</tr>
<tr class="row-even"><td><p>ma_rep([maxn])</p></td>
<td><p><span class="math notranslate nohighlight">\(MA(\infty\)</span>) 계수 행렬 계산</p></td>
</tr>
<tr class="row-odd"><td><p>mean()</p></td>
<td><p>기댓값</p></td>
</tr>
<tr class="row-even"><td><p>mse(steps)</p></td>
<td><p>이론적인 미래예측 오차 행렬 계산</p></td>
</tr>
<tr class="row-odd"><td><p>plot_acorr([nlags, linewidth])</p></td>
<td><p>이론적인 자기상관계수 함수 행렬 플롯</p></td>
</tr>
<tr class="row-even"><td><p>plotsim([steps])</p></td>
<td><p>시물레이션 플롯</p></td>
</tr>
</tbody>
</table>
<p><strong>2) VAR</strong></p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>출력모듈</p></th>
<th class="head"><p>설명</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>endog</p></td>
<td><p>원자료</p></td>
</tr>
<tr class="row-odd"><td><p>endog_names</p></td>
<td><p>원자료 변수명</p></td>
</tr>
</tbody>
</table>
<p><strong>3) VARResults</strong></p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>출력모듈</p></th>
<th class="head"><p>설명</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>model</p></td>
<td><p>추정 자료와 모형 차수 등을 가진 VAR 클래스 객체</p></td>
</tr>
<tr class="row-odd"><td><p>k_ar</p></td>
<td><p>AR 차수</p></td>
</tr>
<tr class="row-even"><td><p>coefs</p></td>
<td><p>추정된 AR 계수</p></td>
</tr>
<tr class="row-odd"><td><p>intercept</p></td>
<td><p>추정된 trend constant</p></td>
</tr>
<tr class="row-even"><td><p>params</p></td>
<td><p>추정된 전체 계수 (trend constant 포함)</p></td>
</tr>
<tr class="row-odd"><td><p>bse</p></td>
<td><p>추정된 전체 계수의 표준 오차</p></td>
</tr>
<tr class="row-even"><td><p>tvalues</p></td>
<td><p>추정된 계수의 t statistics</p></td>
</tr>
<tr class="row-odd"><td><p>pvalues</p></td>
<td><p>추정된 계수의 t statistics에 대한 p value</p></td>
</tr>
<tr class="row-even"><td><p>llf</p></td>
<td><p>Log Likelihood 값</p></td>
</tr>
<tr class="row-odd"><td><p>aic</p></td>
<td><p>AIC 값</p></td>
</tr>
<tr class="row-even"><td><p>bic</p></td>
<td><p>AIC 값</p></td>
</tr>
<tr class="row-odd"><td><p>hqic</p></td>
<td><p>HQIC 값</p></td>
</tr>
<tr class="row-even"><td><p>fittedvalues</p></td>
<td><p>추정 모형에 의한 예측값</p></td>
</tr>
<tr class="row-odd"><td><p>resid</p></td>
<td><p>추정 모형에 의한 잔차항(Residuals)</p></td>
</tr>
<tr class="row-even"><td><p>sigma_u</p></td>
<td><p>추정 모형에 의한 잔차항의 분산</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id10">
<h3>실습: VAR 데이터생성 및 이해<a class="headerlink" href="#id10" title="Permalink to this headline">¶</a></h3>
<p>\begin{align*}
\text{Example of VAR(1)} &amp;&amp; Y_{1t} &amp;= 5 + 0.2 Y_{1t-1} + 0.3 Y_{2t-1} + e_{1t} \
&amp;&amp; Y_{2t} &amp;= 3 - 0.6 Y_{1t-1} + 1.1 Y_{2t-1} + e_{2t} \
\end{align*}</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">statsmodels</span>
<span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="nn">sm</span>

<span class="c1"># 차수 입력</span>
<span class="n">intercept</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="n">matrix_A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[[</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.6</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">]]])</span>
<span class="n">residual_covariance</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">],[</span><span class="mf">0.8</span><span class="p">,</span> <span class="mi">2</span><span class="p">]])</span>

<span class="c1"># VAR 데이터 생성</span>
<span class="n">fit</span> <span class="o">=</span> <span class="n">statsmodels</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">vector_ar</span><span class="o">.</span><span class="n">var_model</span><span class="o">.</span><span class="n">VARProcess</span><span class="p">(</span><span class="n">matrix_A</span><span class="p">,</span> <span class="n">intercept</span><span class="p">,</span> <span class="n">residual_covariance</span><span class="p">)</span>
<span class="c1">## 시뮬레이션 시각화1</span>
<span class="n">simul_num</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">fit</span><span class="o">.</span><span class="n">plotsim</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="n">simul_num</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">123</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="c1">## 시뮬레이션 시각화2</span>
<span class="n">simul_num</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">simul_values</span> <span class="o">=</span> <span class="n">statsmodels</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">vector_ar</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">varsim</span><span class="p">(</span><span class="n">fit</span><span class="o">.</span><span class="n">coefs</span><span class="p">,</span> <span class="n">fit</span><span class="o">.</span><span class="n">intercept</span><span class="p">,</span> <span class="n">fit</span><span class="o">.</span><span class="n">sigma_u</span><span class="p">,</span> <span class="n">steps</span><span class="o">=</span><span class="n">simul_num</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">simul_values</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="c1">## ACF 시각화</span>
<span class="n">fit</span><span class="o">.</span><span class="n">plot_acorr</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># VAR 모형적합</span>
<span class="n">fit</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">VAR</span><span class="p">(</span><span class="n">simul_values</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">display</span><span class="p">(</span><span class="n">fit</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>

<span class="c1"># 예측 및 시각화</span>
<span class="n">forecast_num</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">pred_var</span> <span class="o">=</span> <span class="n">fit</span><span class="o">.</span><span class="n">forecast</span><span class="p">(</span><span class="n">fit</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">endog</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">:],</span> <span class="n">steps</span><span class="o">=</span><span class="n">forecast_num</span><span class="p">)</span>
<span class="n">pred_var_ci</span> <span class="o">=</span> <span class="n">fit</span><span class="o">.</span><span class="n">forecast_interval</span><span class="p">(</span><span class="n">fit</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">endog</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">:],</span> <span class="n">steps</span><span class="o">=</span><span class="n">forecast_num</span><span class="p">)</span>
<span class="n">fit</span><span class="o">.</span><span class="n">plot_forecast</span><span class="p">(</span><span class="n">forecast_num</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># 임펄스반응함수 추정</span>
<span class="n">fit</span><span class="o">.</span><span class="n">irf</span><span class="p">(</span><span class="n">forecast_num</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># 잔차진단</span>
<span class="n">fit</span><span class="o">.</span><span class="n">plot_acorr</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/4_Algorithms_TS_NonLinear_39_0.png" src="../_images/4_Algorithms_TS_NonLinear_39_0.png" />
<img alt="../_images/4_Algorithms_TS_NonLinear_39_1.png" src="../_images/4_Algorithms_TS_NonLinear_39_1.png" />
<img alt="../_images/4_Algorithms_TS_NonLinear_39_2.png" src="../_images/4_Algorithms_TS_NonLinear_39_2.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Summary of Regression Results   
==================================
Model:                         VAR
Method:                        OLS
Date:           Fri, 13, Mar, 2020
Time:                     23:32:41
--------------------------------------------------------------------
No. of Equations:         2.00000    BIC:                   0.325657
Nobs:                     99.0000    HQIC:                  0.232012
Log likelihood:          -283.284    FPE:                    1.18343
AIC:                     0.168377    Det(Omega_mle):         1.11484
--------------------------------------------------------------------
Results for equation y1
========================================================================
           coefficient       std. error           t-stat            prob
------------------------------------------------------------------------
const         5.094687         0.696008            7.320           0.000
L1.y1         0.185511         0.107543            1.725           0.085
L1.y2         0.319971         0.049597            6.451           0.000
========================================================================

Results for equation y2
========================================================================
           coefficient       std. error           t-stat            prob
------------------------------------------------------------------------
const         3.922002         0.901511            4.350           0.000
L1.y1        -0.704885         0.139297           -5.060           0.000
L1.y2         1.199559         0.064241           18.673           0.000
========================================================================

Correlation matrix of residuals
            y1        y2
y1    1.000000  0.604778
y2    0.604778  1.000000
</pre></div>
</div>
<img alt="../_images/4_Algorithms_TS_NonLinear_39_4.png" src="../_images/4_Algorithms_TS_NonLinear_39_4.png" />
<img alt="../_images/4_Algorithms_TS_NonLinear_39_5.png" src="../_images/4_Algorithms_TS_NonLinear_39_5.png" />
<img alt="../_images/4_Algorithms_TS_NonLinear_39_6.png" src="../_images/4_Algorithms_TS_NonLinear_39_6.png" />
</div>
</div>
</div>
<div class="section" id="id11">
<h3>실습: 거시경제 VAR 모형화 및 해석<a class="headerlink" href="#id11" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p><strong>데이터설명:</strong> <a class="reference external" href="http://www.statsmodels.org/0.6.1/datasets/generated/macrodata.html">링크</a></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">statsmodels</span>
<span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="nn">sm</span>

<span class="c1"># 데이터 로딩</span>
<span class="n">raw</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">macrodata</span><span class="o">.</span><span class="n">load_pandas</span><span class="p">()</span><span class="o">.</span><span class="n">data</span>
<span class="n">dates_info</span> <span class="o">=</span> <span class="n">raw</span><span class="p">[[</span><span class="s1">&#39;year&#39;</span><span class="p">,</span> <span class="s1">&#39;quarter&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
<span class="n">raw</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DatetimeIndex</span><span class="p">(</span><span class="n">sm</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">datetools</span><span class="o">.</span><span class="n">dates_from_str</span><span class="p">(</span><span class="n">dates_info</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;Q&#39;</span> <span class="o">+</span> <span class="n">dates_info</span><span class="p">[</span><span class="s1">&#39;quarter&#39;</span><span class="p">]))</span>
<span class="n">raw_use</span> <span class="o">=</span> <span class="n">raw</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">2</span><span class="p">:</span><span class="mi">5</span><span class="p">]</span>

<span class="c1"># 데이터 시각화</span>
<span class="n">raw_use</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">subplots</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">raw_use</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">subplots</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># VAR 모형적합</span>
<span class="n">raw_use_return</span> <span class="o">=</span> <span class="n">raw_use</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
<span class="n">fit</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">VAR</span><span class="p">(</span><span class="n">raw_use_return</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">maxlags</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">fit</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>

<span class="c1"># # 예측 및 시각화</span>
<span class="n">forecast_num</span> <span class="o">=</span> <span class="mi">20</span>
<span class="c1"># pred_var = fit.forecast(fit.model.endog[-1:], steps=forecast_num)</span>
<span class="c1"># pred_var_ci = fit.forecast_interval(fit.model.endog[-1:], steps=forecast_num)</span>
<span class="n">fit</span><span class="o">.</span><span class="n">plot_forecast</span><span class="p">(</span><span class="n">forecast_num</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># 임펄스반응함수 추정</span>
<span class="n">fit</span><span class="o">.</span><span class="n">irf</span><span class="p">(</span><span class="n">forecast_num</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># 잔차진단</span>
<span class="n">fit</span><span class="o">.</span><span class="n">plot_acorr</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/4_Algorithms_TS_NonLinear_41_0.png" src="../_images/4_Algorithms_TS_NonLinear_41_0.png" />
<img alt="../_images/4_Algorithms_TS_NonLinear_41_1.png" src="../_images/4_Algorithms_TS_NonLinear_41_1.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Summary of Regression Results   
==================================
Model:                         VAR
Method:                        OLS
Date:           Fri, 13, Mar, 2020
Time:                     23:32:48
--------------------------------------------------------------------
No. of Equations:         3.00000    BIC:                    20.5675
Nobs:                     200.000    HQIC:                   20.3614
Log likelihood:          -2852.49    FPE:                6.05346e+08
AIC:                      20.2212    Det(Omega_mle):     5.45987e+08
--------------------------------------------------------------------
Results for equation realgdp
==============================================================================
                 coefficient       std. error           t-stat            prob
------------------------------------------------------------------------------
const              10.308143         6.425207            1.604           0.109
L1.realgdp         -0.394370         0.148481           -2.656           0.008
L1.realcons         1.185980         0.186610            6.355           0.000
L1.realinv          0.421263         0.170349            2.473           0.013
L2.realgdp         -0.036990         0.154523           -0.239           0.811
L2.realcons         0.432912         0.211433            2.048           0.041
L2.realinv         -0.038513         0.172158           -0.224           0.823
==============================================================================

Results for equation realcons
==============================================================================
                 coefficient       std. error           t-stat            prob
------------------------------------------------------------------------------
const              21.101498         3.871854            5.450           0.000
L1.realgdp         -0.189663         0.089475           -2.120           0.034
L1.realcons         0.448795         0.112452            3.991           0.000
L1.realinv          0.204550         0.102653            1.993           0.046
L2.realgdp         -0.192664         0.093116           -2.069           0.039
L2.realcons         0.443486         0.127410            3.481           0.000
L2.realinv          0.208133         0.103743            2.006           0.045
==============================================================================

Results for equation realinv
==============================================================================
                 coefficient       std. error           t-stat            prob
------------------------------------------------------------------------------
const             -18.677662         4.969904           -3.758           0.000
L1.realgdp         -0.241467         0.114850           -2.102           0.036
L1.realcons         0.895484         0.144343            6.204           0.000
L1.realinv          0.415102         0.131765            3.150           0.002
L2.realgdp          0.016095         0.119523            0.135           0.893
L2.realcons         0.024955         0.163543            0.153           0.879
L2.realinv         -0.099367         0.133164           -0.746           0.456
==============================================================================

Correlation matrix of residuals
             realgdp  realcons   realinv
realgdp     1.000000  0.507486  0.674775
realcons    0.507486  1.000000 -0.078787
realinv     0.674775 -0.078787  1.000000
</pre></div>
</div>
<img alt="../_images/4_Algorithms_TS_NonLinear_41_3.png" src="../_images/4_Algorithms_TS_NonLinear_41_3.png" />
<img alt="../_images/4_Algorithms_TS_NonLinear_41_4.png" src="../_images/4_Algorithms_TS_NonLinear_41_4.png" />
<img alt="../_images/4_Algorithms_TS_NonLinear_41_5.png" src="../_images/4_Algorithms_TS_NonLinear_41_5.png" />
</div>
</div>
</div>
</div>
<div class="section" id="granger-causality-model">
<h2>그래인저 인과관계 모형(Granger Causality Model)<a class="headerlink" href="#granger-causality-model" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id12">
<h3>인과관계? 상관관계?<a class="headerlink" href="#id12" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p><strong>Spurious Regression</strong></p></li>
</ul>
<blockquote>
<div><p><strong>“<span class="math notranslate nohighlight">\(X\)</span>와 <span class="math notranslate nohighlight">\(Y\)</span>가 관련(인과관계)이 없거나 논리적인 스토리가 없음에도 단순하게 상관성이 높다라는 공격”</strong></p>
<ul class="simple">
<li><p>지나치게 데이터에 집착할 필요도 없고, 데이터분석은 정말 어려운 작업</p></li>
</ul>
<center><img src='Image/Correlation_Causation_explained.jpg' width='500'></center>
<center><img src='Image/Correlation_Causation_OMG.jpg' width='500'></center>
</div></blockquote>
<ul class="simple">
<li><p><strong><a class="reference external" href="https://en.wikipedia.org/wiki/Post_hoc_ergo_propter_hoc">Post Hoc Fallacy</a></strong></p></li>
</ul>
<blockquote>
<div><p><strong>“<span class="math notranslate nohighlight">\(X\)</span> 다음에 <span class="math notranslate nohighlight">\(Y\)</span>가 일어났으므로 <span class="math notranslate nohighlight">\(X\)</span>가 <span class="math notranslate nohighlight">\(Y\)</span>의 원인이라는, 마치 시간순서가 인과관계를 담보할 것이라는 결과오류”</strong></p>
<ul class="simple">
<li><p>징크스: 머리를 염색했더니 시험점수가 100점이 나오더라?</p></li>
<li><p>오버피팅(Overfitting): 인과관계가 있는 데이터에서 샘플(Train) 데이터에 치우쳐버린 모델</p></li>
<li><p>Post Hoc Fallacy: 아무런 인과관계가 없는(상관관계는 높더라도) 데이터로 만든 모델</p></li>
</ul>
</div></blockquote>
</div>
<div class="section" id="granger-causality">
<h3>Granger Causality 이해<a class="headerlink" href="#granger-causality" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><p><strong>“<a class="reference external" href="https://en.wikipedia.org/wiki/Granger_causality">어떤 현상의 예측에 있어 다른 정보를 이용하는 것이 얼마나 유의미한지 나타내는 척도</a>”</strong></p>
<ul class="simple">
<li><p><strong>추론불가한 문제:</strong> “닭이 먼저인가 달걀이 먼저인가?” (인과관계)</p></li>
<li><p><strong>추론가능한 문제:</strong> “닭과 달걀의 생성순서 별 서로의 영향력은 어떤가?” (Granger 인과관계)</p></li>
<li><p><strong>필요성:</strong>
- 회귀분석에서 독립변수와 종속변수는 경제이론에 의해 이미 결정된 것으로 간주하고 인과관계 확인
- 원인과 결과가 불분명한 경우 함수관계에 대한 명확한 결정은 현실적으로 어려움</p></li>
<li><p><strong>예시:</strong>
- 닭과 달걀의 생산량의 인과관계
- 단기금리와 중기금리와의 인과관계
- 강수량과 동물원방문객수의 인과관계
- 급여인상액과 소비금액의 인과관계
- 어떤 회사의 광고비지출액와 매출액의 인과관계
- 강수량과 인터넷사용량의 인과관계
- 어떤 광고캠페인의 수치형 설정조건과 클릭수와 인과관계</p></li>
</ul>
</div></blockquote>
<ul>
<li><p><strong>모형의 전재:</strong> 과거의 사건은 현재의 사건을 유발할 수 있지만 미래의 사건은 현재의 사건을 유발할 수 없다</p>
<ul class="simple">
<li><p><strong>정상성:</strong> 정상성 데이터를 가정하므로 독립변수(<span class="math notranslate nohighlight">\(X\)</span>)와 종속변수(<span class="math notranslate nohighlight">\(Y\)</span>)는 모두 정상성 상태여야 함 (비정상 데이터기반 결과는 오해석 여지가 많음)</p></li>
<li><p><strong>입력시차:</strong> 입력변수로 시차(Lagged) 적용된 변수를 반영해야 하며, 예상되는 시차가 <span class="math notranslate nohighlight">\(N\)</span>이라면, <span class="math notranslate nohighlight">\(1\)</span>부터 <span class="math notranslate nohighlight">\(N\)</span>까지의 시차 모두를 입력변수로 사용해야 함</p></li>
<li><p><strong>최종시차:</strong> 예상시차 <span class="math notranslate nohighlight">\(N\)</span>에 매우 민감하므로 적합한 길이를 선택해야 함</p>
<ul>
<li><p>통상 연 환산빈도의 2~3배까지: 연별 자료시 2, 분기별 자료시 8, 월별 자료시 24)</p></li>
<li><p><span class="math notranslate nohighlight">\(F\)</span>검정통계량의 유의한 변화에 의해 결정</p></li>
</ul>
</li>
<li><p><strong>검정방향:</strong> 독립변수와 종속변수의 양방향 관련성 비교가 필요하기에 총2회의 검정을 수행해야 함</p>
<ul>
<li><p><span class="math notranslate nohighlight">\(X \implies Y\)</span> 1회: <span class="math notranslate nohighlight">\(X\)</span>가 <span class="math notranslate nohighlight">\(Y\)</span>에 인과영향인지 테스트 (<span class="math notranslate nohighlight">\(\beta_j = 0\)</span> 여부 확인, <span class="math notranslate nohighlight">\(\epsilon_{XY}\)</span> 분산 감소정도 확인)
\begin{align*}
\text{Just use Y} &amp;&amp; Y_{t} &amp;= \mu_t + \displaystyle \sum_{i=1}^{\infty} \alpha_i Y_{t-i} + \epsilon_{Y} \
\text{Use X and Y} &amp;&amp; Y_{t} &amp;= \mu_t + \displaystyle \sum_{i=1}^{\infty} \alpha_i Y_{t-i} + \displaystyle \sum_{j=1}^{\infty} \beta_j X_{t-j} + \epsilon_{XY} \
\end{align*}</p></li>
<li><p><span class="math notranslate nohighlight">\(Y \implies X\)</span> 1회: <span class="math notranslate nohighlight">\(Y\)</span>가 <span class="math notranslate nohighlight">\(X\)</span>에 인과영향인지 테스트 (<span class="math notranslate nohighlight">\(\beta_j = 0\)</span> 여부 확인, <span class="math notranslate nohighlight">\(\epsilon_{YX}\)</span> 분산 감소정도 확인)
\begin{align*}
\text{Just use X} &amp;&amp; X_{t} &amp;= \mu_t + \displaystyle \sum_{i=1}^{\infty} \alpha_i X_{t-i} + \epsilon_{X} \
\text{Use X and Y} &amp;&amp; X_{t} &amp;= \mu_t + \displaystyle \sum_{i=1}^{\infty} \alpha_i X_{t-i} + \displaystyle \sum_{j=1}^{\infty} \beta_j Y_{t-j} + \epsilon_{YX} \
\end{align*}</p></li>
</ul>
</li>
<li><p><strong>자동화가능성:</strong> 여러가지 데이터에 일반화해서 자동화하기 어려움</p></li>
<li><p><strong>주의사항:</strong></p>
<ul>
<li><p>무조건적 인과관계를 단정할 수 없음</p></li>
<li><p>시간 선후가 유의미한 맥락을 갖는 시계열에 적용할 수 있고, 시간선후 기간기준에 따라 Granger 인과관계가 있게 될 수 있음</p></li>
<li><p>상관관계를 두고 인과관계가 없다는 증명으로 간단히 볼 수는 있지만, 보이지 않는 요소들도 고려되어야 확실함</p></li>
</ul>
</li>
</ul>
</li>
<li><p><strong>Granger 인과관계 테스트</strong></p>
<ul>
<li><p><strong>가설확인</strong></p>
<ul class="simple">
<li><p><strong>대중주장(귀무가설, Null Hypothesis, <span class="math notranslate nohighlight">\(H_0\)</span>):</strong> 한 변수가 다른 변수를 예측하는데 도움이 되지 않는다</p></li>
<li><p><strong>나의주장(대립가설, Alternative Hypothesis, <span class="math notranslate nohighlight">\(H_1\)</span>):</strong> 한 변수가 다른 변수를 예측하는데 도움이 된다</p></li>
</ul>
</li>
<li><p><strong>의사결정(1회 검정)</strong></p>
<ul>
<li><p><strong>p-value &gt;= 내기준(ex. 0.05):</strong> 내가 수집한(분석한) 데이터는 대중주장과 유사하니 대중주장 참 &amp; 나의주장 거짓</p>
<blockquote>
<div><p><strong>수집한(분석한) 데이터는 한 변수가 다른 변수를 예측하는데 도움되지 않는다</strong></p>
</div></blockquote>
</li>
<li><p><strong>p-value &lt; 내기준(ex. 0.05):</strong> 내가 수집한(분석한) 데이터는 대중주장을 벗어나니 대중주장 거짓 &amp; 나의주장 참</p>
<blockquote>
<div><p><strong>수집한(분석한) 데이터는 한 변수가 다른 변수를 예측하는데 도움된다</strong></p>
</div></blockquote>
</li>
</ul>
</li>
<li><p><strong>의사결정(2회 검정 비교)</strong></p>
<ul>
<li><p><strong>“<span class="math notranslate nohighlight">\(Y\)</span> lags로만 <span class="math notranslate nohighlight">\(Y\)</span>의 데이터를 선형회귀한 것의 예측력(p-value)” &gt; “<span class="math notranslate nohighlight">\(X\)</span> lags + <span class="math notranslate nohighlight">\(Y\)</span> lags로 <span class="math notranslate nohighlight">\(Y\)</span>의 데이터를 선형회귀한 것의 예측력(p-value)”</strong></p>
<blockquote>
<div><p><strong>수집한(분석한) 데이터는 <span class="math notranslate nohighlight">\(X\)</span>변수가 <span class="math notranslate nohighlight">\(Y\)</span>변수를 예측하는데 도움되지 않는다</strong></p>
</div></blockquote>
</li>
<li><p><strong>“<span class="math notranslate nohighlight">\(X\)</span> lags + <span class="math notranslate nohighlight">\(Y\)</span> lags로 <span class="math notranslate nohighlight">\(Y\)</span>의 데이터를 선형회귀한 것의 예측력(p-value)” &gt; “<span class="math notranslate nohighlight">\(Y\)</span> lags로만 <span class="math notranslate nohighlight">\(Y\)</span>의 데이터를 선형회귀한 것의 예측력(p-value)”</strong></p>
<blockquote>
<div><p><strong>수집한(분석한) 데이터는 <span class="math notranslate nohighlight">\(X\)</span>변수가 <span class="math notranslate nohighlight">\(Y\)</span>변수를 예측하는데 도움된다</strong></p>
</div></blockquote>
</li>
</ul>
</li>
<li><p><strong>결과조합</strong></p>
<ul class="simple">
<li><p>“<span class="math notranslate nohighlight">\(X\)</span>가 <span class="math notranslate nohighlight">\(Y\)</span>에 인과영향을 준다” + “<span class="math notranslate nohighlight">\(Y\)</span>는 <span class="math notranslate nohighlight">\(X\)</span>에 인과영향을 주지 않는다”<br />
: <strong><span class="math notranslate nohighlight">\(X\)</span>가 <span class="math notranslate nohighlight">\(Y\)</span>에 선행한다고 볼 수 있기에, <span class="math notranslate nohighlight">\(X\)</span>가 <span class="math notranslate nohighlight">\(Y\)</span>의 인과요인이 될 가능성이 높음</strong></p></li>
<li><p>“<span class="math notranslate nohighlight">\(Y\)</span>가 <span class="math notranslate nohighlight">\(X\)</span>에 인과영향을 준다” + “<span class="math notranslate nohighlight">\(X\)</span>는 <span class="math notranslate nohighlight">\(Y\)</span>에 인과영향을 주지 않는다”<br />
: <strong><span class="math notranslate nohighlight">\(Y\)</span>가 <span class="math notranslate nohighlight">\(X\)</span>에 선행한다고 볼 수 있기에, <span class="math notranslate nohighlight">\(Y\)</span>가 <span class="math notranslate nohighlight">\(X\)</span>의 인과요인이 될 가능성이 높음</strong></p></li>
<li><p>“<span class="math notranslate nohighlight">\(X\)</span>가 <span class="math notranslate nohighlight">\(Y\)</span>에 인과영향을 준다” + “<span class="math notranslate nohighlight">\(Y\)</span>도 <span class="math notranslate nohighlight">\(X\)</span>에 인과영향을 준다”<br />
: <strong>쌍방으로 Granger Causality가 성립하는 경우로 이 경우 제3의 외부변수(Exogenous Variable)가 영향을 공통으로 주었을 가능성이 높음</strong><br />
: <strong>제3의 외부변수(Exogenous Variable)를 알아내던가 포기하던가 해야하며, <span class="math notranslate nohighlight">\(VAR\)</span>모형을 사용해야 할 수 있음(Granger Causality도 <span class="math notranslate nohighlight">\(VAR\)</span>모형 중 하나)</strong></p></li>
<li><p>“<span class="math notranslate nohighlight">\(X\)</span>가 <span class="math notranslate nohighlight">\(Y\)</span>에 인과영향을 주지 않는다” + “<span class="math notranslate nohighlight">\(Y\)</span>도 <span class="math notranslate nohighlight">\(X\)</span>에 인과영향을 주지 않는다”<br />
: <strong>두 변수가 서로 인과영향을 주지 않는다고 볼 수도 있지만 단언은 어려움</strong><br />
: <strong><span class="math notranslate nohighlight">\(ARIMA\)</span>모형으로 추가 확인이 가능할 수 있음</strong><br />
: <strong>입력되는 최종 시차에 따라 달라질 수 있으므로 시차에 따른 해석을 달리 할 수도 있음(사람의 경험과 판단이 개입되어야 함)</strong></p></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="granger">
<h3>실습: 닭과 달걀의 생산량을 통한 Granger 인과관계 이해<a class="headerlink" href="#granger" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="nn">sm</span>

<span class="c1"># 데이터 로딩</span>
<span class="n">location</span> <span class="o">=</span> <span class="s1">&#39;./Data/ChickenEggProduction/Chicken_Egg_Production.txt&#39;</span>
<span class="n">raw_all</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">location</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">raw_all</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>

<span class="c1"># 데이터 시각화</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">raw_all</span><span class="p">[</span><span class="s1">&#39;Chicken&#39;</span><span class="p">],</span> <span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Chicken&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">raw_all</span><span class="p">[</span><span class="s1">&#39;Egg&#39;</span><span class="p">],</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Egg&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># 정상성 변환 시각화</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">raw_all</span><span class="p">[</span><span class="s1">&#39;Chicken&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Diff(Chicken)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">raw_all</span><span class="p">[</span><span class="s1">&#39;Egg&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Diff(Egg)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Granger Causality 테스트</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">[Egg -&gt; Chicken]&#39;</span><span class="p">)</span>
<span class="n">granger_result1</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">stattools</span><span class="o">.</span><span class="n">grangercausalitytests</span><span class="p">(</span><span class="n">raw_all</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">maxlag</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">[Chicken -&gt; Egg]&#39;</span><span class="p">)</span>
<span class="n">granger_result2</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">stattools</span><span class="o">.</span><span class="n">grangercausalitytests</span><span class="p">(</span><span class="n">raw_all</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">maxlag</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># 의사결정</span>
<span class="c1"># 닭이 달걀을 낳으면 그 수는 약 3년후까지 닭의 수에 영향을 준다</span>
<span class="c1"># 닭의 수가 많아진다고해서 달걀을 많이 낳지는 않는다</span>
<span class="c1"># 달걀 -&gt; 닭 (Granger Causality)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/4_Algorithms_TS_NonLinear_46_0.png" src="../_images/4_Algorithms_TS_NonLinear_46_0.png" />
<img alt="../_images/4_Algorithms_TS_NonLinear_46_1.png" src="../_images/4_Algorithms_TS_NonLinear_46_1.png" />
<img alt="../_images/4_Algorithms_TS_NonLinear_46_2.png" src="../_images/4_Algorithms_TS_NonLinear_46_2.png" />
<img alt="../_images/4_Algorithms_TS_NonLinear_46_3.png" src="../_images/4_Algorithms_TS_NonLinear_46_3.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[Egg -&gt; Chicken]

Granger Causality
number of lags (no zero) 1
ssr based F test:         F=10.3694 , p=0.0023  , df_denom=49, df_num=1
ssr based chi2 test:   chi2=11.0043 , p=0.0009  , df=1
likelihood ratio test: chi2=9.9819  , p=0.0016  , df=1
parameter F test:         F=10.3694 , p=0.0023  , df_denom=49, df_num=1

Granger Causality
number of lags (no zero) 2
ssr based F test:         F=3.9196  , p=0.0268  , df_denom=46, df_num=2
ssr based chi2 test:   chi2=8.6913  , p=0.0130  , df=2
likelihood ratio test: chi2=8.0254  , p=0.0181  , df=2
parameter F test:         F=3.9196  , p=0.0268  , df_denom=46, df_num=2

Granger Causality
number of lags (no zero) 3
ssr based F test:         F=2.9318  , p=0.0441  , df_denom=43, df_num=3
ssr based chi2 test:   chi2=10.2270 , p=0.0167  , df=3
likelihood ratio test: chi2=9.3049  , p=0.0255  , df=3
parameter F test:         F=2.9318  , p=0.0441  , df_denom=43, df_num=3

[Chicken -&gt; Egg]

Granger Causality
number of lags (no zero) 1
ssr based F test:         F=0.5434  , p=0.4646  , df_denom=49, df_num=1
ssr based chi2 test:   chi2=0.5766  , p=0.4476  , df=1
likelihood ratio test: chi2=0.5734  , p=0.4489  , df=1
parameter F test:         F=0.5434  , p=0.4646  , df_denom=49, df_num=1

Granger Causality
number of lags (no zero) 2
ssr based F test:         F=0.3865  , p=0.6816  , df_denom=46, df_num=2
ssr based chi2 test:   chi2=0.8571  , p=0.6515  , df=2
likelihood ratio test: chi2=0.8500  , p=0.6538  , df=2
parameter F test:         F=0.3865  , p=0.6816  , df_denom=46, df_num=2

Granger Causality
number of lags (no zero) 3
ssr based F test:         F=0.2245  , p=0.8788  , df_denom=43, df_num=3
ssr based chi2 test:   chi2=0.7833  , p=0.8535  , df=3
likelihood ratio test: chi2=0.7772  , p=0.8549  , df=3
parameter F test:         F=0.2245  , p=0.8788  , df_denom=43, df_num=3
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="id13">
<h3>실습: 삼성전자와 삼성전자 우선주 Granger 인과관계 이해<a class="headerlink" href="#id13" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>pip install pandas-datareader
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: pandas-datareader in c:\programdata\anaconda3\lib\site-packages (0.8.1)
Requirement already satisfied: lxml in c:\programdata\anaconda3\lib\site-packages (from pandas-datareader) (4.4.1)
Requirement already satisfied: pandas&gt;=0.21 in c:\programdata\anaconda3\lib\site-packages (from pandas-datareader) (0.25.1)
Requirement already satisfied: requests&gt;=2.3.0 in c:\programdata\anaconda3\lib\site-packages (from pandas-datareader) (2.22.0)
Requirement already satisfied: pytz&gt;=2017.2 in c:\programdata\anaconda3\lib\site-packages (from pandas&gt;=0.21-&gt;pandas-datareader) (2019.3)
Requirement already satisfied: python-dateutil&gt;=2.6.1 in c:\programdata\anaconda3\lib\site-packages (from pandas&gt;=0.21-&gt;pandas-datareader) (2.8.0)
Requirement already satisfied: numpy&gt;=1.13.3 in c:\programdata\anaconda3\lib\site-packages (from pandas&gt;=0.21-&gt;pandas-datareader) (1.16.5)
Requirement already satisfied: chardet&lt;3.1.0,&gt;=3.0.2 in c:\programdata\anaconda3\lib\site-packages (from requests&gt;=2.3.0-&gt;pandas-datareader) (3.0.4)
Requirement already satisfied: certifi&gt;=2017.4.17 in c:\programdata\anaconda3\lib\site-packages (from requests&gt;=2.3.0-&gt;pandas-datareader) (2019.9.11)
Requirement already satisfied: urllib3!=1.25.0,!=1.25.1,&lt;1.26,&gt;=1.21.1 in c:\programdata\anaconda3\lib\site-packages (from requests&gt;=2.3.0-&gt;pandas-datareader) (1.24.2)
Requirement already satisfied: idna&lt;2.9,&gt;=2.5 in c:\programdata\anaconda3\lib\site-packages (from requests&gt;=2.3.0-&gt;pandas-datareader) (2.8)
Requirement already satisfied: six&gt;=1.5 in c:\programdata\anaconda3\lib\site-packages (from python-dateutil&gt;=2.6.1-&gt;pandas&gt;=0.21-&gt;pandas-datareader) (1.12.0)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>WARNING: pip is being invoked by an old script wrapper. This will fail in a future version of pip.
Please see https://github.com/pypa/pip/issues/5599 for advice on fixing the underlying issue.
To avoid this problem you can invoke Python with &#39;-m pip&#39; instead of running pip directly.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 데이터 로딩</span>
<span class="kn">import</span> <span class="nn">pandas_datareader.data</span> <span class="k">as</span> <span class="nn">web</span>
<span class="kn">import</span> <span class="nn">datetime</span>

<span class="n">start</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2014</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">end</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2018</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">31</span><span class="p">)</span>
<span class="n">raw1</span> <span class="o">=</span> <span class="n">web</span><span class="o">.</span><span class="n">DataReader</span><span class="p">(</span><span class="s2">&quot;005930.KS&quot;</span><span class="p">,</span> <span class="s1">&#39;yahoo&#39;</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">)</span>
<span class="n">raw2</span> <span class="o">=</span> <span class="n">web</span><span class="o">.</span><span class="n">DataReader</span><span class="p">(</span><span class="s2">&quot;005935.KS&quot;</span><span class="p">,</span> <span class="s1">&#39;yahoo&#39;</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">)</span>
<span class="c1"># raw2 = web.DataReader(&quot;009150.KS&quot;, &#39;yahoo&#39;, start, end)</span>

<span class="c1"># 데이터 시각화</span>
<span class="n">raw</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">raw1</span><span class="o">.</span><span class="n">Close</span><span class="p">,</span> <span class="n">raw2</span><span class="o">.</span><span class="n">Close</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
<span class="n">raw</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;SE&quot;</span><span class="p">,</span> <span class="s2">&quot;SE_PS&quot;</span><span class="p">]</span>
<span class="n">raw</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># 비정상성 차수 추론</span>
<span class="n">target</span> <span class="o">=</span> <span class="n">raw</span><span class="o">.</span><span class="n">SE</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">integ_result</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">sm</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">stattools</span><span class="o">.</span><span class="n">adfuller</span><span class="p">(</span><span class="n">target</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">],</span> 
                         <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Test Statistics&#39;</span><span class="p">,</span> <span class="s1">&#39;p-value&#39;</span><span class="p">,</span> <span class="s1">&#39;Used Lag&#39;</span><span class="p">,</span> <span class="s1">&#39;Used Observations&#39;</span><span class="p">])</span>
<span class="n">Y1_integ_order</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">if</span> <span class="n">integ_result</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.1</span><span class="p">:</span>
    <span class="n">Y1_integ_order</span> <span class="o">=</span> <span class="n">Y1_integ_order</span> <span class="o">+</span> <span class="mi">1</span>
<span class="n">target</span> <span class="o">=</span> <span class="n">raw</span><span class="o">.</span><span class="n">SE_PS</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">integ_result</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">sm</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">stattools</span><span class="o">.</span><span class="n">adfuller</span><span class="p">(</span><span class="n">target</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">],</span> 
                         <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Test Statistics&#39;</span><span class="p">,</span> <span class="s1">&#39;p-value&#39;</span><span class="p">,</span> <span class="s1">&#39;Used Lag&#39;</span><span class="p">,</span> <span class="s1">&#39;Used Observations&#39;</span><span class="p">])</span>
<span class="n">Y2_integ_order</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">if</span> <span class="n">integ_result</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.1</span><span class="p">:</span>
    <span class="n">Y2_integ_order</span> <span class="o">=</span> <span class="n">Y2_integ_order</span> <span class="o">+</span> <span class="mi">1</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Y1_order: &#39;</span><span class="p">,</span> <span class="n">Y1_integ_order</span><span class="p">,</span> <span class="s1">&#39;Y2_order: &#39;</span><span class="p">,</span> <span class="n">Y2_integ_order</span><span class="p">)</span>

<span class="c1"># Granger Causality 테스트</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">[삼성전자우 -&gt; 삼성전자]&#39;</span><span class="p">)</span>
<span class="n">granger_result1</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">stattools</span><span class="o">.</span><span class="n">grangercausalitytests</span><span class="p">(</span><span class="n">raw</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">maxlag</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">[삼성전자 -&gt; 삼성전자우]&#39;</span><span class="p">)</span>
<span class="n">granger_result2</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">stattools</span><span class="o">.</span><span class="n">grangercausalitytests</span><span class="p">(</span><span class="n">raw</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">maxlag</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># 의사결정</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/4_Algorithms_TS_NonLinear_49_0.png" src="../_images/4_Algorithms_TS_NonLinear_49_0.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Y1_order:  1 Y2_order:  1

[삼성전자우 -&gt; 삼성전자]

Granger Causality
number of lags (no zero) 1
ssr based F test:         F=3.8613  , p=0.0496  , df_denom=1216, df_num=1
ssr based chi2 test:   chi2=3.8708  , p=0.0491  , df=1
likelihood ratio test: chi2=3.8647  , p=0.0493  , df=1
parameter F test:         F=3.8613  , p=0.0496  , df_denom=1216, df_num=1

Granger Causality
number of lags (no zero) 2
ssr based F test:         F=3.5263  , p=0.0297  , df_denom=1213, df_num=2
ssr based chi2 test:   chi2=7.0818  , p=0.0290  , df=2
likelihood ratio test: chi2=7.0613  , p=0.0293  , df=2
parameter F test:         F=3.5263  , p=0.0297  , df_denom=1213, df_num=2

Granger Causality
number of lags (no zero) 3
ssr based F test:         F=2.6935  , p=0.0448  , df_denom=1210, df_num=3
ssr based chi2 test:   chi2=8.1273  , p=0.0435  , df=3
likelihood ratio test: chi2=8.1002  , p=0.0440  , df=3
parameter F test:         F=2.6935  , p=0.0448  , df_denom=1210, df_num=3

Granger Causality
number of lags (no zero) 4
ssr based F test:         F=2.4757  , p=0.0427  , df_denom=1207, df_num=4
ssr based chi2 test:   chi2=9.9766  , p=0.0408  , df=4
likelihood ratio test: chi2=9.9359  , p=0.0415  , df=4
parameter F test:         F=2.4757  , p=0.0427  , df_denom=1207, df_num=4

[삼성전자 -&gt; 삼성전자우]

Granger Causality
number of lags (no zero) 1
ssr based F test:         F=3.7267  , p=0.0538  , df_denom=1216, df_num=1
ssr based chi2 test:   chi2=3.7359  , p=0.0533  , df=1
likelihood ratio test: chi2=3.7302  , p=0.0534  , df=1
parameter F test:         F=3.7267  , p=0.0538  , df_denom=1216, df_num=1

Granger Causality
number of lags (no zero) 2
ssr based F test:         F=2.2516  , p=0.1057  , df_denom=1213, df_num=2
ssr based chi2 test:   chi2=4.5217  , p=0.1043  , df=2
likelihood ratio test: chi2=4.5133  , p=0.1047  , df=2
parameter F test:         F=2.2516  , p=0.1057  , df_denom=1213, df_num=2

Granger Causality
number of lags (no zero) 3
ssr based F test:         F=1.2032  , p=0.3073  , df_denom=1210, df_num=3
ssr based chi2 test:   chi2=3.6305  , p=0.3042  , df=3
likelihood ratio test: chi2=3.6251  , p=0.3049  , df=3
parameter F test:         F=1.2032  , p=0.3073  , df_denom=1210, df_num=3

Granger Causality
number of lags (no zero) 4
ssr based F test:         F=1.6051  , p=0.1706  , df_denom=1207, df_num=4
ssr based chi2 test:   chi2=6.4681  , p=0.1668  , df=4
likelihood ratio test: chi2=6.4510  , p=0.1679  , df=4
parameter F test:         F=1.6051  , p=0.1706  , df_denom=1207, df_num=4
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="cointegration-model">
<h2>공적분 모형(Cointegration Model)<a class="headerlink" href="#cointegration-model" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p><strong>공적분 상태(Cointegration):</strong> 두 비정상성 시계열을 선형조합(Linear Combination)하여 생성한 시계열의 적분(Integration) 차수가 낮아지거나 정상상태가 되는 경우</p></li>
<li><p><strong>공적분 벡터(Cointegration Vector):</strong> 이러한 선형 조합을 만드는 값</p></li>
<li><p><strong>공적분 시계열(Cointegration Time Series):</strong></p>
<ul>
<li><p>서로 상관관계를 가지지 않음에도 불구하고 장기적으로 같은 방향으로 움직이는 특성</p></li>
<li><p>술취한 사람이 개를 끈에 묶어 다니는 경우, 사람과 개는 각자 아무런 상관관계가 없이 움직이지만 서로 너무 멀어지지는 않는 것과 유사</p></li>
<li><p>페어 트레이딩 (Pair Trading), 통계적 차익거래 (Statistical Arbitrage) 등의 매매전략에 응용 가능</p></li>
</ul>
</li>
</ul>
<p>\begin{align*}
\text{Each Integration Order} &amp;&amp; Y_1 &amp;\sim I(d_1) \
&amp;&amp; Y_2 &amp;\sim I(d_2) \
\text{Cointegration Vector} &amp;&amp; \alpha &amp;= [\alpha_1, \alpha_2] \
\text{where} &amp;&amp; \alpha_1 x_1 &amp;+ \alpha_2 x_2 \sim I(b), ;; b &lt; d_1, ;; b &lt; d_2 \
\end{align*}</p>
<ul class="simple">
<li><p><strong>공적분 판별:</strong></p></li>
</ul>
<blockquote>
<div><p><strong>Engle-Granger’s Representation Theorem (Vector Error Correction Model)</strong>
\begin{align*}
\text{두 시계열 <span class="math notranslate nohighlight">\(Y_{1t} \sim I(1)\)</span>, <span class="math notranslate nohighlight">\(Y_{2t} \sim I(1)\)</span>이 공적분}
&amp; \iff \Delta Y_{2t} = \gamma_1 z_{t-1}  + \sum_{i=1}^K \psi_{1,i} \Delta Y_{1t-i} + \sum_{i=1}^L \psi_{2,i} \Delta Y_{2t-i} + e_{t} \
&amp; \text{(<span class="math notranslate nohighlight">\(z_t\)</span>는 <span class="math notranslate nohighlight">\(Y_{2t}\)</span>를 종속변수로 <span class="math notranslate nohighlight">\(Y_{1t}\)</span>를 독립변수로 회귀분석하여 만들어진 잔차)} \
\end{align*}</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\Delta Y_{1t}\)</span>와 <span class="math notranslate nohighlight">\(\Delta Y_{2t}\)</span>는 항상 정상성 시계열</p></li>
<li><p>위 식이 성립하려면 <span class="math notranslate nohighlight">\(z_t\)</span>와 <span class="math notranslate nohighlight">\(e_t\)</span>가 정상성 시계열이어야 함
1) <span class="math notranslate nohighlight">\(Y_{2t}\)</span>를 종속변수로 <span class="math notranslate nohighlight">\(Y_{1t}\)</span>를 독립변수로 회귀분석하여 만들어진 잔차 <span class="math notranslate nohighlight">\(z_t\)</span>가 정상성 시계열인지를 확인
2) 변환된 변수들의 <span class="math notranslate nohighlight">\(VECM\)</span> 회귀 분석의 잔차 <span class="math notranslate nohighlight">\(e_t\)</span>가 정상성 시계열인지를 확인</p></li>
</ul>
</div></blockquote>
<div class="section" id="cointegration">
<h3>실습: Cointegration 데이터 생성 및 이해<a class="headerlink" href="#cointegration" title="Permalink to this headline">¶</a></h3>
<p>\begin{align*}
\text{Example of Cointegration} \
\text{Y1: Random Walk with I(1)} &amp;&amp; Y_{1t} &amp;= Y_{1t-1} + e_{1t} \
\text{Y2: Random Walk with I(1)} &amp;&amp; Y_{2t} &amp;= 0.6 Y_{1t} + e_{2t} \
\text{Y: Stationary Time Series} &amp;&amp; Y &amp;= 0.6 Y_{1t} - Y_{2t} \
\end{align*}</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 데이터 생성</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">Y1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">500</span><span class="p">)</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()</span>
<span class="n">Y2</span> <span class="o">=</span> <span class="mf">0.6</span> <span class="o">*</span> <span class="n">Y1</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">500</span><span class="p">)</span>
<span class="n">Y</span> <span class="o">=</span> <span class="mf">0.6</span> <span class="o">*</span> <span class="n">Y1</span> <span class="o">-</span> <span class="n">Y2</span>

<span class="c1"># 시각화</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Y1</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Y1&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Y2</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Y2&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Y</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Y = 0.6*Y1 - Y2&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># VECM 공적분 확인</span>
<span class="n">coint_result</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">coint</span><span class="p">(</span><span class="n">Y1</span><span class="p">,</span> <span class="n">Y2</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([</span><span class="n">coint_result</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">coint_result</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;statistics&#39;</span><span class="p">,</span> <span class="s1">&#39;p-value&#39;</span><span class="p">],</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;output&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/4_Algorithms_TS_NonLinear_52_0.png" src="../_images/4_Algorithms_TS_NonLinear_52_0.png" />
<img alt="../_images/4_Algorithms_TS_NonLinear_52_1.png" src="../_images/4_Algorithms_TS_NonLinear_52_1.png" />
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>output</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>statistics</td>
      <td>-22.680907</td>
    </tr>
    <tr>
      <td>p-value</td>
      <td>0.000000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="id14">
<h3>실습: 페어 트레이딩 Cointegration 모형화 및 해석<a class="headerlink" href="#id14" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 데이터 로딩</span>
<span class="kn">import</span> <span class="nn">pandas_datareader.data</span> <span class="k">as</span> <span class="nn">web</span>
<span class="kn">import</span> <span class="nn">datetime</span>

<span class="n">start</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2014</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">end</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2018</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">31</span><span class="p">)</span>
<span class="n">raw1</span> <span class="o">=</span> <span class="n">web</span><span class="o">.</span><span class="n">DataReader</span><span class="p">(</span><span class="s2">&quot;005930.KS&quot;</span><span class="p">,</span> <span class="s1">&#39;yahoo&#39;</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">)</span>
<span class="n">raw2</span> <span class="o">=</span> <span class="n">web</span><span class="o">.</span><span class="n">DataReader</span><span class="p">(</span><span class="s2">&quot;005935.KS&quot;</span><span class="p">,</span> <span class="s1">&#39;yahoo&#39;</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">)</span>
<span class="c1"># raw2 = web.DataReader(&quot;009150.KS&quot;, &#39;yahoo&#39;, start, end)</span>

<span class="c1"># 데이터 시각화</span>
<span class="c1">## 시계열 움직임</span>
<span class="n">raw</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">raw1</span><span class="o">.</span><span class="n">Close</span><span class="p">,</span> <span class="n">raw2</span><span class="o">.</span><span class="n">Close</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
<span class="n">raw</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;SE&quot;</span><span class="p">,</span> <span class="s2">&quot;SE_PS&quot;</span><span class="p">]</span>
<span class="n">raw</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1">## 비교 움직임</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">raw</span><span class="o">.</span><span class="n">SE</span><span class="p">,</span> <span class="n">raw</span><span class="o">.</span><span class="n">SE_PS</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">raw</span><span class="o">.</span><span class="n">SE</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">:],</span> <span class="n">raw</span><span class="o">.</span><span class="n">SE_PS</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">:],</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># 비정상성 차수 추론</span>
<span class="n">target</span> <span class="o">=</span> <span class="n">raw</span><span class="o">.</span><span class="n">SE</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">integ_result</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">sm</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">stattools</span><span class="o">.</span><span class="n">adfuller</span><span class="p">(</span><span class="n">target</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">],</span> 
                         <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Test Statistics&#39;</span><span class="p">,</span> <span class="s1">&#39;p-value&#39;</span><span class="p">,</span> <span class="s1">&#39;Used Lag&#39;</span><span class="p">,</span> <span class="s1">&#39;Used Observations&#39;</span><span class="p">])</span>
<span class="n">Y1_integ_order</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">if</span> <span class="n">integ_result</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.1</span><span class="p">:</span>
    <span class="n">Y1_integ_order</span> <span class="o">=</span> <span class="n">Y1_integ_order</span> <span class="o">+</span> <span class="mi">1</span>
<span class="n">target</span> <span class="o">=</span> <span class="n">raw</span><span class="o">.</span><span class="n">SE_PS</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">integ_result</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">sm</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">stattools</span><span class="o">.</span><span class="n">adfuller</span><span class="p">(</span><span class="n">target</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">],</span> 
                         <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Test Statistics&#39;</span><span class="p">,</span> <span class="s1">&#39;p-value&#39;</span><span class="p">,</span> <span class="s1">&#39;Used Lag&#39;</span><span class="p">,</span> <span class="s1">&#39;Used Observations&#39;</span><span class="p">])</span>
<span class="n">Y2_integ_order</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">if</span> <span class="n">integ_result</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.1</span><span class="p">:</span>
    <span class="n">Y2_integ_order</span> <span class="o">=</span> <span class="n">Y2_integ_order</span> <span class="o">+</span> <span class="mi">1</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Y1_order: &#39;</span><span class="p">,</span> <span class="n">Y1_integ_order</span><span class="p">,</span> <span class="s1">&#39;Y2_order: &#39;</span><span class="p">,</span> <span class="n">Y2_integ_order</span><span class="p">)</span>
    
<span class="c1"># 회귀분석 적합</span>
<span class="c1">## 모델링</span>
<span class="n">Y</span> <span class="o">=</span> <span class="n">raw</span><span class="o">.</span><span class="n">SE</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">raw</span><span class="o">.</span><span class="n">SE_PS</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">add_constant</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="n">fit</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">OLS</span><span class="p">(</span><span class="n">Y</span><span class="p">,</span> <span class="n">X</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">display</span><span class="p">(</span><span class="n">fit</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>

<span class="c1">## 회귀분석 시각화</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">regplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;SE_PS&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;SE&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">raw</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># 공적분 시계열 시각화</span>
<span class="n">Y_integ</span> <span class="o">=</span> <span class="n">raw</span><span class="o">.</span><span class="n">SE</span> <span class="o">-</span> <span class="n">fit</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">raw</span><span class="o">.</span><span class="n">SE_PS</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
<span class="n">Y_integ</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># 공적분 시계열 비정상성 테스트</span>
<span class="n">target</span> <span class="o">=</span> <span class="n">fit</span><span class="o">.</span><span class="n">resid</span>
<span class="n">display</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">sm</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">stattools</span><span class="o">.</span><span class="n">adfuller</span><span class="p">(</span><span class="n">target</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">],</span> 
                  <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Test Statistics&#39;</span><span class="p">,</span> <span class="s1">&#39;p-value&#39;</span><span class="p">,</span> <span class="s1">&#39;Used Lag&#39;</span><span class="p">,</span> <span class="s1">&#39;Used Observations&#39;</span><span class="p">]))</span>

<span class="c1"># VECM 공적분 테스트</span>
<span class="n">coint_result</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">coint</span><span class="p">(</span><span class="n">raw</span><span class="o">.</span><span class="n">SE</span><span class="p">,</span> <span class="n">raw</span><span class="o">.</span><span class="n">SE_PS</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([</span><span class="n">coint_result</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">coint_result</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;statistics&#39;</span><span class="p">,</span> <span class="s1">&#39;p-value&#39;</span><span class="p">],</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;output&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/4_Algorithms_TS_NonLinear_54_0.png" src="../_images/4_Algorithms_TS_NonLinear_54_0.png" />
<img alt="../_images/4_Algorithms_TS_NonLinear_54_1.png" src="../_images/4_Algorithms_TS_NonLinear_54_1.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Y1_order:  1 Y2_order:  1
</pre></div>
</div>
<div class="output text_html"><table class="simpletable">
<caption>OLS Regression Results</caption>
<tr>
  <th>Dep. Variable:</th>           <td>SE</td>        <th>  R-squared:         </th> <td>   0.991</td> 
</tr>
<tr>
  <th>Model:</th>                   <td>OLS</td>       <th>  Adj. R-squared:    </th> <td>   0.991</td> 
</tr>
<tr>
  <th>Method:</th>             <td>Least Squares</td>  <th>  F-statistic:       </th> <td>1.295e+05</td>
</tr>
<tr>
  <th>Date:</th>             <td>Fri, 13 Mar 2020</td> <th>  Prob (F-statistic):</th>  <td>  0.00</td>  
</tr>
<tr>
  <th>Time:</th>                 <td>23:33:27</td>     <th>  Log-Likelihood:    </th> <td> -10165.</td> 
</tr>
<tr>
  <th>No. Observations:</th>      <td>  1221</td>      <th>  AIC:               </th> <td>2.033e+04</td>
</tr>
<tr>
  <th>Df Residuals:</th>          <td>  1219</td>      <th>  BIC:               </th> <td>2.034e+04</td>
</tr>
<tr>
  <th>Df Model:</th>              <td>     1</td>      <th>                     </th>     <td> </td>    
</tr>
<tr>
  <th>Covariance Type:</th>      <td>nonrobust</td>    <th>                     </th>     <td> </td>    
</tr>
</table>
<table class="simpletable">
<tr>
    <td></td>       <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>const</th> <td>  915.1881</td> <td>   97.943</td> <td>    9.344</td> <td> 0.000</td> <td>  723.033</td> <td> 1107.344</td>
</tr>
<tr>
  <th>SE_PS</th> <td>    1.2147</td> <td>    0.003</td> <td>  359.877</td> <td> 0.000</td> <td>    1.208</td> <td>    1.221</td>
</tr>
</table>
<table class="simpletable">
<tr>
  <th>Omnibus:</th>       <td>11.477</td> <th>  Durbin-Watson:     </th> <td>   0.124</td>
</tr>
<tr>
  <th>Prob(Omnibus):</th> <td> 0.003</td> <th>  Jarque-Bera (JB):  </th> <td>  10.735</td>
</tr>
<tr>
  <th>Skew:</th>          <td>-0.189</td> <th>  Prob(JB):          </th> <td> 0.00467</td>
</tr>
<tr>
  <th>Kurtosis:</th>      <td> 2.738</td> <th>  Cond. No.          </th> <td>9.94e+04</td>
</tr>
</table><br/><br/>Warnings:<br/>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.<br/>[2] The condition number is large, 9.94e+04. This might indicate that there are<br/>strong multicollinearity or other numerical problems.</div><img alt="../_images/4_Algorithms_TS_NonLinear_54_4.png" src="../_images/4_Algorithms_TS_NonLinear_54_4.png" />
<img alt="../_images/4_Algorithms_TS_NonLinear_54_5.png" src="../_images/4_Algorithms_TS_NonLinear_54_5.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Test Statistics        -3.742838
p-value                 0.003549
Used Lag                9.000000
Used Observations    1211.000000
dtype: float64
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>output</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>statistics</td>
      <td>-3.743068</td>
    </tr>
    <tr>
      <td>p-value</td>
      <td>0.016116</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./TimeSeriesData"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="3_Algorithms_ML_TS_Linear.html" title="previous page">기계학습(Machine Learning) 알고리즘</a>
    <a class='right-next' id="next-link" href="../reference/cheatsheet.html" title="next page">MyST cheat sheet</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Raphael Kim<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="../_static/js/index.3da636dd464baa7582d2.js"></script>


    
  </body>
</html>