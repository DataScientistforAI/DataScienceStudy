
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>기계학습(Machine Learning) 알고리즘 &#8212; Data Science Study</title>
    
  <link rel="stylesheet" href="../_static/css/index.73d71520a4ca3b99cfee5594769eaaae.css">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../_static/sphinx-book-theme.40e2e510f6b7d1648584402491bb10fe.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.3da636dd464baa7582d2.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.d31b09fe5c1d09cb49b26a786de4a05d.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="비선형 시계열 알고리즘" href="4_Algorithms_TS_NonLinear.html" />
    <link rel="prev" title="학습방향과 알고리즘(Learning Style and Algorithms)" href="2_Learning_TimeSeries.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../index.html">
  
  
  <h1 class="site-logo" id="site-title">Data Science Study</h1>
  
</a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../intro.html">
   Books with Jupyter
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Get started
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../start/overview.html">
   Overview
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../start/build.html">
   Build your book
  </a>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../start/publish.html">
   Publish your book online
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../publish/gh-pages.html">
     GitHub Pages and Actions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../publish/netlify.html">
     Publish with Netlify
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../customize/config.html">
   Configure book settings
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../customize/toc.html">
   Table of contents structure
  </a>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../file-types/index.html">
   Types of content source files
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../file-types/markdown.html">
     Markdown files
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../file-types/notebooks.html">
     Jupyter Notebook files
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../file-types/myst-notebooks.html">
     Notebooks written entirely in Markdown
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../file-types/restructuredtext.html">
     reStructuredText files
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Write book content
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../content/myst.html">
   MyST Markdown overview
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../content/content-blocks.html">
   Special content blocks
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../content/citations.html">
   References and citations
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../content/math.html">
   Math and equations
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../content/figures.html">
   Images and figures
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../content/layout.html">
   Control the page layout
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../content/execute.html">
   Execute and cache your pages
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../content/code-outputs.html">
   Formatting code outputs
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Make your book interactive
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../interactive/launchbuttons.html">
   Launch buttons for interactivity
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../interactive/hiding.html">
   Hide or remove content
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../interactive/interactive.html">
   Interactive data visualizations
  </a>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../interactive/comments.html">
   Commenting and annotating
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../interactive/comments/hypothesis.html">
     Hypothesis
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../interactive/comments/utterances.html">
     Utterances
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Advanced and miscellaneous
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../advanced/pdf.html">
   PDFs for your book
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../advanced/sphinx.html">
   Custom Sphinx configuration
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../advanced/advanced.html">
   How-to and FAQ
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../contribute/intro.html">
   Contribute to Jupyter Book
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Analysis of Time Series Data
 </span>
</p>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="1_Data_Analysis_Cycle.html">
   데이터 분석의 단계별 목적 이해하기 (분석 싸이클 이해)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="1_Data_Analysis_Cycle.html#id5">
   분석을 이해하고 공감하는 자세 및 방향
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="1_Data_Analysis_Cycle.html#id10">
   분석 단계별 의사결정을 위한 수학/통계적 언어를 이해하기
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2_Learning_TimeSeries.html">
   학습방향과 알고리즘(Learning Style and Algorithms)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2_Learning_TimeSeries.html#id2">
   시계열 데이터/분석과 기계학습의 차이
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2_Learning_TimeSeries.html#id8">
   (시계열) 회귀분석 요약
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2_Learning_TimeSeries.html#id12">
   시계열 분석
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   기계학습(Machine Learning) 알고리즘
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="#id6">
   시계열 알고리즘
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="4_Algorithms_TS_NonLinear.html">
   비선형 시계열 알고리즘
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="4_Algorithms_TS_NonLinear.html#id9">
   다변량 시계열 알고리즘
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Reference
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference external" href="https://executablebooks.org/en/latest/gallery.html">
   Gallery of Jupyter Books
   <i class="fas fa-external-link-alt">
   </i>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../reference/cheatsheet.html">
   MyST cheat sheet
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../reference/cli.html">
   The command-line interface
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../reference/glossary.html">
   Glossary
  </a>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/TimeSeriesData/3_Algorithms_ML_TS_Linear.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

        <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/DataScientistforAI/DataScienceStudy"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/DataScientistforAI/DataScienceStudy/issues/new?title=Issue%20on%20page%20%2FTimeSeriesData/3_Algorithms_ML_TS_Linear.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/DataScientistforAI/DataScienceStudy/master?urlpath=tree/TimeSeriesData/3_Algorithms_ML_TS_Linear.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <a class="colab-button" href="https://colab.research.google.com"/github/DataScientistforAI/DataScienceStudy/blob/master/TimeSeriesData/3_Algorithms_ML_TS_Linear.ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Launch Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="../_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        
    </div>
</div>

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   기계학습(Machine Learning) 알고리즘
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#regularized-method-penalized-method-contrained-least-squares">
     정규화 방법론(Regularized Method, Penalized Method, Contrained Least Squares)
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     정규화 회귀분석 알고리즘
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id2">
       하이퍼파라미터 특성 및 요약
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id3">
       실습
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id4">
     회귀분석 알고리즘 정리
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#bagging-and-boosting">
     Bagging and Boosting 모델
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#bias-variance-trade-off">
       편향-분산 상충관계(Bias-variance Trade-off)
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#bagging-vs-boosting">
       Bagging vs Boosting
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#bagging">
       Bagging 알고리즘
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#boosting">
       Boosting 알고리즘
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id5">
       비교
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id6">
   시계열 알고리즘
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#non-stationary-stationary">
     비정상성(Non-stationary)의 정상성(Stationary) 변환
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id7">
       정상성 테스트 방향
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#co2">
       실습: 대기중 CO2농도 추세 제거
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id8">
       실습: 호흡기질환 사망자수 계절성 제거
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id9">
       실습: 랜덤워크의 정상성 변환
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#log-box-cox">
       실습: 항공사 승객수요 스케일 변환(Log / Box-Cox)
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id10">
       실습: 항공사 승객수요 정상성 변환
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#general-linear-process">
     일반 선형확률과정(General Linear Process)
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#wn-white-noise">
       WN(White Noise)
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#ma-moving-average">
       MA(Moving Average)
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#ar-auto-regressive">
       AR(Auto-Regressive)
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#relation-of-ma-and-ar">
       Relation of MA and AR
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#arma-auto-regressive-moving-average">
       ARMA(Auto-Regressive Moving Average)
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id11">
       모형 차수결정 정리
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#arma">
       실습: 항체형성 호르몬수지 ARMA 모델링
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id12">
       실습: 호흡기질환 사망자수 ARMA 모델링
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#armax-arma-with-exogenous">
       ARMAX(ARMA with eXogenous)
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#armax">
       실습: 통화량을 고려한 소비자지출 ARMAX 모델링
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#integrated-linear-process">
     적분 선형확률과정(Integrated Linear Process)
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#arima-auto-regressive-integrated-moving-average">
       ARIMA(Auto-Regressive Integrated Moving Average)
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#arima">
       ARIMA 모형 차수결정 정리
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#sarima-seasonal-arima">
       SARIMA(Seasonal ARIMA)
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#simple-sarima-acf">
         Simple SARIMA: 계절성 시차에서만 ACF가 유의하지 않음
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#multiplicated-sarima-acf">
         Multiplicated SARIMA: 계절성 시차와 그 주변의 시차에서도 ACF가 유의하지 않음
        </a>
       </li>
      </ul>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#sarima">
       실습: 호흡기질환 사망자수 SARIMA 모델링
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id13">
       실습: 항공사 승객수요 SARIMA 모델링
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id14">
     선형확률과정의 분석싸이클
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#non-seasonal">
       분석싸이클 정리(Non-seasonal)
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id15">
       분석싸이클 자동화(Non-seasonal)
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#auro-arima">
       실습: 항공사 승객수요 Auro-ARIMA 모델링
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
</ul>

        </nav>
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <center><img src='Image/Contents_Part3.png' width='800'></center><div class="section" id="machine-learning">
<h1>기계학습(Machine Learning) 알고리즘<a class="headerlink" href="#machine-learning" title="Permalink to this headline">¶</a></h1>
<div class="section" id="regularized-method-penalized-method-contrained-least-squares">
<h2>정규화 방법론(Regularized Method, Penalized Method, Contrained Least Squares)<a class="headerlink" href="#regularized-method-penalized-method-contrained-least-squares" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><p><strong>“선형회귀 계수(Weight)에 대한 제약 조건을 추가함으로써 모형이 과도하게 최적화되는 현상, 즉 과최적화를 막는 방법”</strong><br />
<strong>“과최적화는 계수 크기를 과도하게 증가하는 경향이 있기에, 정규화 방법에서의 제약 조건은 일반적으로 계수의 크기를 제한하는 방법”</strong></p>
</div></blockquote>
</div>
<div class="section" id="id1">
<h2>정규화 회귀분석 알고리즘<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<p><strong>0) Standard Regression:</strong></p>
<center>
$\hat{\beta} = arg\underset{\hat{\beta}}{min} \Biggl[\displaystyle \sum_{j=1}^t \Bigl(y_j - \displaystyle \sum_{i=0}^k \beta_i x_{ij}\Bigr)^2\Biggr]$
</center>
<p><strong>1) Ridge Regression:</strong></p>
<ul class="simple">
<li><p><strong>정규화조건/패널티/제약조건:</strong> 추정계수의 제곱합을 최소로 하는 것</p></li>
</ul>
<p>\begin{align*}
\hat{\beta} = arg\underset{\hat{\beta}}{min} \Biggl[\displaystyle \sum_{j=1}^t \Bigl(y_j - \displaystyle \sum_{i=0}^k \beta_i x_{ij}\Bigr)^2 + \lambda \displaystyle \sum_{i=0}^k \beta_i^2\Biggr] \ where~\lambda~is~hyper~parameter(given~by~human)
\end{align*}</p>
<ul class="simple">
<li><p><strong>하이퍼파라미터(<span class="math notranslate nohighlight">\(\lambda\)</span>):</strong> 기존의 잔차 제곱합과 추가 제약 조건의 비중을 조절하기 위한 하이퍼모수(hyperparameter)</p>
<ul>
<li><p><span class="math notranslate nohighlight">\(\lambda\)</span>=0: 일반적인 선형 회귀모형(OLS)</p></li>
<li><p><span class="math notranslate nohighlight">\(\lambda\)</span>를 크게 두면 정규화(패널티) 정도가 커지기 때문에 가중치(<span class="math notranslate nohighlight">\(\beta_i\)</span>)의 값들이 커질 수 없음(작아짐)</p></li>
<li><p><span class="math notranslate nohighlight">\(\lambda\)</span>를 작게 두면 정규화(패널티) 정도가 작아 지기 때문에 가중치(<span class="math notranslate nohighlight">\(\beta_i\)</span>)의 값들의 자유도가 높아져 커질 수 있음(커짐)</p></li>
</ul>
</li>
</ul>
<p><strong>2) Lasso(Least Absolute Shrinkage and Selection Operator) Regression:</strong></p>
<ul class="simple">
<li><p><strong>정규화조건/패널티/제약조건:</strong> 추정계수의 절대값 합을 최소로 하는 것</p></li>
</ul>
<p>\begin{align*}
\hat{\beta} = arg\underset{\hat{\beta}}{min} \Biggl[\displaystyle \sum_{j=1}^t \Bigl(y_j - \displaystyle \sum_{i=0}^k \beta_i x_{ij}\Bigr)^2 + \lambda \displaystyle \sum_{i=0}^k \left|\beta_i \right|\Biggr] \ where~\lambda~is~hyper~parameter(given~by~human)
\end{align*}</p>
<center><img src='Image/Ridge_Lasso.png' width='600'></center> 
<p><strong>3) Elastic Net:</strong></p>
<ul class="simple">
<li><p><strong>정규화조건/패널티/제약조건:</strong> 추정계수의 절대값 합과 제곱합을 동시에 최소로 하는 것</p></li>
</ul>
<p>\begin{align*}
\hat{\beta} &amp;= arg\underset{\hat{\beta}}{min} \Biggl[\displaystyle \sum_{j=1}^t \Bigl(y_j - \displaystyle \sum_{i=0}^k \beta_i x_{ij}\Bigr)^2 + \lambda_1 \displaystyle \sum_{i=0}^k \left|\beta_i \right| + \lambda_2 \displaystyle \sum_{i=0}^k \beta_i^2\Biggr] \ &amp;where~\lambda_1~and~\lambda_2~are~hyper~parameters(given~by~human)
\end{align*}</p>
<div class="section" id="id2">
<h3>하이퍼파라미터 특성 및 요약<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p><strong>최적 정규화(최적 하이퍼파라미터 추정):</strong> 하이퍼파라미터(Hyperparameter)에 따른 검증성능 차이 존재</p>
<ul>
<li><p><strong>Train Set:</strong> 하이퍼파라미터가 작으면 작을수록 좋아짐(과최적화)</p></li>
<li><p><strong>Test Set:</strong> 하이퍼파라미터가 특정한 범위에 있을때 좋아짐(추정필요)</p></li>
</ul>
</li>
<li><p><strong>Summary</strong></p></li>
</ul>
<blockquote>
<div><ul class="simple">
<li><p><strong>Standard:</strong>
<center><img src='Image/Regression_Result_Standard.png' width='400'></center></p></li>
<li><p><strong>Ridge:</strong>
- 알고리즘이 모든 변수들을 포함하려 하기 때문에 계수의 크기가 작아지고 모형의 복잡도가 줄어듬<br />
- 모든 변수들을 포함하려 하므로 변수의 수가 많은 경우 효과가 좋지 않으나 과적합(Overfitting)을 방지하는데 효과적<br />
- 다중공선성이 존재할 경우, 변수 간 상관관계에 따라 계수로 다중공선성이 분산되기에 효과가 높음<br />
<center><img src='Image/Regression_Result_Ridge1.png' width='400'><img src='Image/Regression_Result_Ridge2.png' width='400'></center></p></li>
<li><p><strong>LASSO:</strong><br />
- 알고리즘이 최소한의 변수를 포함하여 하기 때문의 나머지 변수들의 계수는 0이됨 (Feature Selection 기능)<br />
- 변수선택 기능이 있기에 일반적으로 많이 사용되는 이점이 있지만 특정변수에 대한 계수가 커지는 단점 존재<br />
- 다중공선성이 존재할 경우, 특정 변수만을 선택하는 방식이라 <strong>Ridge</strong>에 비해 다중공선성 문제에 효과가 낮음<br />
<center><img src='Image/Regression_Result_Lasso1.png' width='400'><img src='Image/Regression_Result_Lasso2.png' width='400'></center></p></li>
<li><p><strong>Elastic Net:</strong><br />
- 큰 데이터셋에서 Ridge와 LASSO의 효과를 모두 반영하기에 효과가 좋음 (적은 데이터셋은 효과 낮음)<br />
<center><img src='Image/Regression_Result_EN.png' width='400'></center></p></li>
</ul>
</div></blockquote>
<ul>
<li><p><strong>파라미터 세팅(실습)</strong></p>
<blockquote>
<div><p><strong>1) “statsmodels”:</strong> 선형 회귀모형 클래스의 fit_regularized 메서드를 사용하여 Ridge/LASSO/Elastic Net 계수 추정</p>
</div></blockquote>
<ul class="simple">
<li><p><strong>Ridge:</strong></p></li>
</ul>
  <center>
  $\lambda_1 = 0,~~0 < \lambda_2 < 1 \\ => L_1 = 0,~~alpha \ne 0$
  </center>
  - **LASSO:** 
  <center>
  $0 < \lambda_1 < 1,~~\lambda_2 = 0 \\ => L_1 = 1,~~alpha \ne 0$
  </center>
  - **Elastic Net:** 
  <center>
  $0 < (\lambda_1, \lambda_2) < 1 \\ => 0 < L_1 < 1,~~alpha \ne 0$
  </center>
<blockquote>
<div><p><strong>2) “sklearn”:</strong> 정규화 회귀모형을 위한 Ridge, Lasso, ElasticNet 별도 클래스 제공</p>
</div></blockquote>
<ul class="simple">
<li><p><a class="reference external" href="http://scikit-learn.org/stable/modules/generated/sklearn.linear_model.Ridge.html"><strong>Ridge:</strong></a></p></li>
</ul>
  <center>
  $0 < (\lambda = alpha) < 1$
  </center>
  - [**LASSO:**](http://scikit-learn.org/stable/modules/generated/sklearn.linear_model.Lasso.html)
  <center>
  $0 < (\lambda = alpha) < 1$
  </center>
  - [**Elastic Net:**](http://scikit-learn.org/stable/modules/generated/sklearn.linear_model.ElasticNet.html)
  <center>
  $0 < (\lambda_1, \lambda_2) < 1 \\ => 0 < L_1 < 1,~~alpha \ne 0$
  </center>
</li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Ridge</span>
<span class="n">fit</span> <span class="o">=</span> <span class="n">Ridge</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">fit_intercept</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">123</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">Y_train</span><span class="p">)</span>
<span class="n">pred_tr</span> <span class="o">=</span> <span class="n">fit</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="n">pred_te</span> <span class="o">=</span> <span class="n">fit</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="c1"># LASSO</span>
<span class="n">fit</span> <span class="o">=</span> <span class="n">Lasso</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">fit_intercept</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">123</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">Y_train</span><span class="p">)</span>
<span class="n">pred_tr</span> <span class="o">=</span> <span class="n">fit</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="n">pred_te</span> <span class="o">=</span> <span class="n">fit</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="c1"># Elastic Net</span>
<span class="n">fit</span> <span class="o">=</span> <span class="n">ElasticNet</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">l1_ratio</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">fit_intercept</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">123</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">Y_train</span><span class="p">)</span>
<span class="n">pred_tr</span> <span class="o">=</span> <span class="n">fit</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="n">pred_te</span> <span class="o">=</span> <span class="n">fit</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="id3">
<h3>실습<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;always&#39;</span><span class="p">)</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">datasets</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">Ridge</span><span class="p">,</span> <span class="n">Lasso</span><span class="p">,</span> <span class="n">ElasticNet</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">diabetes</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">load_diabetes</span><span class="p">()</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">diabetes</span><span class="o">.</span><span class="n">data</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">diabetes</span><span class="o">.</span><span class="n">target</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Data View&#39;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;diabetes_value&#39;</span><span class="p">]),</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">diabetes</span><span class="o">.</span><span class="n">feature_names</span><span class="p">)],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Data View
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>diabetes_value</th>
      <th>age</th>
      <th>sex</th>
      <th>bmi</th>
      <th>bp</th>
      <th>s1</th>
      <th>s2</th>
      <th>s3</th>
      <th>s4</th>
      <th>s5</th>
      <th>s6</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>151.0</td>
      <td>0.038076</td>
      <td>0.050680</td>
      <td>0.061696</td>
      <td>0.021872</td>
      <td>-0.044223</td>
      <td>-0.034821</td>
      <td>-0.043401</td>
      <td>-0.002592</td>
      <td>0.019908</td>
      <td>-0.017646</td>
    </tr>
    <tr>
      <th>1</th>
      <td>75.0</td>
      <td>-0.001882</td>
      <td>-0.044642</td>
      <td>-0.051474</td>
      <td>-0.026328</td>
      <td>-0.008449</td>
      <td>-0.019163</td>
      <td>0.074412</td>
      <td>-0.039493</td>
      <td>-0.068330</td>
      <td>-0.092204</td>
    </tr>
    <tr>
      <th>2</th>
      <td>141.0</td>
      <td>0.085299</td>
      <td>0.050680</td>
      <td>0.044451</td>
      <td>-0.005671</td>
      <td>-0.045599</td>
      <td>-0.034194</td>
      <td>-0.032356</td>
      <td>-0.002592</td>
      <td>0.002864</td>
      <td>-0.025930</td>
    </tr>
    <tr>
      <th>3</th>
      <td>206.0</td>
      <td>-0.089063</td>
      <td>-0.044642</td>
      <td>-0.011595</td>
      <td>-0.036656</td>
      <td>0.012191</td>
      <td>0.024991</td>
      <td>-0.036038</td>
      <td>0.034309</td>
      <td>0.022692</td>
      <td>-0.009362</td>
    </tr>
    <tr>
      <th>4</th>
      <td>135.0</td>
      <td>0.005383</td>
      <td>-0.044642</td>
      <td>-0.036385</td>
      <td>0.021872</td>
      <td>0.003935</td>
      <td>0.015596</td>
      <td>0.008142</td>
      <td>-0.002592</td>
      <td>-0.031991</td>
      <td>-0.046641</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alpha_weight</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">fit</span> <span class="o">=</span> <span class="n">Ridge</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="n">alpha_weight</span><span class="p">,</span> <span class="n">fit_intercept</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">123</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">([</span><span class="n">fit</span><span class="o">.</span><span class="n">intercept_</span><span class="p">,</span> <span class="n">fit</span><span class="o">.</span><span class="n">coef_</span><span class="p">]),</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;alpha = </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">alpha_weight</span><span class="p">)])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>alpha = 0.5</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>152.133484</td>
    </tr>
    <tr>
      <th>1</th>
      <td>20.137357</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-131.242606</td>
    </tr>
    <tr>
      <th>3</th>
      <td>383.481783</td>
    </tr>
    <tr>
      <th>4</th>
      <td>244.837872</td>
    </tr>
    <tr>
      <th>5</th>
      <td>-15.187056</td>
    </tr>
    <tr>
      <th>6</th>
      <td>-58.344798</td>
    </tr>
    <tr>
      <th>7</th>
      <td>-174.842798</td>
    </tr>
    <tr>
      <th>8</th>
      <td>121.985055</td>
    </tr>
    <tr>
      <th>9</th>
      <td>328.499702</td>
    </tr>
    <tr>
      <th>10</th>
      <td>110.886036</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alpha_weight</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">fit</span> <span class="o">=</span> <span class="n">Lasso</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="n">alpha_weight</span><span class="p">,</span> <span class="n">fit_intercept</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">123</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">([</span><span class="n">fit</span><span class="o">.</span><span class="n">intercept_</span><span class="p">,</span> <span class="n">fit</span><span class="o">.</span><span class="n">coef_</span><span class="p">]),</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;alpha = </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">alpha_weight</span><span class="p">)])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>alpha = 0.5</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>152.133484</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-0.000000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>471.038733</td>
    </tr>
    <tr>
      <th>4</th>
      <td>136.507108</td>
    </tr>
    <tr>
      <th>5</th>
      <td>-0.000000</td>
    </tr>
    <tr>
      <th>6</th>
      <td>-0.000000</td>
    </tr>
    <tr>
      <th>7</th>
      <td>-58.319549</td>
    </tr>
    <tr>
      <th>8</th>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>9</th>
      <td>408.023324</td>
    </tr>
    <tr>
      <th>10</th>
      <td>0.000000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">result_Ridge</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="n">alpha_candidate</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">)])</span>
<span class="k">for</span> <span class="n">alpha_weight</span> <span class="ow">in</span> <span class="n">alpha_candidate</span><span class="p">:</span>
    <span class="n">fit</span> <span class="o">=</span> <span class="n">Ridge</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="n">alpha_weight</span><span class="p">,</span> <span class="n">fit_intercept</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">123</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
    <span class="n">result_coef</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">([</span><span class="n">fit</span><span class="o">.</span><span class="n">intercept_</span><span class="p">,</span> <span class="n">fit</span><span class="o">.</span><span class="n">coef_</span><span class="p">]),</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;alpha = </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">alpha_weight</span><span class="p">)])</span>
    <span class="n">result_Ridge</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">result_Ridge</span><span class="p">,</span> <span class="n">result_coef</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
   
<span class="n">result_LASSO</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="n">alpha_candidate</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">)])</span>
<span class="k">for</span> <span class="n">alpha_weight</span> <span class="ow">in</span> <span class="n">alpha_candidate</span><span class="p">:</span>
    <span class="n">fit</span> <span class="o">=</span> <span class="n">Lasso</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="n">alpha_weight</span><span class="p">,</span> <span class="n">fit_intercept</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">123</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
    <span class="n">result_coef</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">([</span><span class="n">fit</span><span class="o">.</span><span class="n">intercept_</span><span class="p">,</span> <span class="n">fit</span><span class="o">.</span><span class="n">coef_</span><span class="p">]),</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;alpha = </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">alpha_weight</span><span class="p">)])</span>
    <span class="n">result_LASSO</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">result_LASSO</span><span class="p">,</span> <span class="n">result_coef</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    
<span class="n">result_Ridge</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">),</span> <span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">211</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Ridge&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Columns&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;coefficients&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">result_LASSO</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">212</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;LASSO&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Columns&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;coefficients&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/3_Algorithms_ML_TS_Linear_10_0.png" src="../_images/3_Algorithms_ML_TS_Linear_10_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">result_Ridge</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">),</span> <span class="n">legend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">211</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Ridge&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">result_Ridge</span><span class="o">.</span><span class="n">columns</span><span class="p">)),</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">result_Ridge</span><span class="o">.</span><span class="n">columns</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;coefficients&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">result_LASSO</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">legend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">212</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;LASSO&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">result_Ridge</span><span class="o">.</span><span class="n">columns</span><span class="p">)),</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">result_Ridge</span><span class="o">.</span><span class="n">columns</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;coefficients&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/3_Algorithms_ML_TS_Linear_11_0.png" src="../_images/3_Algorithms_ML_TS_Linear_11_0.png" />
</div>
</div>
</div>
</div>
<div class="section" id="id4">
<h2>회귀분석 알고리즘 정리<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p><strong>변수 세팅에 따른 분류:</strong></p></li>
</ul>
<center><img src='Image/Regression-Algorithms-Tree1.png' width='800'></center> 
<ul class="simple">
<li><p><strong>문제 해결에 따른 분류:</strong></p></li>
</ul>
<center><img src='Image/Regression-Algorithms-Tree2.png' width='800'></center> </div>
<div class="section" id="bagging-and-boosting">
<h2>Bagging and Boosting 모델<a class="headerlink" href="#bagging-and-boosting" title="Permalink to this headline">¶</a></h2>
<div class="section" id="bias-variance-trade-off">
<h3>편향-분산 상충관계(Bias-variance Trade-off)<a class="headerlink" href="#bias-variance-trade-off" title="Permalink to this headline">¶</a></h3>
<p><strong>1) 편향과 분산의 정의</strong></p>
<blockquote>
<div><p><strong>(비수학적 이해)</strong></p>
</div></blockquote>
<ul class="simple">
<li><p><strong>편향(Bias):</strong> 점추정</p>
<ul>
<li><p>예측값과 실제값의 차이</p></li>
<li><p>모델 학습시 여러 데이터로 학습 후 예측값의 범위가 정답과 얼마나 멀리 있는지 측정</p></li>
</ul>
</li>
<li><p><strong>편향(Bias(Real)):</strong> 모형화(단순화)로 미처 반영하지 못한 복잡성<br />
<U>=&gt; 편향이 작다면 Training 데이터 패턴(복잡성)을 최대반영 의미</U><br />
<U>=&gt; 편향이 크다면 Training 데이터 패턴(복잡성)을 최소반영 의미</U></p></li>
<li><p><strong>분산(Variance):</strong> 구간추정</p>
<ul>
<li><p>학습한 모델의 예측값이 평균으로부터 퍼진 정도(변동성/분산)</p></li>
<li><p>여러 모델로 학습을 반복한다면, 학습된 모델별로 예측한 값들의 차이를 측정</p></li>
</ul>
</li>
<li><p><strong>분산(Variance(Real)):</strong> 다른 데이터(Testing)를 사용했을때 발생할 변화<br />
<U>=&gt; 분산이 작다면 다른 데이터로 예측시 적은 변동 예상</U><br />
<U>=&gt; 분산이 크다면 다른 데이터로 예측시 많은 변동 예상</U></p></li>
</ul>
<center><img src='Image/Bias_Variance1.jpeg' width='400'></center>
<blockquote>
<div><p><strong>(수학적 이해)</strong></p>
</div></blockquote>
<p>\begin{align*}
\text{Equation of Error} &amp;&amp; Err(x) &amp;= E\Bigl[\bigl(Y-\hat{f}(x)\bigr)^2 \Bigr] \
&amp;&amp; &amp;= \Bigl(E[\hat{f}(x)] - f(x)\Bigr)^2 + E \Bigl[\bigl(\hat{f}(x) - E[\hat{f}(x)]\bigr)^2 \Bigr] + \sigma_{\epsilon}^2 \
&amp;&amp; &amp;= \text{Bias}^2 + \text{Variance} + \text{Irreducible Error}
\end{align*}</p>
<p><strong>2) 편향과 분산의 관계</strong></p>
<ul class="simple">
<li><p><strong>모델의 복잡도가 낮으면 Bias가 증가하고 Variance가 감소(Underfitting)</strong><br />
: 구간추정 범위는 좁으나 점추정 정확성 낮음<br />
: Training/Testing 모두 예측력이 낮음</p></li>
<li><p><strong>모델의 복잡도가 높으면 Bias가 감소하고 Variance가 증가(Overfitting)</strong><br />
: 점추정 정확성은 높으나 구간추정 범위는 넓음<br />
: Training만 잘 예측력 높고 Testing은 예측력 낮음</p></li>
<li><p><strong>Bias와 Variance가 최소화 되는 수준에서 모델의 복잡도 선택</strong></p></li>
</ul>
<center><img src='Image/Bias-Variance-Tradeoff.png' width='400'></center>
<center><img src='Image/Bias_Variance4.png' width='400'></center>
<p><strong>3) 편향과 분산 모두를 최소화하는 방법</strong></p>
<center><img src='Image/Bias_Variance_Reduce.png' width='600'></center></div>
<div class="section" id="bagging-vs-boosting">
<h3>Bagging vs Boosting<a class="headerlink" href="#bagging-vs-boosting" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><p><strong>앙상블(Ensemble, Ensemble Learning, Ensemble Method)이란 머신러닝에서 여러개의 모델을 학습시켜,<br />
그 모델들의 예측결과들을 이용해 하나의 모델보다 더 나은 값을 예측하는 방법</strong></p>
</div></blockquote>
<ul class="simple">
<li><p><strong>Bagging(Bootstrap Aggregating):</strong></p>
<ul>
<li><p>부트스트래핑(Bootstraping): 예측값과 실제값의 차이 중복을 허용한 리샘플링(Resampling)</p></li>
<li><p>페이스팅(Pasting): 이와 반대로 중복을 허용하지 않는 샘플링</p></li>
</ul>
</li>
<li><p><strong>Boosting:</strong></p>
<ul>
<li><p>성능이 약한 학습기(weak learner)를 여러 개 연결하여 강한 학습기(strong learner)를 만드는 앙상블 학습</p></li>
<li><p>앞에서 학습된 모델을 보완해나가면서 더나은 모델로 학습시키는 것</p></li>
</ul>
</li>
</ul>
<center><img src='Image/Bagging_Boosting.png' width='700'></center> 
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>-</p></th>
<th class="head"><p>Bagging</p></th>
<th class="head"><p>Boosting</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>특징</p></td>
<td><p>병렬 앙상블 모델(각 모델은 서로 독립)</p></td>
<td><p>연속 앙상블 모델(이전 모델의 오류 반영)</p></td>
</tr>
<tr class="row-odd"><td><p>목적</p></td>
<td><p>Variance 감소</p></td>
<td><p>Bias 감소</p></td>
</tr>
<tr class="row-even"><td><p>적합한 상황</p></td>
<td><p>Low Bias + High Variance</p></td>
<td><p>High Bias + Low Variance</p></td>
</tr>
<tr class="row-odd"><td><p>Sampling</p></td>
<td><p>Random Sampling</p></td>
<td><p>Random Sampling with weight on error</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="bagging">
<h3>Bagging 알고리즘<a class="headerlink" href="#bagging" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p><strong>의사결정나무(Decision Tree):</strong></p></li>
</ul>
<center><img src='Image/Bagging_DT.png' width='700'></center> 
<ul class="simple">
<li><p><strong>렌덤포레스트(Random Forest):</strong> 여러개의 의사결정나무(Decision Tree) 생성한 다음, 각 개별 트리의 예측값들 중 가장 많은 선택을 받은 변수들로 예측하는 알고리즘, 의사결정나무의 CLT버전</p></li>
</ul>
<center><img src='Image/Bagging_RF.jpg' width='700'></center> 
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># DecisionTree</span>
<span class="n">fit</span> <span class="o">=</span> <span class="n">DecisionTreeRegressor</span><span class="p">()</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">Y_train</span><span class="p">)</span>
<span class="n">pred_tr</span> <span class="o">=</span> <span class="n">fit</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="n">pred_te</span> <span class="o">=</span> <span class="n">fit</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="c1"># RandomForestRegressor</span>
<span class="n">fit</span> <span class="o">=</span> <span class="n">RandomForestRegressor</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">123</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">Y_train</span><span class="p">)</span>
<span class="n">pred_tr</span> <span class="o">=</span> <span class="n">fit</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="n">pred_te</span> <span class="o">=</span> <span class="n">fit</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="boosting">
<h3>Boosting 알고리즘<a class="headerlink" href="#boosting" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p><strong>Adaptive Boosting(AdaBoost):</strong> 학습된 모델이 과소적합(학습하기 어려운 데이터)된 학습 데이터 샘플의 가중치를 높이면서 더 잘 적합되도록 하는 방식</p></li>
</ul>
<center><img src='Image/Boosting_AdaBoost.png' width='600'></center> 
<ul class="simple">
<li><p><strong>Gradient Boosting Machine(GBM):</strong> 아다부스트 처럼 학습단계 마다 데이터 샘플의 가중치를 업데이트 하는 것이 아니라, 학습 전단계 모델에서의 잔차(Residual)을 모델에 학습시키는 방법</p></li>
</ul>
<center><img src='Image/Boosting_GBM.png' width='600'></center> 
<ul class="simple">
<li><p><strong>XGBoost(eXtreme Gradient Boosting):</strong> 높은 예측력으로 많은 양의 데이터를 다룰 때 사용되는 부스팅 알고리즘</p></li>
</ul>
<center><img src='Image/Boosting_XGBoost.png' width='600'></center> 
<ul class="simple">
<li><p><strong>LightGBM:</strong> 현존하는 부스팅 알고리즘 중 가장 빠르고 높은 예측력 제공</p></li>
</ul>
<center><img src='Image/Boosting_LightGBM.png' width='600'></center> 
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>Algorithms</p></th>
<th class="head"><p>Specification</p></th>
<th class="head"><p>Others</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>AdaBoost</p></td>
<td><p>다수결을 통한 정답분류 및 오답에 가중치 부여</p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p>GBM</p></td>
<td><p>손실함수(검증지표)의 Gradient로 오답에 가중치 부여</p></td>
<td><p>-</p></td>
</tr>
<tr class="row-even"><td><p>XGBoost</p></td>
<td><p>GMB대비 성능향상<br/>시스템(CPU, Mem.) 자원 효율적 사용</p></td>
<td><p>2014년 공개</p></td>
</tr>
<tr class="row-odd"><td><p>LightGBM</p></td>
<td><p>XGBoost대비 성능향상 및 자원소모 최소화<br/>XGBoost가 처리하지 못하는 대용량 데이터 학습가능<br/>근사치분할(Approximates the Split)을 통한 성능향상</p></td>
<td><p>2016년 공개</p></td>
</tr>
</tbody>
</table>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># GradientBoostingRegression</span>
<span class="n">fit</span> <span class="o">=</span> <span class="n">GradientBoostingRegressor</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">learning_rate</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">loss</span><span class="o">=</span><span class="s1">&#39;huber&#39;</span><span class="p">,</span> <span class="n">criterion</span><span class="o">=</span><span class="s1">&#39;friedman_mse&#39;</span><span class="p">,</span>
                                           <span class="n">n_estimators</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">123</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">Y_train</span><span class="p">)</span>
<span class="n">pred_tr</span> <span class="o">=</span> <span class="n">fit</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="n">pred_te</span> <span class="o">=</span> <span class="n">fit</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="c1"># XGBoost</span>
<span class="n">fit</span> <span class="o">=</span> <span class="n">XGBRegressor</span><span class="p">(</span><span class="n">learning_rate</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">n_estimators</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">123</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">Y_train</span><span class="p">)</span>
<span class="n">pred_tr</span> <span class="o">=</span> <span class="n">fit</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="n">pred_te</span> <span class="o">=</span> <span class="n">fit</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="c1"># LightGMB</span>
<span class="n">fit</span> <span class="o">=</span> <span class="n">LGBMRegressor</span><span class="p">(</span><span class="n">learning_rate</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">n_estimators</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">123</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">Y_train</span><span class="p">)</span>
<span class="n">pred_tr</span> <span class="o">=</span> <span class="n">fit</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="n">pred_te</span> <span class="o">=</span> <span class="n">fit</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="id5">
<h3>비교<a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h3>
<center><img src='Image/Bagging_Boosting2.png' width='600'></center> </div>
</div>
</div>
<div class="section" id="id6">
<h1>시계열 알고리즘<a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h1>
<center><img src='Image/TS_Algorithm_Concept.png' width='800'></center> <div class="section" id="non-stationary-stationary">
<h2>비정상성(Non-stationary)의 정상성(Stationary) 변환<a class="headerlink" href="#non-stationary-stationary" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><ul class="simple">
<li><p><strong>목적: 정상성 확보를 통해 안정성이 높아지고 예측력 향상</strong></p></li>
<li><p><strong>장점: 절약성 원칙(Principle of Parsimony)에 따라 적은 모수만으로 모델링 가능하기에 과적합 확률이 줄어듬</strong></p></li>
<li><p><strong>방법: 제곱, 루트, 로그, 차분 등</strong></p></li>
</ul>
</div></blockquote>
<ul class="simple">
<li><p><strong>이론예시:</strong></p></li>
</ul>
<center><img src='Image/Stationary_Example.png' width='800'></center> 
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>- Trend: a/c/e/f/i  
- Seasonality: d/h/i  
- Cycle: g
- Non-constant Variance: i  
</pre></div>
</div>
<p><strong>1) 로그변환(Logarithm Transform):</strong></p>
<blockquote>
<div><ul class="simple">
<li><p>시간흐름에 비례하여 값이 커지는 경우(분산 증가)</p></li>
<li><p>비정상 확률 과정으로 표준편차가 자료의 크기에 비례하여 증가하거나 지수함수적으로 증가하는 경우</p></li>
<li><p>로그 변환한 확률 과정의 분산은 일정하기에 추세 제거로 기댓값이 0이 되면 정상 과정으로 모형화 가능</p></li>
</ul>
</div></blockquote>
<p>\begin{align*}
\text{Distribution of Original} &amp;&amp; \text{E}(Y_t) &amp;= \mu_t = f(t) \
&amp;&amp; \sqrt{\text{Var}(Y_t)} &amp;= \mu_t \sigma \
\text{Distribution of Log-transform} &amp;&amp; Y_t &amp;= Y_{t-1} + Y_t - Y_{t-1} \
&amp;&amp; \dfrac{Y_t}{Y_{t-1}} &amp;= 1 + \dfrac{Y_t - Y_{t-1}}{Y_{t-1}} \
&amp;&amp; log(\dfrac{Y_t}{Y_{t-1}}) &amp;= log(1 + \dfrac{Y_t - Y_{t-1}}{Y_{t-1}}) \approx \dfrac{Y_t - Y_{t-1}}{Y_{t-1}} \
&amp;&amp; log(Y_t) - log(Y_{t-1}) &amp;\approx \dfrac{Y_t - Y_{t-1}}{Y_{t-1}} \
&amp;&amp; log(Y_t) &amp;\approx log(Y_{t-1}) + \dfrac{Y_t - Y_{t-1}}{Y_{t-1}} \
&amp;&amp; log(Y_t) &amp;\approx log(\mu_t) + \dfrac{Y_t - \mu_t}{\mu_t} \
&amp;&amp; \text{E}(\log Y_t) &amp;= \log \mu_t \
&amp;&amp; \text{Var}(\log Y_t) &amp;\approx \sigma^2 \
\text{<em>Generalization of Return} &amp;&amp; R_t &amp;= \dfrac{Y_{t}}{Y_{t-1}} - 1 \
&amp;&amp; \log{Y_t} - \log{Y_{t-1}} &amp;= \log{R_t + 1} \approx R_t ;; \text{ if } \left| R_t \right| &lt; 0.2 \
\end{align</em>}</p>
<p><strong>2) 차분(Difference):</strong> 특정 시점 또는 시점들의 데이터가 발산할 경우 시점간 차분(변화량)으로 정상성 변환 가능</p>
<ul class="simple">
<li><p><strong>계절성(Seasonality, <span class="math notranslate nohighlight">\(S_t\)</span>)</strong>: 특정한 달/요일에 따라 기대값이 달라지는 것, 변수 더미화를 통해 추정 가능</p></li>
</ul>
<blockquote>
<div><ul class="simple">
<li><p><strong>계절성 제거: 1) 계절성 추정(<span class="math notranslate nohighlight">\(f(t)\)</span>) 후 계절성 제거를 통한 정상성 확보 (수학적 이해)</strong>
- 확률과정의 계절변수 더미화를 통해 기댓값 함수를 알아내는 것
- 확률과정(<span class="math notranslate nohighlight">\(Y_t\)</span>)이 추정이 가능한 결정론적 계절성함수(<span class="math notranslate nohighlight">\(f(t)\)</span>)와 정상확률과정(<span class="math notranslate nohighlight">\(Y^s_t\)</span>)의 합</p></li>
</ul>
</div></blockquote>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>\begin{align*}
\text{Main Equation} &amp;&amp; Y_t &amp;= f(t) + Y^s_t \\
\text{where} &amp;&amp; f(t) &amp;= \sum_{i=0}^{\infty} a_i D_i = a_0 + a_1 D_1 + a_2 D_2 + \cdots
\end{align*}
</pre></div>
</div>
<blockquote>
<div><ul class="simple">
<li><p><strong>계절성 제거: 2) 차분 적용 <span class="math notranslate nohighlight">\((1-L^d) Y_t\)</span> 후 계절성 제거를 통한 정상성 확보 (수학적 이해)</strong></p></li>
</ul>
</div></blockquote>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>\begin{align*}
\text{Main Equation of d=1} &amp;&amp; Y_t &amp;=&gt; (1-L^1) Y_t \\
&amp;&amp; &amp;= (1-Lag^1) Y_t \\
&amp;&amp; &amp;= Y_t - Lag^1(Y_t) \\
&amp;&amp; &amp;= Y_t - Y_{t-1} \\
\text{Main Equation of d=2} &amp;&amp; Y_t &amp;=&gt; (1-L^2) Y_t \\
&amp;&amp; &amp;= (1-Lag^2) Y_t \\
&amp;&amp; &amp;= Y_t - Lag^2(Y_t) \\
&amp;&amp; &amp;= Y_t - Y_{t-2} \\
\end{align*}
</pre></div>
</div>
<ul class="simple">
<li><p><strong>추세(Trend, <span class="math notranslate nohighlight">\(T_t\)</span>)</strong>: 시계열이 시간에 따라 증가, 감소 또는 일정 수준을 유지하는 경우</p></li>
</ul>
<blockquote>
<div><ul class="simple">
<li><p><strong>추세 제거: 1) 추세 추정(<span class="math notranslate nohighlight">\(f(t)\)</span>) 후 추세 제거를 통한 정상성 확보 (수학적 이해)</strong>
- 확률과정의 결정론적 기댓값 함수를 알아내는 것
- 확률과정(<span class="math notranslate nohighlight">\(Y_t\)</span>)이 추정이 가능한 결정론적 추세함수(<span class="math notranslate nohighlight">\(f(t)\)</span>)와 정상확률과정(<span class="math notranslate nohighlight">\(Y^s_t\)</span>)의 합</p></li>
</ul>
</div></blockquote>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>\begin{align*}
\text{Main Equation} &amp;&amp; Y_t &amp;= f(t) + Y^s_t \\
\text{where} &amp;&amp; f(t) &amp;= \sum_{i=0}^{\infty} a_i t^i = a_0 + a_1 t + a_2 t^2 + \cdots
\end{align*}
</pre></div>
</div>
<blockquote>
<div><ul class="simple">
<li><p><strong>추세 제거: 2) 차분 적용 <span class="math notranslate nohighlight">\((1-L^1)^d Y_t\)</span> 후 추세 제거를 통한 정상성 확보 (수학적 이해)</strong></p></li>
</ul>
</div></blockquote>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>\begin{align*}
\text{Main Equation of d=1} &amp;&amp; Y_t &amp;=&gt; (1-L^1)^1 Y_t \\
&amp;&amp; &amp;= (1-Lag^1)^1 Y_t \\
&amp;&amp; &amp;= Y_t - Lag^1(Y_t) \\
&amp;&amp; &amp;= Y_t - Y_{t-1} \\
\text{Main Equation of d=2} &amp;&amp; Y_t &amp;=&gt; (1-L^1)^2 Y_t \\
&amp;&amp; &amp;= (1-2L^1+L^2) Y_t \\
&amp;&amp; &amp;= (1-2Lag^1+Lag^2) Y_t \\
&amp;&amp; &amp;= Y_t - 2Lag^1(Y_t) + Lag^2(Y_t) \\
&amp;&amp; &amp;= Y_t - Lag^1(Y_t) - Lag^1(Y_t) + Lag^2(Y_t) \\
&amp;&amp; &amp;= (Y_t - Lag^1(Y_t)) - (Lag^1(Y_t) - Lag^2(Y_t)) \\
&amp;&amp; &amp;= (Y_t - L^1(Y_t)) - (L^1(Y_t) - L^2(Y_t)) \\
&amp;&amp; &amp;= (Y_t - Y_{t-1}) - (Y_{t-1} - Y_{t-2}) \\
&amp;&amp; &amp;= Y_t - 2Y_{t-1} + Y_{t-2} \\
\end{align*}
</pre></div>
</div>
<p><strong>3) Box-Cox 변환:</strong> 정규분포가 아닌 자료를 정규분포로 변환하기 위해 사용</p>
<blockquote>
<div><ul class="simple">
<li><p>모수(parameter) <span class="math notranslate nohighlight">\(\lambda\)</span>를 가지며, 보통 여러가지 <span class="math notranslate nohighlight">\(\lambda\)</span> 값을 시도하여 가장 정규성을 높여주는 값을 사용</p></li>
</ul>
</div></blockquote>
<p>\begin{align*}
y^{(\boldsymbol{\lambda})} =
\begin{cases}
\dfrac{y^{\lambda} - 1}{\lambda} &amp; \text{if } \lambda \neq 0, \
\ln{y} &amp; \text{if } \lambda = 0,
\end{cases}
\end{align*}</p>
<div class="section" id="id7">
<h3>정상성 테스트 방향<a class="headerlink" href="#id7" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><p><strong>추세와 계절성 모두 제거된 정상성 데이터 변환 필요!</strong></p>
<blockquote>
<div><ul class="simple">
<li><p><strong>ADF 정상성 확인 -&gt; 추세 제거 확인 Measure</strong><br />
: ADF 검정통계량은 정상이라고 해도 데이터에 계절성이 포함되면 ACF의 비정상 Lag 존재하는 비정상데이터 가능</p></li>
</ul>
</div></blockquote>
</div></blockquote>
<blockquote>
<div><blockquote>
<div><ul class="simple">
<li><p><strong>KPSS 정상성 확인 -&gt; 계절성 제거 확인 Measure</strong><br />
: KPSS 검정통계량은 정상이라고 해도 데이터에 추세가 포함되면 ACF의 비정상 Lag 존재하는 비정상데이터 가능</p></li>
</ul>
</div></blockquote>
</div></blockquote>
</div>
<div class="section" id="co2">
<h3>실습: 대기중 CO2농도 추세 제거<a class="headerlink" href="#co2" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 라이브러리 및 데이터 로딩</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">statsmodels</span> <span class="kn">import</span> <span class="n">datasets</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="nn">sm</span>
<span class="o">%</span><span class="k">reload_ext</span> autoreload
<span class="o">%</span><span class="k">autoreload</span> 2
<span class="kn">from</span> <span class="nn">module</span> <span class="kn">import</span> <span class="n">stationarity_adf_test</span><span class="p">,</span> <span class="n">stationarity_kpss_test</span>

<span class="n">raw_set</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">get_rdataset</span><span class="p">(</span><span class="s2">&quot;CO2&quot;</span><span class="p">,</span> <span class="n">package</span><span class="o">=</span><span class="s2">&quot;datasets&quot;</span><span class="p">)</span>
<span class="n">raw</span> <span class="o">=</span> <span class="n">raw_set</span><span class="o">.</span><span class="n">data</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ModuleNotFoundError</span><span class="g g-Whitespace">                       </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">7</span><span class="o">-</span><span class="n">c1948bb6176f</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">      </span><span class="mi">6</span> <span class="n">get_ipython</span><span class="p">()</span><span class="o">.</span><span class="n">run_line_magic</span><span class="p">(</span><span class="s1">&#39;reload_ext&#39;</span><span class="p">,</span> <span class="s1">&#39;autoreload&#39;</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">7</span> <span class="n">get_ipython</span><span class="p">()</span><span class="o">.</span><span class="n">run_line_magic</span><span class="p">(</span><span class="s1">&#39;autoreload&#39;</span><span class="p">,</span> <span class="s1">&#39;2&#39;</span><span class="p">)</span>
<span class="ne">----&gt; </span><span class="mi">8</span> <span class="kn">from</span> <span class="nn">module</span> <span class="kn">import</span> <span class="n">stationarity_adf_test</span><span class="p">,</span> <span class="n">stationarity_kpss_test</span>
<span class="g g-Whitespace">      </span><span class="mi">9</span> 
<span class="g g-Whitespace">     </span><span class="mi">10</span> <span class="n">raw_set</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">get_rdataset</span><span class="p">(</span><span class="s2">&quot;CO2&quot;</span><span class="p">,</span> <span class="n">package</span><span class="o">=</span><span class="s2">&quot;datasets&quot;</span><span class="p">)</span>

<span class="ne">ModuleNotFoundError</span>: No module named &#39;module&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 데이터 확인 및 추세 추정 (선형)</span>
<span class="n">display</span><span class="p">(</span><span class="n">raw</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">raw</span><span class="o">.</span><span class="n">time</span><span class="p">,</span> <span class="n">raw</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">result</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">OLS</span><span class="o">.</span><span class="n">from_formula</span><span class="p">(</span><span class="n">formula</span><span class="o">=</span><span class="s1">&#39;value~time&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">raw</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">display</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>

<span class="n">trend</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">result</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">raw</span><span class="o">.</span><span class="n">time</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">raw</span><span class="o">.</span><span class="n">time</span><span class="p">,</span> <span class="n">raw</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">raw</span><span class="o">.</span><span class="n">time</span><span class="p">,</span> <span class="n">trend</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>time</th>
      <th>value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1,959.00</td>
      <td>315.42</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1,959.08</td>
      <td>316.31</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1,959.17</td>
      <td>316.50</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1,959.25</td>
      <td>317.56</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1,959.33</td>
      <td>318.13</td>
    </tr>
  </tbody>
</table>
</div></div><img alt="../_images/3_Algorithms_ML_TS_Linear_24_1.png" src="../_images/3_Algorithms_ML_TS_Linear_24_1.png" />
<div class="output text_html"><table class="simpletable">
<caption>OLS Regression Results</caption>
<tr>
  <th>Dep. Variable:</th>          <td>value</td>      <th>  R-squared:         </th> <td>   0.969</td> 
</tr>
<tr>
  <th>Model:</th>                   <td>OLS</td>       <th>  Adj. R-squared:    </th> <td>   0.969</td> 
</tr>
<tr>
  <th>Method:</th>             <td>Least Squares</td>  <th>  F-statistic:       </th> <td>1.479e+04</td>
</tr>
<tr>
  <th>Date:</th>             <td>Fri, 31 Jul 2020</td> <th>  Prob (F-statistic):</th>  <td>  0.00</td>  
</tr>
<tr>
  <th>Time:</th>                 <td>22:45:19</td>     <th>  Log-Likelihood:    </th> <td> -1113.5</td> 
</tr>
<tr>
  <th>No. Observations:</th>      <td>   468</td>      <th>  AIC:               </th> <td>   2231.</td> 
</tr>
<tr>
  <th>Df Residuals:</th>          <td>   466</td>      <th>  BIC:               </th> <td>   2239.</td> 
</tr>
<tr>
  <th>Df Model:</th>              <td>     1</td>      <th>                     </th>     <td> </td>    
</tr>
<tr>
  <th>Covariance Type:</th>      <td>nonrobust</td>    <th>                     </th>     <td> </td>    
</tr>
</table>
<table class="simpletable">
<tr>
      <td></td>         <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>Intercept</th> <td>-2249.7742</td> <td>   21.268</td> <td> -105.784</td> <td> 0.000</td> <td>-2291.566</td> <td>-2207.982</td>
</tr>
<tr>
  <th>time</th>      <td>    1.3075</td> <td>    0.011</td> <td>  121.634</td> <td> 0.000</td> <td>    1.286</td> <td>    1.329</td>
</tr>
</table>
<table class="simpletable">
<tr>
  <th>Omnibus:</th>       <td>15.857</td> <th>  Durbin-Watson:     </th> <td>   0.212</td>
</tr>
<tr>
  <th>Prob(Omnibus):</th> <td> 0.000</td> <th>  Jarque-Bera (JB):  </th> <td>   7.798</td>
</tr>
<tr>
  <th>Skew:</th>          <td> 0.048</td> <th>  Prob(JB):          </th> <td>  0.0203</td>
</tr>
<tr>
  <th>Kurtosis:</th>      <td> 2.375</td> <th>  Cond. No.          </th> <td>3.48e+05</td>
</tr>
</table><br/><br/>Warnings:<br/>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.<br/>[2] The condition number is large, 3.48e+05. This might indicate that there are<br/>strong multicollinearity or other numerical problems.</div><img alt="../_images/3_Algorithms_ML_TS_Linear_24_3.png" src="../_images/3_Algorithms_ML_TS_Linear_24_3.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 데이터 확인 및 추세 추정 (비선형)</span>
<span class="n">display</span><span class="p">(</span><span class="n">raw</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">raw</span><span class="o">.</span><span class="n">time</span><span class="p">,</span> <span class="n">raw</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">result</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">OLS</span><span class="o">.</span><span class="n">from_formula</span><span class="p">(</span><span class="n">formula</span><span class="o">=</span><span class="s1">&#39;value~time+I(time**2)&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">raw</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">display</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>

<span class="n">trend</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">result</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">raw</span><span class="o">.</span><span class="n">time</span> <span class="o">+</span> <span class="n">result</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="n">raw</span><span class="o">.</span><span class="n">time</span><span class="o">**</span><span class="mi">2</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">raw</span><span class="o">.</span><span class="n">time</span><span class="p">,</span> <span class="n">raw</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">raw</span><span class="o">.</span><span class="n">time</span><span class="p">,</span> <span class="n">trend</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>time</th>
      <th>value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1,959.00</td>
      <td>315.42</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1,959.08</td>
      <td>316.31</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1,959.17</td>
      <td>316.50</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1,959.25</td>
      <td>317.56</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1,959.33</td>
      <td>318.13</td>
    </tr>
  </tbody>
</table>
</div></div><img alt="../_images/3_Algorithms_ML_TS_Linear_25_1.png" src="../_images/3_Algorithms_ML_TS_Linear_25_1.png" />
<div class="output text_html"><table class="simpletable">
<caption>OLS Regression Results</caption>
<tr>
  <th>Dep. Variable:</th>          <td>value</td>      <th>  R-squared:         </th> <td>   0.979</td> 
</tr>
<tr>
  <th>Model:</th>                   <td>OLS</td>       <th>  Adj. R-squared:    </th> <td>   0.979</td> 
</tr>
<tr>
  <th>Method:</th>             <td>Least Squares</td>  <th>  F-statistic:       </th> <td>1.075e+04</td>
</tr>
<tr>
  <th>Date:</th>             <td>Fri, 31 Jul 2020</td> <th>  Prob (F-statistic):</th>  <td>  0.00</td>  
</tr>
<tr>
  <th>Time:</th>                 <td>22:45:20</td>     <th>  Log-Likelihood:    </th> <td> -1027.8</td> 
</tr>
<tr>
  <th>No. Observations:</th>      <td>   468</td>      <th>  AIC:               </th> <td>   2062.</td> 
</tr>
<tr>
  <th>Df Residuals:</th>          <td>   465</td>      <th>  BIC:               </th> <td>   2074.</td> 
</tr>
<tr>
  <th>Df Model:</th>              <td>     2</td>      <th>                     </th>     <td> </td>    
</tr>
<tr>
  <th>Covariance Type:</th>      <td>nonrobust</td>    <th>                     </th>     <td> </td>    
</tr>
</table>
<table class="simpletable">
<tr>
        <td></td>          <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>Intercept</th>    <td>  4.77e+04</td> <td> 3482.902</td> <td>   13.696</td> <td> 0.000</td> <td> 4.09e+04</td> <td> 5.45e+04</td>
</tr>
<tr>
  <th>time</th>         <td>  -49.1907</td> <td>    3.521</td> <td>  -13.971</td> <td> 0.000</td> <td>  -56.110</td> <td>  -42.272</td>
</tr>
<tr>
  <th>I(time ** 2)</th> <td>    0.0128</td> <td>    0.001</td> <td>   14.342</td> <td> 0.000</td> <td>    0.011</td> <td>    0.015</td>
</tr>
</table>
<table class="simpletable">
<tr>
  <th>Omnibus:</th>       <td>66.659</td> <th>  Durbin-Watson:     </th> <td>   0.306</td>
</tr>
<tr>
  <th>Prob(Omnibus):</th> <td> 0.000</td> <th>  Jarque-Bera (JB):  </th> <td>  17.850</td>
</tr>
<tr>
  <th>Skew:</th>          <td>-0.116</td> <th>  Prob(JB):          </th> <td>0.000133</td>
</tr>
<tr>
  <th>Kurtosis:</th>      <td> 2.072</td> <th>  Cond. No.          </th> <td>1.35e+11</td>
</tr>
</table><br/><br/>Warnings:<br/>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.<br/>[2] The condition number is large, 1.35e+11. This might indicate that there are<br/>strong multicollinearity or other numerical problems.</div><img alt="../_images/3_Algorithms_ML_TS_Linear_25_3.png" src="../_images/3_Algorithms_ML_TS_Linear_25_3.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 추세 제거 및 정상성 확인</span>
<span class="c1">## 방법1</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">raw</span><span class="o">.</span><span class="n">time</span><span class="p">,</span> <span class="n">result</span><span class="o">.</span><span class="n">resid</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">display</span><span class="p">(</span><span class="n">stationarity_adf_test</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">resid</span><span class="p">,</span> <span class="p">[]))</span>
<span class="n">display</span><span class="p">(</span><span class="n">stationarity_kpss_test</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">resid</span><span class="p">,</span> <span class="p">[]))</span>

<span class="n">sm</span><span class="o">.</span><span class="n">graphics</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">plot_acf</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">resid</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">use_vlines</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/3_Algorithms_ML_TS_Linear_26_0.png" src="../_images/3_Algorithms_ML_TS_Linear_26_0.png" />
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Stationarity_adf</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Test Statistics</th>
      <td>-2.53</td>
    </tr>
    <tr>
      <th>p-value</th>
      <td>0.11</td>
    </tr>
    <tr>
      <th>Used Lag</th>
      <td>13.00</td>
    </tr>
    <tr>
      <th>Used Observations</th>
      <td>454.00</td>
    </tr>
    <tr>
      <th>Critical Value(1%)</th>
      <td>-3.44</td>
    </tr>
    <tr>
      <th>Maximum Information Criteria</th>
      <td>260.10</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Stationarity_kpss</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Test Statistics</th>
      <td>0.17</td>
    </tr>
    <tr>
      <th>p-value</th>
      <td>0.10</td>
    </tr>
    <tr>
      <th>Used Lag</th>
      <td>18.00</td>
    </tr>
    <tr>
      <th>Critical Value(10%)</th>
      <td>0.35</td>
    </tr>
  </tbody>
</table>
</div></div><img alt="../_images/3_Algorithms_ML_TS_Linear_26_3.png" src="../_images/3_Algorithms_ML_TS_Linear_26_3.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 추세 제거 및 정상성 확인</span>
<span class="c1">## 방법2</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">raw</span><span class="o">.</span><span class="n">time</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">raw</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">dropna</span><span class="p">())</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">display</span><span class="p">(</span><span class="n">stationarity_adf_test</span><span class="p">(</span><span class="n">raw</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">dropna</span><span class="p">(),</span> <span class="p">[]))</span>
<span class="n">display</span><span class="p">(</span><span class="n">stationarity_kpss_test</span><span class="p">(</span><span class="n">raw</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">dropna</span><span class="p">(),</span> <span class="p">[]))</span>

<span class="n">sm</span><span class="o">.</span><span class="n">graphics</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">plot_acf</span><span class="p">(</span><span class="n">raw</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">dropna</span><span class="p">(),</span> <span class="n">lags</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">use_vlines</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/3_Algorithms_ML_TS_Linear_27_0.png" src="../_images/3_Algorithms_ML_TS_Linear_27_0.png" />
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Stationarity_adf</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Test Statistics</th>
      <td>-5.14</td>
    </tr>
    <tr>
      <th>p-value</th>
      <td>0.00</td>
    </tr>
    <tr>
      <th>Used Lag</th>
      <td>12.00</td>
    </tr>
    <tr>
      <th>Used Observations</th>
      <td>454.00</td>
    </tr>
    <tr>
      <th>Critical Value(1%)</th>
      <td>-3.44</td>
    </tr>
    <tr>
      <th>Maximum Information Criteria</th>
      <td>271.87</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Stationarity_kpss</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Test Statistics</th>
      <td>0.04</td>
    </tr>
    <tr>
      <th>p-value</th>
      <td>0.10</td>
    </tr>
    <tr>
      <th>Used Lag</th>
      <td>18.00</td>
    </tr>
    <tr>
      <th>Critical Value(10%)</th>
      <td>0.35</td>
    </tr>
  </tbody>
</table>
</div></div><img alt="../_images/3_Algorithms_ML_TS_Linear_27_3.png" src="../_images/3_Algorithms_ML_TS_Linear_27_3.png" />
</div>
</div>
</div>
<div class="section" id="id8">
<h3>실습: 호흡기질환 사망자수 계절성 제거<a class="headerlink" href="#id8" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 라이브러리 및 데이터 로딩</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">statsmodels</span> <span class="kn">import</span> <span class="n">datasets</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="nn">sm</span>
<span class="o">%</span><span class="k">reload_ext</span> autoreload
<span class="o">%</span><span class="k">autoreload</span> 2
<span class="kn">from</span> <span class="nn">module</span> <span class="kn">import</span> <span class="n">stationarity_adf_test</span><span class="p">,</span> <span class="n">stationarity_kpss_test</span>

<span class="n">raw_set</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">get_rdataset</span><span class="p">(</span><span class="s2">&quot;deaths&quot;</span><span class="p">,</span> <span class="n">package</span><span class="o">=</span><span class="s2">&quot;MASS&quot;</span><span class="p">)</span>
<span class="n">raw</span> <span class="o">=</span> <span class="n">raw_set</span><span class="o">.</span><span class="n">data</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 시간변수 추출</span>
<span class="n">raw</span><span class="o">.</span><span class="n">time</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s1">&#39;1974-01-01&#39;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">raw</span><span class="p">),</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;M&#39;</span><span class="p">)</span>
<span class="n">raw</span><span class="p">[</span><span class="s1">&#39;month&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">raw</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">month</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 데이터 확인 및 추세 추정</span>
<span class="n">display</span><span class="p">(</span><span class="n">raw</span><span class="o">.</span><span class="n">tail</span><span class="p">())</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">raw</span><span class="o">.</span><span class="n">time</span><span class="p">,</span> <span class="n">raw</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">display</span><span class="p">(</span><span class="n">stationarity_adf_test</span><span class="p">(</span><span class="n">raw</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="p">[]))</span>
<span class="n">display</span><span class="p">(</span><span class="n">stationarity_kpss_test</span><span class="p">(</span><span class="n">raw</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="p">[]))</span>
<span class="n">sm</span><span class="o">.</span><span class="n">graphics</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">plot_acf</span><span class="p">(</span><span class="n">raw</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">use_vlines</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;ACF&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">result</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">OLS</span><span class="o">.</span><span class="n">from_formula</span><span class="p">(</span><span class="n">formula</span><span class="o">=</span><span class="s1">&#39;value ~ C(month) - 1&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">raw</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">display</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">raw</span><span class="o">.</span><span class="n">time</span><span class="p">,</span> <span class="n">raw</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">raw</span><span class="o">.</span><span class="n">time</span><span class="p">,</span> <span class="n">result</span><span class="o">.</span><span class="n">fittedvalues</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>time</th>
      <th>value</th>
      <th>month</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>67</th>
      <td>1979-08-31</td>
      <td>1354</td>
      <td>8</td>
    </tr>
    <tr>
      <th>68</th>
      <td>1979-09-30</td>
      <td>1333</td>
      <td>9</td>
    </tr>
    <tr>
      <th>69</th>
      <td>1979-10-31</td>
      <td>1492</td>
      <td>10</td>
    </tr>
    <tr>
      <th>70</th>
      <td>1979-11-30</td>
      <td>1781</td>
      <td>11</td>
    </tr>
    <tr>
      <th>71</th>
      <td>1979-12-31</td>
      <td>1915</td>
      <td>12</td>
    </tr>
  </tbody>
</table>
</div></div><img alt="../_images/3_Algorithms_ML_TS_Linear_31_1.png" src="../_images/3_Algorithms_ML_TS_Linear_31_1.png" />
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Stationarity_adf</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Test Statistics</th>
      <td>-0.57</td>
    </tr>
    <tr>
      <th>p-value</th>
      <td>0.88</td>
    </tr>
    <tr>
      <th>Used Lag</th>
      <td>12.00</td>
    </tr>
    <tr>
      <th>Used Observations</th>
      <td>59.00</td>
    </tr>
    <tr>
      <th>Critical Value(1%)</th>
      <td>-3.55</td>
    </tr>
    <tr>
      <th>Maximum Information Criteria</th>
      <td>841.38</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Stationarity_kpss</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Test Statistics</th>
      <td>0.65</td>
    </tr>
    <tr>
      <th>p-value</th>
      <td>0.02</td>
    </tr>
    <tr>
      <th>Used Lag</th>
      <td>12.00</td>
    </tr>
    <tr>
      <th>Critical Value(10%)</th>
      <td>0.35</td>
    </tr>
  </tbody>
</table>
</div></div><img alt="../_images/3_Algorithms_ML_TS_Linear_31_4.png" src="../_images/3_Algorithms_ML_TS_Linear_31_4.png" />
<div class="output text_html"><table class="simpletable">
<caption>OLS Regression Results</caption>
<tr>
  <th>Dep. Variable:</th>          <td>value</td>      <th>  R-squared:         </th> <td>   0.853</td>
</tr>
<tr>
  <th>Model:</th>                   <td>OLS</td>       <th>  Adj. R-squared:    </th> <td>   0.826</td>
</tr>
<tr>
  <th>Method:</th>             <td>Least Squares</td>  <th>  F-statistic:       </th> <td>   31.66</td>
</tr>
<tr>
  <th>Date:</th>             <td>Fri, 31 Jul 2020</td> <th>  Prob (F-statistic):</th> <td>6.55e-21</td>
</tr>
<tr>
  <th>Time:</th>                 <td>22:45:23</td>     <th>  Log-Likelihood:    </th> <td> -494.38</td>
</tr>
<tr>
  <th>No. Observations:</th>      <td>    72</td>      <th>  AIC:               </th> <td>   1013.</td>
</tr>
<tr>
  <th>Df Residuals:</th>          <td>    60</td>      <th>  BIC:               </th> <td>   1040.</td>
</tr>
<tr>
  <th>Df Model:</th>              <td>    11</td>      <th>                     </th>     <td> </td>   
</tr>
<tr>
  <th>Covariance Type:</th>      <td>nonrobust</td>    <th>                     </th>     <td> </td>   
</tr>
</table>
<table class="simpletable">
<tr>
        <td></td>          <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>C(month)[1]</th>  <td> 2959.3333</td> <td>  103.831</td> <td>   28.502</td> <td> 0.000</td> <td> 2751.641</td> <td> 3167.025</td>
</tr>
<tr>
  <th>C(month)[2]</th>  <td> 2894.6667</td> <td>  103.831</td> <td>   27.879</td> <td> 0.000</td> <td> 2686.975</td> <td> 3102.359</td>
</tr>
<tr>
  <th>C(month)[3]</th>  <td> 2743.0000</td> <td>  103.831</td> <td>   26.418</td> <td> 0.000</td> <td> 2535.308</td> <td> 2950.692</td>
</tr>
<tr>
  <th>C(month)[4]</th>  <td> 2269.6667</td> <td>  103.831</td> <td>   21.859</td> <td> 0.000</td> <td> 2061.975</td> <td> 2477.359</td>
</tr>
<tr>
  <th>C(month)[5]</th>  <td> 1805.1667</td> <td>  103.831</td> <td>   17.386</td> <td> 0.000</td> <td> 1597.475</td> <td> 2012.859</td>
</tr>
<tr>
  <th>C(month)[6]</th>  <td> 1608.6667</td> <td>  103.831</td> <td>   15.493</td> <td> 0.000</td> <td> 1400.975</td> <td> 1816.359</td>
</tr>
<tr>
  <th>C(month)[7]</th>  <td> 1550.8333</td> <td>  103.831</td> <td>   14.936</td> <td> 0.000</td> <td> 1343.141</td> <td> 1758.525</td>
</tr>
<tr>
  <th>C(month)[8]</th>  <td> 1408.3333</td> <td>  103.831</td> <td>   13.564</td> <td> 0.000</td> <td> 1200.641</td> <td> 1616.025</td>
</tr>
<tr>
  <th>C(month)[9]</th>  <td> 1397.3333</td> <td>  103.831</td> <td>   13.458</td> <td> 0.000</td> <td> 1189.641</td> <td> 1605.025</td>
</tr>
<tr>
  <th>C(month)[10]</th> <td> 1690.0000</td> <td>  103.831</td> <td>   16.277</td> <td> 0.000</td> <td> 1482.308</td> <td> 1897.692</td>
</tr>
<tr>
  <th>C(month)[11]</th> <td> 1874.0000</td> <td>  103.831</td> <td>   18.049</td> <td> 0.000</td> <td> 1666.308</td> <td> 2081.692</td>
</tr>
<tr>
  <th>C(month)[12]</th> <td> 2478.5000</td> <td>  103.831</td> <td>   23.871</td> <td> 0.000</td> <td> 2270.808</td> <td> 2686.192</td>
</tr>
</table>
<table class="simpletable">
<tr>
  <th>Omnibus:</th>       <td>19.630</td> <th>  Durbin-Watson:     </th> <td>   1.374</td>
</tr>
<tr>
  <th>Prob(Omnibus):</th> <td> 0.000</td> <th>  Jarque-Bera (JB):  </th> <td>  49.630</td>
</tr>
<tr>
  <th>Skew:</th>          <td> 0.787</td> <th>  Prob(JB):          </th> <td>1.67e-11</td>
</tr>
<tr>
  <th>Kurtosis:</th>      <td> 6.750</td> <th>  Cond. No.          </th> <td>    1.00</td>
</tr>
</table><br/><br/>Warnings:<br/>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.</div><img alt="../_images/3_Algorithms_ML_TS_Linear_31_6.png" src="../_images/3_Algorithms_ML_TS_Linear_31_6.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 추세 제거 및 정상성 확인</span>
<span class="c1">## 방법1</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">raw</span><span class="o">.</span><span class="n">time</span><span class="p">,</span> <span class="n">result</span><span class="o">.</span><span class="n">resid</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">display</span><span class="p">(</span><span class="n">stationarity_adf_test</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">resid</span><span class="p">,</span> <span class="p">[]))</span>
<span class="n">display</span><span class="p">(</span><span class="n">stationarity_kpss_test</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">resid</span><span class="p">,</span> <span class="p">[]))</span>
<span class="n">sm</span><span class="o">.</span><span class="n">graphics</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">plot_acf</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">resid</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">use_vlines</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/3_Algorithms_ML_TS_Linear_32_0.png" src="../_images/3_Algorithms_ML_TS_Linear_32_0.png" />
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Stationarity_adf</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Test Statistics</th>
      <td>-5.84</td>
    </tr>
    <tr>
      <th>p-value</th>
      <td>0.00</td>
    </tr>
    <tr>
      <th>Used Lag</th>
      <td>0.00</td>
    </tr>
    <tr>
      <th>Used Observations</th>
      <td>71.00</td>
    </tr>
    <tr>
      <th>Critical Value(1%)</th>
      <td>-3.53</td>
    </tr>
    <tr>
      <th>Maximum Information Criteria</th>
      <td>812.36</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Stationarity_kpss</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Test Statistics</th>
      <td>0.54</td>
    </tr>
    <tr>
      <th>p-value</th>
      <td>0.03</td>
    </tr>
    <tr>
      <th>Used Lag</th>
      <td>12.00</td>
    </tr>
    <tr>
      <th>Critical Value(10%)</th>
      <td>0.35</td>
    </tr>
  </tbody>
</table>
</div></div><img alt="../_images/3_Algorithms_ML_TS_Linear_32_3.png" src="../_images/3_Algorithms_ML_TS_Linear_32_3.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 계절성 제거 및 정상성 확인</span>
<span class="c1">## 방법2</span>
<span class="n">sm</span><span class="o">.</span><span class="n">graphics</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">plot_acf</span><span class="p">(</span><span class="n">raw</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">use_vlines</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">raw</span><span class="o">.</span><span class="n">time</span><span class="p">,</span> <span class="n">raw</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Raw&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">seasonal_lag</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">raw</span><span class="o">.</span><span class="n">time</span><span class="p">[</span><span class="n">seasonal_lag</span><span class="p">:],</span> <span class="n">raw</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">seasonal_lag</span><span class="p">)</span><span class="o">.</span><span class="n">dropna</span><span class="p">(),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Lag</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">seasonal_lag</span><span class="p">))</span>
<span class="n">seasonal_lag</span> <span class="o">=</span> <span class="mi">6</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">raw</span><span class="o">.</span><span class="n">time</span><span class="p">[</span><span class="n">seasonal_lag</span><span class="p">:],</span> <span class="n">raw</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">seasonal_lag</span><span class="p">)</span><span class="o">.</span><span class="n">dropna</span><span class="p">(),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Lag</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">seasonal_lag</span><span class="p">))</span>
<span class="n">seasonal_lag</span> <span class="o">=</span> <span class="mi">12</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">raw</span><span class="o">.</span><span class="n">time</span><span class="p">[</span><span class="n">seasonal_lag</span><span class="p">:],</span> <span class="n">raw</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">seasonal_lag</span><span class="p">)</span><span class="o">.</span><span class="n">dropna</span><span class="p">(),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Lag</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">seasonal_lag</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Lagged&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">seasonal_lag</span> <span class="o">=</span> <span class="mi">6</span>
<span class="n">display</span><span class="p">(</span><span class="n">stationarity_adf_test</span><span class="p">(</span><span class="n">raw</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">seasonal_lag</span><span class="p">)</span><span class="o">.</span><span class="n">dropna</span><span class="p">(),</span> <span class="p">[]))</span>
<span class="n">display</span><span class="p">(</span><span class="n">stationarity_kpss_test</span><span class="p">(</span><span class="n">raw</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">seasonal_lag</span><span class="p">)</span><span class="o">.</span><span class="n">dropna</span><span class="p">(),</span> <span class="p">[]))</span>
<span class="n">sm</span><span class="o">.</span><span class="n">graphics</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">plot_acf</span><span class="p">(</span><span class="n">raw</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">seasonal_lag</span><span class="p">)</span><span class="o">.</span><span class="n">dropna</span><span class="p">(),</span> <span class="n">lags</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> 
                         <span class="n">use_vlines</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;ACF of Lag</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">seasonal_lag</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">seasonal_lag</span> <span class="o">=</span> <span class="mi">12</span>
<span class="n">display</span><span class="p">(</span><span class="n">stationarity_adf_test</span><span class="p">(</span><span class="n">raw</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">seasonal_lag</span><span class="p">)</span><span class="o">.</span><span class="n">dropna</span><span class="p">(),</span> <span class="p">[]))</span>
<span class="n">display</span><span class="p">(</span><span class="n">stationarity_kpss_test</span><span class="p">(</span><span class="n">raw</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">seasonal_lag</span><span class="p">)</span><span class="o">.</span><span class="n">dropna</span><span class="p">(),</span> <span class="p">[]))</span>
<span class="n">sm</span><span class="o">.</span><span class="n">graphics</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">plot_acf</span><span class="p">(</span><span class="n">raw</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">seasonal_lag</span><span class="p">)</span><span class="o">.</span><span class="n">dropna</span><span class="p">(),</span> <span class="n">lags</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> 
                         <span class="n">use_vlines</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;ACF of Lag</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">seasonal_lag</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/3_Algorithms_ML_TS_Linear_33_0.png" src="../_images/3_Algorithms_ML_TS_Linear_33_0.png" />
<img alt="../_images/3_Algorithms_ML_TS_Linear_33_1.png" src="../_images/3_Algorithms_ML_TS_Linear_33_1.png" />
<img alt="../_images/3_Algorithms_ML_TS_Linear_33_2.png" src="../_images/3_Algorithms_ML_TS_Linear_33_2.png" />
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Stationarity_adf</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Test Statistics</th>
      <td>-4.30</td>
    </tr>
    <tr>
      <th>p-value</th>
      <td>0.00</td>
    </tr>
    <tr>
      <th>Used Lag</th>
      <td>11.00</td>
    </tr>
    <tr>
      <th>Used Observations</th>
      <td>54.00</td>
    </tr>
    <tr>
      <th>Critical Value(1%)</th>
      <td>-3.56</td>
    </tr>
    <tr>
      <th>Maximum Information Criteria</th>
      <td>786.67</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Stationarity_kpss</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Test Statistics</th>
      <td>0.35</td>
    </tr>
    <tr>
      <th>p-value</th>
      <td>0.10</td>
    </tr>
    <tr>
      <th>Used Lag</th>
      <td>11.00</td>
    </tr>
    <tr>
      <th>Critical Value(10%)</th>
      <td>0.35</td>
    </tr>
  </tbody>
</table>
</div></div><img alt="../_images/3_Algorithms_ML_TS_Linear_33_5.png" src="../_images/3_Algorithms_ML_TS_Linear_33_5.png" />
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Stationarity_adf</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Test Statistics</th>
      <td>-2.14</td>
    </tr>
    <tr>
      <th>p-value</th>
      <td>0.23</td>
    </tr>
    <tr>
      <th>Used Lag</th>
      <td>11.00</td>
    </tr>
    <tr>
      <th>Used Observations</th>
      <td>48.00</td>
    </tr>
    <tr>
      <th>Critical Value(1%)</th>
      <td>-3.57</td>
    </tr>
    <tr>
      <th>Maximum Information Criteria</th>
      <td>703.72</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Stationarity_kpss</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Test Statistics</th>
      <td>0.09</td>
    </tr>
    <tr>
      <th>p-value</th>
      <td>0.10</td>
    </tr>
    <tr>
      <th>Used Lag</th>
      <td>11.00</td>
    </tr>
    <tr>
      <th>Critical Value(10%)</th>
      <td>0.35</td>
    </tr>
  </tbody>
</table>
</div></div><img alt="../_images/3_Algorithms_ML_TS_Linear_33_8.png" src="../_images/3_Algorithms_ML_TS_Linear_33_8.png" />
</div>
</div>
</div>
<div class="section" id="id9">
<h3>실습: 랜덤워크의 정상성 변환<a class="headerlink" href="#id9" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 라이브러리 호출</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="nn">sm</span>
<span class="kn">from</span> <span class="nn">random</span> <span class="kn">import</span> <span class="n">seed</span><span class="p">,</span> <span class="n">random</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="o">%</span><span class="k">reload_ext</span> autoreload
<span class="o">%</span><span class="k">autoreload</span> 2
<span class="kn">from</span> <span class="nn">module</span> <span class="kn">import</span> <span class="n">stationarity_adf_test</span><span class="p">,</span> <span class="n">stationarity_kpss_test</span>

<span class="c1"># 랜덤워크 데이터 생성</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">seed</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">random_walk</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span> <span class="k">if</span> <span class="n">random</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mf">0.5</span> <span class="k">else</span> <span class="mi">1</span><span class="p">]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1000</span><span class="p">):</span>
    <span class="n">movement</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span> <span class="k">if</span> <span class="n">random</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mf">0.5</span> <span class="k">else</span> <span class="mi">1</span>
    <span class="n">value</span> <span class="o">=</span> <span class="n">random_walk</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">movement</span>
    <span class="n">random_walk</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">random_walk</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># 차분 전 랜덤워크 정상성 테스트</span>
<span class="n">display</span><span class="p">(</span><span class="s1">&#39;Before a difference:&#39;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">stationarity_adf_test</span><span class="p">(</span><span class="n">random_walk</span><span class="p">,</span> <span class="p">[]))</span>
<span class="n">display</span><span class="p">(</span><span class="n">stationarity_kpss_test</span><span class="p">(</span><span class="n">random_walk</span><span class="p">,</span> <span class="p">[]))</span>
<span class="n">sm</span><span class="o">.</span><span class="n">graphics</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">plot_acf</span><span class="p">(</span><span class="n">random_walk</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">use_vlines</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># 차분 후 랜덤워크 정상성 테스트</span>
<span class="n">display</span><span class="p">(</span><span class="s1">&#39;After a difference:&#39;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">stationarity_adf_test</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">random_walk</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">dropna</span><span class="p">(),</span> <span class="p">[]))</span>
<span class="n">display</span><span class="p">(</span><span class="n">stationarity_kpss_test</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">random_walk</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">dropna</span><span class="p">(),</span> <span class="p">[]))</span>
<span class="n">sm</span><span class="o">.</span><span class="n">graphics</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">plot_acf</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">random_walk</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">dropna</span><span class="p">(),</span> <span class="n">lags</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">use_vlines</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/3_Algorithms_ML_TS_Linear_35_0.png" src="../_images/3_Algorithms_ML_TS_Linear_35_0.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;Before a difference:&#39;
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Stationarity_adf</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Test Statistics</th>
      <td>0.34</td>
    </tr>
    <tr>
      <th>p-value</th>
      <td>0.98</td>
    </tr>
    <tr>
      <th>Used Lag</th>
      <td>0.00</td>
    </tr>
    <tr>
      <th>Used Observations</th>
      <td>999.00</td>
    </tr>
    <tr>
      <th>Critical Value(1%)</th>
      <td>-3.44</td>
    </tr>
    <tr>
      <th>Maximum Information Criteria</th>
      <td>2,773.39</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Stationarity_kpss</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Test Statistics</th>
      <td>3.75</td>
    </tr>
    <tr>
      <th>p-value</th>
      <td>0.01</td>
    </tr>
    <tr>
      <th>Used Lag</th>
      <td>22.00</td>
    </tr>
    <tr>
      <th>Critical Value(10%)</th>
      <td>0.35</td>
    </tr>
  </tbody>
</table>
</div></div><img alt="../_images/3_Algorithms_ML_TS_Linear_35_4.png" src="../_images/3_Algorithms_ML_TS_Linear_35_4.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;After a difference:&#39;
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Stationarity_adf</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Test Statistics</th>
      <td>-31.08</td>
    </tr>
    <tr>
      <th>p-value</th>
      <td>0.00</td>
    </tr>
    <tr>
      <th>Used Lag</th>
      <td>0.00</td>
    </tr>
    <tr>
      <th>Used Observations</th>
      <td>998.00</td>
    </tr>
    <tr>
      <th>Critical Value(1%)</th>
      <td>-3.44</td>
    </tr>
    <tr>
      <th>Maximum Information Criteria</th>
      <td>2,770.18</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Stationarity_kpss</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Test Statistics</th>
      <td>0.22</td>
    </tr>
    <tr>
      <th>p-value</th>
      <td>0.10</td>
    </tr>
    <tr>
      <th>Used Lag</th>
      <td>22.00</td>
    </tr>
    <tr>
      <th>Critical Value(10%)</th>
      <td>0.35</td>
    </tr>
  </tbody>
</table>
</div></div><img alt="../_images/3_Algorithms_ML_TS_Linear_35_8.png" src="../_images/3_Algorithms_ML_TS_Linear_35_8.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 랜덤워크 데이터 생성 및 통계량 Test</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">seed</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">rho</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">random_walk</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span> <span class="k">if</span> <span class="n">random</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mf">0.5</span> <span class="k">else</span> <span class="mi">1</span><span class="p">]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1000</span><span class="p">):</span>
    <span class="n">movement</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span> <span class="k">if</span> <span class="n">random</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mf">0.5</span> <span class="k">else</span> <span class="mi">1</span>
    <span class="n">value</span> <span class="o">=</span> <span class="n">rho</span> <span class="o">*</span> <span class="n">random_walk</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">movement</span>
    <span class="n">random_walk</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">random_walk</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Rho: </span><span class="si">{}</span><span class="se">\n</span><span class="s1"> ADF p-value: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">stationarity_adf_test</span><span class="p">(</span><span class="n">random_walk</span><span class="p">,</span> <span class="p">[]))[</span><span class="mi">1</span><span class="p">]))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># rho 값을 변화시키면서 언제 비정상이 되는지 파악?</span>
<span class="c1"># 정상성의 계수 범위 추론 가능!</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/3_Algorithms_ML_TS_Linear_36_0.png" src="../_images/3_Algorithms_ML_TS_Linear_36_0.png" />
</div>
</div>
</div>
<div class="section" id="log-box-cox">
<h3>실습: 항공사 승객수요 스케일 변환(Log / Box-Cox)<a class="headerlink" href="#log-box-cox" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 라이브러리 호출</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="nn">sm</span>
<span class="kn">import</span> <span class="nn">scipy</span> <span class="k">as</span> <span class="nn">sp</span>
<span class="o">%</span><span class="k">reload_ext</span> autoreload
<span class="o">%</span><span class="k">autoreload</span> 2
<span class="kn">from</span> <span class="nn">module</span> <span class="kn">import</span> <span class="n">stationarity_adf_test</span><span class="p">,</span> <span class="n">stationarity_kpss_test</span>

<span class="c1"># 데이터 준비</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">get_rdataset</span><span class="p">(</span><span class="s2">&quot;AirPassengers&quot;</span><span class="p">)</span>
<span class="n">raw</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="c1"># Box-Cox 변환 모수 추정</span>
<span class="c1"># 정규분포의 특정 범위(x)에서 lambda를 바꿔가며 정규성(measure:y)이 가장 높은 lambda(l_opt)를 선정</span>
<span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">boxcox_normplot</span><span class="p">(</span><span class="n">raw</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">la</span><span class="o">=-</span><span class="mi">3</span><span class="p">,</span> <span class="n">lb</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">y_transfer</span><span class="p">,</span> <span class="n">l_opt</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">boxcox</span><span class="p">(</span><span class="n">raw</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Optimal Lambda: &#39;</span><span class="p">,</span> <span class="n">l_opt</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">l_opt</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Optimal Lambda:  0.14802265137037945
</pre></div>
</div>
<img alt="../_images/3_Algorithms_ML_TS_Linear_38_1.png" src="../_images/3_Algorithms_ML_TS_Linear_38_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="n">sm</span><span class="o">.</span><span class="n">qqplot</span><span class="p">(</span><span class="n">raw</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">fit</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">line</span><span class="o">=</span><span class="s1">&#39;45&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">131</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Y&#39;</span><span class="p">)</span>
<span class="n">sm</span><span class="o">.</span><span class="n">qqplot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">raw</span><span class="o">.</span><span class="n">value</span><span class="p">),</span> <span class="n">fit</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">line</span><span class="o">=</span><span class="s1">&#39;45&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">132</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Log(Y)&#39;</span><span class="p">)</span>
<span class="n">sm</span><span class="o">.</span><span class="n">qqplot</span><span class="p">(</span><span class="n">y_transfer</span><span class="p">,</span> <span class="n">fit</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">line</span><span class="o">=</span><span class="s1">&#39;45&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">133</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;BoxCox(Y)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/3_Algorithms_ML_TS_Linear_39_0.png" src="../_images/3_Algorithms_ML_TS_Linear_39_0.png" />
</div>
</div>
</div>
<div class="section" id="id10">
<h3>실습: 항공사 승객수요 정상성 변환<a class="headerlink" href="#id10" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 라이브러리 호출</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="nn">sm</span>
<span class="o">%</span><span class="k">reload_ext</span> autoreload
<span class="o">%</span><span class="k">autoreload</span> 2
<span class="kn">from</span> <span class="nn">module</span> <span class="kn">import</span> <span class="n">stationarity_adf_test</span><span class="p">,</span> <span class="n">stationarity_kpss_test</span>

<span class="c1"># 데이터 준비</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">get_rdataset</span><span class="p">(</span><span class="s2">&quot;AirPassengers&quot;</span><span class="p">)</span>
<span class="n">raw</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="c1"># 데이터 전처리</span>
<span class="c1">## 시간 인덱싱</span>
<span class="k">if</span> <span class="s1">&#39;time&#39;</span> <span class="ow">in</span> <span class="n">raw</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
    <span class="n">raw</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="s1">&#39;1/1/1949&#39;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">raw</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]),</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;M&#39;</span><span class="p">)</span>
    <span class="k">del</span> <span class="n">raw</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span>

<span class="c1">## 정상성 확보</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="n">raw</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">221</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">raw</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">222</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;log(Y)&#39;</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">raw</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">223</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;diff1(Y)&#39;</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">raw</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">224</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;diff1(log(Y))&#39;</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/3_Algorithms_ML_TS_Linear_41_0.png" src="../_images/3_Algorithms_ML_TS_Linear_41_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## 정상성 테스트</span>
<span class="c1">### 미변환</span>
<span class="n">display</span><span class="p">(</span><span class="s1">&#39;Non-transfer:&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="n">raw</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">222</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">candidate_none</span> <span class="o">=</span> <span class="n">raw</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">display</span><span class="p">(</span><span class="n">stationarity_adf_test</span><span class="p">(</span><span class="n">candidate_none</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="p">[]))</span>
<span class="n">display</span><span class="p">(</span><span class="n">stationarity_kpss_test</span><span class="p">(</span><span class="n">candidate_none</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="p">[]))</span>
<span class="n">sm</span><span class="o">.</span><span class="n">graphics</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">plot_acf</span><span class="p">(</span><span class="n">candidate_none</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">use_vlines</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1">### 로그 변환</span>
<span class="n">display</span><span class="p">(</span><span class="s1">&#39;Log transfer:&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">raw</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">222</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;log(Y)&#39;</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">candidate_trend</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">raw</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">display</span><span class="p">(</span><span class="n">stationarity_adf_test</span><span class="p">(</span><span class="n">candidate_trend</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="p">[]))</span>
<span class="n">display</span><span class="p">(</span><span class="n">stationarity_kpss_test</span><span class="p">(</span><span class="n">candidate_trend</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="p">[]))</span>
<span class="n">sm</span><span class="o">.</span><span class="n">graphics</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">plot_acf</span><span class="p">(</span><span class="n">candidate_trend</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">use_vlines</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">trend_diff_order_initial</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">stationarity_adf_test</span><span class="p">(</span><span class="n">candidate_trend</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="p">[])</span><span class="o">.</span><span class="n">T</span>
<span class="k">if</span> <span class="n">result</span><span class="p">[</span><span class="s1">&#39;p-value&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mf">0.1</span><span class="p">:</span>
    <span class="n">trend_diff_order</span> <span class="o">=</span> <span class="n">trend_diff_order_initial</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">trend_diff_order</span> <span class="o">=</span> <span class="n">trend_diff_order_initial</span> <span class="o">+</span> <span class="mi">1</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Trend Difference: &#39;</span><span class="p">,</span> <span class="n">trend_diff_order</span><span class="p">)</span>

<span class="c1">### 로그+추세차분 변환</span>
<span class="n">display</span><span class="p">(</span><span class="s1">&#39;Log and trend diffrence transfer:&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">raw</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">trend_diff_order</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">224</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;diff1(log(Y))&#39;</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">candidate_seasonal</span> <span class="o">=</span> <span class="n">candidate_trend</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">trend_diff_order</span><span class="p">)</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">display</span><span class="p">(</span><span class="n">stationarity_adf_test</span><span class="p">(</span><span class="n">candidate_seasonal</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="p">[]))</span>
<span class="n">display</span><span class="p">(</span><span class="n">stationarity_kpss_test</span><span class="p">(</span><span class="n">candidate_seasonal</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="p">[]))</span>
<span class="n">sm</span><span class="o">.</span><span class="n">graphics</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">plot_acf</span><span class="p">(</span><span class="n">candidate_seasonal</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">use_vlines</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">seasonal_diff_order</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">acf</span><span class="p">(</span><span class="n">candidate_seasonal</span><span class="p">)[</span><span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">argmax</span><span class="p">()</span> <span class="o">+</span> <span class="mi">1</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Seasonal Difference: &#39;</span><span class="p">,</span> <span class="n">seasonal_diff_order</span><span class="p">)</span>

<span class="c1">### 로그+추세차분+계절차분 변환</span>
<span class="n">display</span><span class="p">(</span><span class="s1">&#39;Log and trend+seasonal diffrence transfer:&#39;</span><span class="p">)</span>
<span class="n">candidate_final</span> <span class="o">=</span> <span class="n">candidate_seasonal</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">seasonal_diff_order</span><span class="p">)</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">display</span><span class="p">(</span><span class="n">stationarity_adf_test</span><span class="p">(</span><span class="n">candidate_final</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="p">[]))</span>
<span class="n">display</span><span class="p">(</span><span class="n">stationarity_kpss_test</span><span class="p">(</span><span class="n">candidate_final</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="p">[]))</span>
<span class="n">sm</span><span class="o">.</span><span class="n">graphics</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">plot_acf</span><span class="p">(</span><span class="n">candidate_final</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">use_vlines</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;Non-transfer:&#39;
</pre></div>
</div>
<img alt="../_images/3_Algorithms_ML_TS_Linear_42_1.png" src="../_images/3_Algorithms_ML_TS_Linear_42_1.png" />
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Stationarity_adf</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Test Statistics</th>
      <td>0.82</td>
    </tr>
    <tr>
      <th>p-value</th>
      <td>0.99</td>
    </tr>
    <tr>
      <th>Used Lag</th>
      <td>13.00</td>
    </tr>
    <tr>
      <th>Used Observations</th>
      <td>130.00</td>
    </tr>
    <tr>
      <th>Critical Value(1%)</th>
      <td>-3.48</td>
    </tr>
    <tr>
      <th>Maximum Information Criteria</th>
      <td>996.69</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Stationarity_kpss</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Test Statistics</th>
      <td>1.05</td>
    </tr>
    <tr>
      <th>p-value</th>
      <td>0.01</td>
    </tr>
    <tr>
      <th>Used Lag</th>
      <td>14.00</td>
    </tr>
    <tr>
      <th>Critical Value(10%)</th>
      <td>0.35</td>
    </tr>
  </tbody>
</table>
</div></div><img alt="../_images/3_Algorithms_ML_TS_Linear_42_4.png" src="../_images/3_Algorithms_ML_TS_Linear_42_4.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;Log transfer:&#39;
</pre></div>
</div>
<img alt="../_images/3_Algorithms_ML_TS_Linear_42_6.png" src="../_images/3_Algorithms_ML_TS_Linear_42_6.png" />
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Stationarity_adf</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Test Statistics</th>
      <td>-1.72</td>
    </tr>
    <tr>
      <th>p-value</th>
      <td>0.42</td>
    </tr>
    <tr>
      <th>Used Lag</th>
      <td>13.00</td>
    </tr>
    <tr>
      <th>Used Observations</th>
      <td>130.00</td>
    </tr>
    <tr>
      <th>Critical Value(1%)</th>
      <td>-3.48</td>
    </tr>
    <tr>
      <th>Maximum Information Criteria</th>
      <td>-445.40</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Stationarity_kpss</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Test Statistics</th>
      <td>1.05</td>
    </tr>
    <tr>
      <th>p-value</th>
      <td>0.01</td>
    </tr>
    <tr>
      <th>Used Lag</th>
      <td>14.00</td>
    </tr>
    <tr>
      <th>Critical Value(10%)</th>
      <td>0.35</td>
    </tr>
  </tbody>
</table>
</div></div><img alt="../_images/3_Algorithms_ML_TS_Linear_42_9.png" src="../_images/3_Algorithms_ML_TS_Linear_42_9.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Trend Difference:  1
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;Log and trend diffrence transfer:&#39;
</pre></div>
</div>
<img alt="../_images/3_Algorithms_ML_TS_Linear_42_12.png" src="../_images/3_Algorithms_ML_TS_Linear_42_12.png" />
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Stationarity_adf</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Test Statistics</th>
      <td>-2.72</td>
    </tr>
    <tr>
      <th>p-value</th>
      <td>0.07</td>
    </tr>
    <tr>
      <th>Used Lag</th>
      <td>14.00</td>
    </tr>
    <tr>
      <th>Used Observations</th>
      <td>128.00</td>
    </tr>
    <tr>
      <th>Critical Value(1%)</th>
      <td>-3.48</td>
    </tr>
    <tr>
      <th>Maximum Information Criteria</th>
      <td>-440.36</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Stationarity_kpss</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Test Statistics</th>
      <td>0.10</td>
    </tr>
    <tr>
      <th>p-value</th>
      <td>0.10</td>
    </tr>
    <tr>
      <th>Used Lag</th>
      <td>14.00</td>
    </tr>
    <tr>
      <th>Critical Value(10%)</th>
      <td>0.35</td>
    </tr>
  </tbody>
</table>
</div></div><img alt="../_images/3_Algorithms_ML_TS_Linear_42_15.png" src="../_images/3_Algorithms_ML_TS_Linear_42_15.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Seasonal Difference:  12
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;Log and trend+seasonal diffrence transfer:&#39;
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Stationarity_adf</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Test Statistics</th>
      <td>-4.44</td>
    </tr>
    <tr>
      <th>p-value</th>
      <td>0.00</td>
    </tr>
    <tr>
      <th>Used Lag</th>
      <td>12.00</td>
    </tr>
    <tr>
      <th>Used Observations</th>
      <td>118.00</td>
    </tr>
    <tr>
      <th>Critical Value(1%)</th>
      <td>-3.49</td>
    </tr>
    <tr>
      <th>Maximum Information Criteria</th>
      <td>-415.56</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Stationarity_kpss</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Test Statistics</th>
      <td>0.11</td>
    </tr>
    <tr>
      <th>p-value</th>
      <td>0.10</td>
    </tr>
    <tr>
      <th>Used Lag</th>
      <td>13.00</td>
    </tr>
    <tr>
      <th>Critical Value(10%)</th>
      <td>0.35</td>
    </tr>
  </tbody>
</table>
</div></div><img alt="../_images/3_Algorithms_ML_TS_Linear_42_20.png" src="../_images/3_Algorithms_ML_TS_Linear_42_20.png" />
</div>
</div>
</div>
</div>
<div class="section" id="general-linear-process">
<h2>일반 선형확률과정(General Linear Process)<a class="headerlink" href="#general-linear-process" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><p><strong>“시계열 데이터가 가우시안 백색잡음의 현재값과 과거값의 선형조합”</strong></p>
</div></blockquote>
<p>\begin{align*}
Y_t = \epsilon_t + \psi_1\epsilon_{t-1} + \psi_2\epsilon_{t-2} + \cdots \
\end{align*}
\begin{align*}
where~\epsilon_i \sim i.i.d.~WN(0, \sigma_{\epsilon_i}^2)~and~\displaystyle \sum_{i=1}^{\infty}\psi_i^2 &lt; \infty
\end{align*}</p>
<ul class="simple">
<li><p><strong>세부 알고리즘:</strong></p>
<ul>
<li><p>WN(White Noise)</p></li>
<li><p>MA(Moving Average)</p></li>
<li><p>AR(Auto-Regressive)</p></li>
<li><p>ARMA(Auto-Regressive Moving Average)</p></li>
<li><p>ARIMA(Auto-Regressive Integrated Moving Average)</p></li>
<li><p>SARIMA(Seasonal ARIMA)</p></li>
</ul>
</li>
</ul>
<div class="section" id="wn-white-noise">
<h3>WN(White Noise)<a class="headerlink" href="#wn-white-noise" title="Permalink to this headline">¶</a></h3>
<center><img src='Image/White_Noise.png' width='300'></center>
<blockquote>
<div><p><strong>1) 잔차들은 정규분포이고, (unbiased) 평균 0과 일정한 분산을 가져야 함:</strong><br />
\begin{align*}
{\epsilon_t : t = \dots, -2, -1, 0, 1, 2, \dots} \sim N(0,\sigma^2_{\epsilon_t}) \
\end{align*}
\begin{align*}
where~~ \epsilon_t \sim  i.i.d(independent~and~identically~distributed) \
\end{align*}
\begin{align*}
\epsilon_t = Y_t - \hat{Y_t}, ;; E(\epsilon_t) = 0, ;; Var(\epsilon_t) = \sigma^2_{\epsilon_t} \
\end{align*}
\begin{align*}
Cov(\epsilon_s, \epsilon_k) = 0~for~different~times!(s \ne k)
\end{align*}</p>
</div></blockquote>
<blockquote>
<div><p><strong>2) 잔차들이 시간의 흐름에 따라 상관성이 없어야 함:</strong></p>
</div></blockquote>
<ul>
<li><p>자기상관함수(Autocorrelation Fundtion(<a class="reference external" href="https://en.wikipedia.org/wiki/Autocorrelation">ACF</a>))를 통해 <span class="math notranslate nohighlight">\(Autocorrelation~=~0\)</span>인지 확인</p>
<ul class="simple">
<li><p>공분산(Covariance):</p></li>
</ul>
  <center>$Cov(Y_s, Y_k)$ = $E[(Y_s-E(Y_s))$$(Y_k-E(Y_k))]$ = $\gamma_{s,k}$</center>
  - 자기상관함수(Autocorrelation Function): 
  <center>$Corr(Y_s, Y_k)$ = $\dfrac{Cov(Y_s, Y_k)}{\sqrt{Var(Y_s)Var(Y_k)}}$ = $\dfrac{\gamma_{s,k}}{\sqrt{\gamma_s \gamma_k}}$</center>
  - 편자기상관함수(Partial Autocorrelation Function): $s$와 $k$사이의 상관성을 제거한 자기상관함수
  <center>$Corr[(Y_s-\hat{Y}_s, Y_{s-t}-\hat{Y}_{s-t})]$ for $1<t<k$</center>
</li>
<li><p><strong>특성요약:</strong></p>
<ul class="simple">
<li><p>강정상 과정(Stictly Stationary Process)</p></li>
<li><p>강정상 예시로 시계열분석 기본알고리즘 중 가장 중요함</p></li>
<li><p>시차(lag)가 0일 경우, 자기공분산은 확률 분포의 분산이 되고 시차가 0이 아닌 경우, 자기공분산은 0.<br />
\begin{align*}
\gamma_i = \begin{cases} \text{Var}(\epsilon_t) &amp; ;; \text{ for } i = 0 \<br />
0 &amp; ;; \text{ for }  i \neq 0 \end{cases}
\end{align*}</p></li>
<li><p>시차(lag)가 0일 경우, 자기상관계수는 1이 되고 시차가 0이 아닌 경우, 자기상관계수는 0.
\begin{align*}
\rho_i = \begin{cases} 1 &amp; ;; \text{ for } i = 0 \<br />
0 &amp; ;; \text{ for }  i \neq 0 \end{cases}
\end{align*}</p></li>
</ul>
</li>
</ul>
<p><strong>1) 예시: 가우시안 백색잡음</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">stats</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">300</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/3_Algorithms_ML_TS_Linear_46_0.png" src="../_images/3_Algorithms_ML_TS_Linear_46_0.png" />
</div>
</div>
<p><strong>2) 예시: 베르누이 백색잡음</strong></p>
<blockquote>
<div><p>백색잡음의 기반 확률분포가 반드시 정규분포일 필요는 없음</p>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">stats</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">samples</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">bernoulli</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span>
<span class="n">plt</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">samples</span><span class="p">)),</span> <span class="n">samples</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/3_Algorithms_ML_TS_Linear_48_0.png" src="../_images/3_Algorithms_ML_TS_Linear_48_0.png" />
</div>
</div>
</div>
<div class="section" id="ma-moving-average">
<h3>MA(Moving Average)<a class="headerlink" href="#ma-moving-average" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><p><strong>“<span class="math notranslate nohighlight">\(MA(q)\)</span>: 알고리즘의 차수(<span class="math notranslate nohighlight">\(q\)</span>)가 유한한 가우시안 백색잡음과정의 선형조합”</strong></p>
</div></blockquote>
<ul class="simple">
<li><p>Exponential Smoothing 내  Moving Average Smoothing은 과거의 Trend-Cycle을 추정하기 위함이고, MA는 미래 값을 예측하기 위함</p></li>
</ul>
<p>\begin{align*}
Y_t &amp;= \epsilon_t + \theta_1\epsilon_{t-1} + \theta_2\epsilon_{t-2} + \cdots + \theta_q\epsilon_{t-q}
\end{align*}
\begin{align*}
where~\epsilon_i \sim i.i.d.~WN(0, \sigma_{\epsilon_i}^2)~and~\displaystyle \sum_{i=1}^{\infty}\theta_i^2 &lt; \infty
\end{align*}
\begin{align*}
Y_t &amp;= \epsilon_t + \theta_1\epsilon_{t-1} + \theta_2\epsilon_{t-2} + \cdots + \theta_q\epsilon_{t-q} \
&amp;= \epsilon_t + \theta_1L\epsilon_t + \theta_2L^2\epsilon_t + \cdots + \theta_qL^q\epsilon_t \
&amp;= (1 + \theta_1L + \theta_2L^2 + \cdots + \theta_qL^q)\epsilon_t \
&amp;= \theta(L)\epsilon_t \
\end{align*}
\begin{align*}
where~\epsilon_{t-1} = L\epsilon_t~and~\epsilon_{t-2} = L^2\epsilon_t$
\end{align*}</p>
<ul class="simple">
<li><p><strong>MA(1):</strong><br />
\begin{align*}
\text{Main Equation} &amp;&amp; Y_t &amp;= \epsilon_t + \theta_1\epsilon_{t-1} \
\text{Expectation}   &amp;&amp; E(Y_t) &amp;= E(\epsilon_t + \theta_1\epsilon_{t-1}) = E(\epsilon_t) + \theta_1E(\epsilon_{t-1}) = 0 \
\text{Variance}   &amp;&amp; Var(Y_t) &amp;= E[(\epsilon_t + \theta_1\epsilon_{t-1})^2] \
&amp;&amp; &amp;= E(\epsilon_t^2) + 2\theta_1E(\epsilon_{t}\epsilon_{t-1}) + \theta_1^2E(\epsilon_{t-1}^2) \
&amp;&amp; &amp;= \sigma_{\epsilon_i}^2 + 2 \theta_1 \cdot 0 + \theta_1^2 \sigma_{\epsilon_i}^2 \
&amp;&amp; &amp;= \sigma_{\epsilon_i}^2 + \theta_1^2\sigma_{\epsilon_i}^2 \
\text{Covariance} &amp;&amp; Cov(Y_t, Y_{t-1}) = \gamma_1 &amp;= \text{E} \left[ (\epsilon_t + \theta_1 \epsilon_{t-1})(\epsilon_{t-1} + \theta_1 \epsilon_{t-2}) \right] \
&amp;&amp; &amp;= E (\epsilon_t \epsilon_{t-1}) + \theta_1 E (\epsilon_t \epsilon_{t-2}) + \theta_1 E (\epsilon_{t-1}^2) + \theta_1^2 E (\epsilon_{t-1} \epsilon_{t-2}) \
&amp;&amp; &amp;= 0 + \theta_1 \cdot 0 + \theta_1 \sigma_{\epsilon_{i}}^2 + \theta_1^2 \cdot 0 \
&amp;&amp; &amp;= \theta_1 \sigma_{\epsilon_{i}}^2   \
&amp;&amp; Cov(Y_t, Y_{t-2}) = \gamma_2 &amp;= \text{E} \left[ (\epsilon_t + \theta_1 \epsilon_{t-1})(\epsilon_{t-2} + \theta_1 \epsilon_{t-3}) \right] \
&amp;&amp; &amp;= E (\epsilon_t \epsilon_{t-2}) + \theta_1 E (\epsilon_t \epsilon_{t-3}) + \theta_1 E (\epsilon_{t-1} \epsilon_{t-2}) + \theta_1^2 E (\epsilon_{t-1} \epsilon_{t-3}) \
&amp;&amp; &amp;= 0 + \theta_1 \cdot 0 + \theta_1 \cdot 0 + \theta_1^2 \cdot 0 \
&amp;&amp; &amp;= 0 \
\text{Autocorrelation} &amp;&amp; Corr(Y_t, Y_{t-1}) = \rho_1 &amp;= \dfrac{\theta_1}{1+\theta_1^2} \
&amp;&amp; Corr(Y_t, Y_{t-i}) = \rho_i &amp;= 0~~for~~i &gt; 1 \
\end{align*}</p></li>
<li><p><strong>MA(2):</strong><br />
\begin{align*}
\text{Main Equation} &amp;&amp; Y_t &amp;= \epsilon_t + \theta_1\epsilon_{t-1} + \theta_2\epsilon_{t-2} \
\text{Expectation}   &amp;&amp; E(Y_t) &amp;= E(\epsilon_t + \theta_1\epsilon_{t-1} + \theta_2\epsilon_{t-2}) = E(\epsilon_t) + \theta_1E(\epsilon_{t-1}) + \theta_2E(\epsilon_{t-2}) = 0 \
\text{Variance}   &amp;&amp; Var(Y_t) &amp;= E[(\epsilon_t + \theta_1\epsilon_{t-1} + \theta_2\epsilon_{t-2})^2] \
&amp;&amp; &amp;= \sigma_{\epsilon_i}^2 + \theta_1^2\sigma_{\epsilon_i}^2 + \theta_2^2\sigma_{\epsilon_i}^2 \
\text{Covariance} &amp;&amp; Cov(Y_t, Y_{t-1}) = \gamma_1 &amp;= \text{E} \left[ (\epsilon_t + \theta_1 \epsilon_{t-1} + \theta_2\epsilon_{t-2})(\epsilon_{t-1} + \theta_1 \epsilon_{t-2} + \theta_2\epsilon_{t-3}) \right] \
&amp;&amp; &amp;= (\theta_1 + \theta_1\theta_2) \sigma_{\epsilon_{i}}^2   \
&amp;&amp; Cov(Y_t, Y_{t-2}) = \gamma_2 &amp;= \text{E} \left[ (\epsilon_t + \theta_1 \epsilon_{t-1} + \theta_2\epsilon_{t-2})(\epsilon_{t-2} + \theta_1 \epsilon_{t-3} + \theta_2\epsilon_{t-4}) \right] \
&amp;&amp; &amp;= \theta_2 \sigma_{\epsilon_{i}}^2   \
&amp;&amp; Cov(Y_t, Y_{t-i}) = \gamma_i &amp;= 0~~for~~i &gt; 2 \
\text{Autocorrelation} &amp;&amp; Corr(Y_t, Y_{t-1}) = \rho_1 &amp;= \dfrac{\theta_1 + \theta_1 \theta_2}{1+\theta_1^2+\theta_2^2} \
&amp;&amp; Corr(Y_t, Y_{t-2}) = \rho_2 &amp;= \dfrac{\theta_2}{1+\theta_1^2+\theta_2^2} \
&amp;&amp; Corr(Y_t, Y_{t-i}) = \rho_i &amp;= 0~~for~~i &gt; 2 \
\end{align*}</p></li>
<li><p><strong>MA(q):</strong><br />
\begin{align*}
\text{Autocorrelation} &amp;&amp; Corr(Y_t, Y_{t-i}) = \rho_i &amp;=
\begin{cases}
\dfrac{\theta_i + \theta_1\theta_{i-1}  + \theta_2\theta_{i-2} + \cdots + \theta_q\theta_{i-q}}{1 + \theta_1^2 + \cdots  + \theta_q^2} &amp; \text{ for } i= 1, 2, \cdots, q \
0 &amp; \text{ for } i &gt; q \
\end{cases}
\end{align*}</p></li>
</ul>
<blockquote>
<div><p><strong>움직임 특성:</strong></p>
</div></blockquote>
<ul class="simple">
<li><p><strong>Stationarity Condition of MA(1):</strong> <span class="math notranslate nohighlight">\(|\theta_1| &lt; 1\)</span></p></li>
<li><p><strong>Stationarity Condition of MA(2):</strong> <span class="math notranslate nohighlight">\(|\theta_2| &lt; 1\)</span>, <span class="math notranslate nohighlight">\(\theta_1 + \theta_2 &gt; -1\)</span>, <span class="math notranslate nohighlight">\(\theta_1 - \theta_2 &lt; 1\)</span></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="nn">sm</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### MA(1)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">123</span><span class="p">)</span>
<span class="n">ar_params</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
<span class="n">ma_params</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.9</span><span class="p">])</span>
<span class="n">ar</span><span class="p">,</span> <span class="n">ma</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="n">ar_params</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">ma_params</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">ArmaProcess</span><span class="p">(</span><span class="n">ar</span><span class="p">,</span> <span class="n">ma</span><span class="p">)</span><span class="o">.</span><span class="n">generate_sample</span><span class="p">(</span><span class="mi">500</span><span class="p">,</span> <span class="n">burnin</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="s1">&#39;o-&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">311</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">sm</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">ArmaProcess</span><span class="p">(</span><span class="n">ar</span><span class="p">,</span> <span class="n">ma</span><span class="p">)</span><span class="o">.</span><span class="n">acf</span><span class="p">(</span><span class="n">lags</span><span class="o">=</span><span class="mi">10</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Theoretical autocorrelation function of an ARMA process&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">312</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">sm</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">ArmaProcess</span><span class="p">(</span><span class="n">ar</span><span class="p">,</span> <span class="n">ma</span><span class="p">)</span><span class="o">.</span><span class="n">pacf</span><span class="p">(</span><span class="n">lags</span><span class="o">=</span><span class="mi">10</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Theoretical partial autocorrelation function of an ARMA process&quot;</span><span class="p">)</span>

<span class="n">sm</span><span class="o">.</span><span class="n">graphics</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">plot_acf</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">313</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Sampling autocorrelation function of an ARMA process&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/3_Algorithms_ML_TS_Linear_51_0.png" src="../_images/3_Algorithms_ML_TS_Linear_51_0.png" />
<img alt="../_images/3_Algorithms_ML_TS_Linear_51_1.png" src="../_images/3_Algorithms_ML_TS_Linear_51_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### MA(2)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">123</span><span class="p">)</span>
<span class="n">ar_params</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
<span class="n">ma_params</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">])</span>
<span class="n">ar</span><span class="p">,</span> <span class="n">ma</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="n">ar_params</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">ma_params</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">ArmaProcess</span><span class="p">(</span><span class="n">ar</span><span class="p">,</span> <span class="n">ma</span><span class="p">)</span><span class="o">.</span><span class="n">generate_sample</span><span class="p">(</span><span class="mi">500</span><span class="p">,</span> <span class="n">burnin</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="s1">&#39;o-&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">311</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">sm</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">ArmaProcess</span><span class="p">(</span><span class="n">ar</span><span class="p">,</span> <span class="n">ma</span><span class="p">)</span><span class="o">.</span><span class="n">acf</span><span class="p">(</span><span class="n">lags</span><span class="o">=</span><span class="mi">10</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Theoretical autocorrelation function of an ARMA process&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">312</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">sm</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">ArmaProcess</span><span class="p">(</span><span class="n">ar</span><span class="p">,</span> <span class="n">ma</span><span class="p">)</span><span class="o">.</span><span class="n">pacf</span><span class="p">(</span><span class="n">lags</span><span class="o">=</span><span class="mi">10</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Theoretical partial autocorrelation function of an ARMA process&quot;</span><span class="p">)</span>

<span class="n">sm</span><span class="o">.</span><span class="n">graphics</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">plot_acf</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">313</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Sampling autocorrelation function of an ARMA process&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/3_Algorithms_ML_TS_Linear_52_0.png" src="../_images/3_Algorithms_ML_TS_Linear_52_0.png" />
<img alt="../_images/3_Algorithms_ML_TS_Linear_52_1.png" src="../_images/3_Algorithms_ML_TS_Linear_52_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### MA(5)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">123</span><span class="p">)</span>
<span class="n">ar_params</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
<span class="n">ma_params</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mf">1.6</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">])</span>
<span class="n">ar</span><span class="p">,</span> <span class="n">ma</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="n">ar_params</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">ma_params</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">ArmaProcess</span><span class="p">(</span><span class="n">ar</span><span class="p">,</span> <span class="n">ma</span><span class="p">)</span><span class="o">.</span><span class="n">generate_sample</span><span class="p">(</span><span class="mi">500</span><span class="p">,</span> <span class="n">burnin</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="s1">&#39;o-&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">311</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">sm</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">ArmaProcess</span><span class="p">(</span><span class="n">ar</span><span class="p">,</span> <span class="n">ma</span><span class="p">)</span><span class="o">.</span><span class="n">acf</span><span class="p">(</span><span class="n">lags</span><span class="o">=</span><span class="mi">10</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Theoretical autocorrelation function of an ARMA process&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">312</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">sm</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">ArmaProcess</span><span class="p">(</span><span class="n">ar</span><span class="p">,</span> <span class="n">ma</span><span class="p">)</span><span class="o">.</span><span class="n">pacf</span><span class="p">(</span><span class="n">lags</span><span class="o">=</span><span class="mi">10</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Theoretical partial autocorrelation function of an ARMA process&quot;</span><span class="p">)</span>

<span class="n">sm</span><span class="o">.</span><span class="n">graphics</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">plot_acf</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">313</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Sampling autocorrelation function of an ARMA process&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/3_Algorithms_ML_TS_Linear_53_0.png" src="../_images/3_Algorithms_ML_TS_Linear_53_0.png" />
<img alt="../_images/3_Algorithms_ML_TS_Linear_53_1.png" src="../_images/3_Algorithms_ML_TS_Linear_53_1.png" />
</div>
</div>
</div>
<div class="section" id="ar-auto-regressive">
<h3>AR(Auto-Regressive)<a class="headerlink" href="#ar-auto-regressive" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><p><strong>“<span class="math notranslate nohighlight">\(AR(p)\)</span>: 알고리즘의 차수(<span class="math notranslate nohighlight">\(p\)</span>)가 유한한 자기자신의 과거값들의 선형조합”</strong></p>
</div></blockquote>
<ul class="simple">
<li><p><strong>필요성:</strong> ACF가 시차(Lag)가 증가해도 0이 되지 않고 오랜시간 남아있는 경우에 <span class="math notranslate nohighlight">\(MA\)</span>모형을 사용하면 차수가 <span class="math notranslate nohighlight">\(\infty\)</span>로 감</p></li>
</ul>
<p>\begin{align*}
Y_t &amp;= \phi_1Y_{t-1} + \phi_2Y_{t-2} + \cdots + \phi_pY_{t-p} + \epsilon_t \
\end{align*}
\begin{align*}
where~\epsilon_i \sim i.i.d.~WN(0, \sigma_{\epsilon_i}^2)~and~\displaystyle \sum_{i=1}^{\infty}\phi_i^2 &lt; \infty
\end{align*}
\begin{align*}
Y_t &amp;= \phi_1Y_{t-1} + \phi_2Y_{t-2} + \cdots + \phi_pY_{t-p} + \epsilon_t \
Y_t - \phi_1Y_{t-1} - \phi_2Y_{t-2} - \cdots - \phi_pY_{t-p} &amp;= \epsilon_t \
Y_t - \phi_1LY_t - \phi_2L^2Y_t - \cdots - \phi_pL^pY_t &amp;= \epsilon_t \
(1 - \phi_1L - \phi_2L^2 - \cdots - \phi_pL^p)Y_t &amp;= \epsilon_t \
\phi(L)Y_t &amp;= \epsilon_t \
\end{align*}
\begin{align*}
where~Y_{t-1} = LY_t~and~Y_{t-2} = L^2Y_t
\end{align*}</p>
<ul class="simple">
<li><p><strong>AR(1):</strong><br />
\begin{align*}
\text{Main Equation} &amp;&amp; Y_t &amp;= \phi_1 Y_{t-1} + \epsilon_t \
&amp;&amp; &amp;= \phi_1 (\phi_1 Y_{t-2} + \epsilon_{t-1}) + \epsilon_t \
&amp;&amp; &amp;= \phi_1^2 Y_{t-2} + \phi_1 \epsilon_{t-1} + \epsilon_t \
&amp;&amp; &amp;= \phi_1^2  (\phi_1 Y_{t-3} + \epsilon_{t-2}) + \phi_1 \epsilon_{t-1} + \epsilon_t \
&amp;&amp; &amp;= \phi_1^3 Y_{t-3} + \phi_1^2 \epsilon_{t-2} + \phi_1 \epsilon_{t-1} + \epsilon_t \
&amp;&amp; &amp; \vdots \
&amp;&amp; &amp;= \epsilon_t + \phi_1 \epsilon_{t-1} +\phi_1^2 \epsilon_{t-2} + \phi_1^3 \epsilon_{t-3} + \cdots  \
&amp;&amp; &amp;= MA(\infty) \
\text{Expectation}   &amp;&amp; E(Y_t) &amp;= \mu = E(\phi_1 Y_{t-1} + \epsilon_t) = \phi_1 E(Y_{t-1}) + E(\epsilon_{t}) = \phi_1 \mu + 0 \
&amp;&amp; (1-\phi_1)\mu &amp;= 0 \
&amp;&amp; \mu &amp;= 0~~if~~\phi_1 \neq 1 \
\text{Variance}   &amp;&amp; Var(Y_t) &amp;= \gamma_0 = E(Y_t^2) = E[(\phi_1 Y_{t-1} + \epsilon_t)^2] = E[ \phi_1^2  Y_{t-1}^2 + 2\phi_1 Y_{t-1} \epsilon_{t} + \epsilon_{t}^2] \
&amp;&amp; &amp;= \phi_1^2 E[ Y_{t-1}^2 ] + 2 \phi E[ Y_{t-1} \epsilon_{t} ] + E[ \epsilon_{t}^2 ] \
&amp;&amp; &amp;= \phi_1^2 \gamma_0 + 0 + \sigma_{\epsilon_i}^2 \
&amp;&amp; (1-\phi_1^2)\gamma_0 &amp;= \sigma_{\epsilon_i}^2 \
&amp;&amp; \gamma_0 &amp;= \dfrac{\sigma_{\epsilon_i}^2}{1-\phi_1^2}~~if~~\phi_1^2 \neq 1 \
\text{Covariance} &amp;&amp; Cov(Y_t, Y_{t-1}) &amp;= \gamma_1 = E [(\phi_1 Y_{t-1} + \epsilon_t)(\phi_1 Y_{t-2} + \epsilon_{t-1})] \
&amp;&amp; &amp;= \phi_1^2E (Y_{t-1} Y_{t-2}) + \phi_1 E (Y_{t-1} \epsilon_{t-1}) + \phi_1 E (\epsilon_{t} Y_{t-2}) + E (\epsilon_{t} \epsilon_{t-1}) \
&amp;&amp; &amp;= \phi_1^2\gamma_1 + \phi_1 \sigma_{\epsilon_{i}}^2 + \phi_1 \cdot 0 + 0 \
&amp;&amp; (1 - \phi_1^2)\gamma_1 &amp;= \phi_1 \sigma_{\epsilon_{i}}^2 \
&amp;&amp; \gamma_1 &amp;= \dfrac{\phi_1 \sigma_{\epsilon_{i}}^2}{1 - \phi_1^2} \
&amp;&amp; Cov(Y_t, Y_{t-2}) &amp;= \gamma_2 = E [(\phi_1 Y_{t-1} + \epsilon_t)(\phi_1 Y_{t-3} + \epsilon_{t-2})] \
&amp;&amp; &amp;= \phi_1^2E (Y_{t-1} Y_{t-3}) + \phi_1 E (Y_{t-1} \epsilon_{t-2}) + \phi_1 E (\epsilon_{t} Y_{t-3}) + E (\epsilon_{t} \epsilon_{t-2}) \
&amp;&amp; &amp;= \phi_1^2\gamma_2 + \phi_1 E[(\phi_1Y_{t-2}+\epsilon_{t-1})\epsilon_{t-2}] + \phi_1 \cdot 0 + 0 \
&amp;&amp; &amp;= \phi_1^2\gamma_2 + \phi_1^2 E(Y_{t-2}\epsilon_{t-2}) + \phi_1 E(\epsilon_{t-1}\epsilon_{t-2}) \
&amp;&amp; &amp;= \phi_1^2\gamma_2 + \phi_1^2 \sigma_{\epsilon_{i}}^2 + 0 \
&amp;&amp; (1 - \phi_1^2)\gamma_2 &amp;= \phi_1^2 \sigma_{\epsilon_{i}}^2 \
&amp;&amp; \gamma_2 &amp;= \dfrac{\phi_1^2 \sigma_{\epsilon_{i}}^2}{1 - \phi_1^2} \
\text{Autocorrelation} &amp;&amp; Corr(Y_t, Y_{t-1}) = \rho_1 &amp;= \phi_1 \
&amp;&amp; Corr(Y_t, Y_{t-2}) = \rho_2 &amp;= \phi_1^2 \
&amp;&amp; Corr(Y_t, Y_{t-i}) = \rho_i &amp;= \phi_1^i \
\end{align*}</p></li>
</ul>
<blockquote>
<div><p><strong>움직임 특성:</strong></p>
</div></blockquote>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\phi_1 = 0\)</span>: <span class="math notranslate nohighlight">\(Y_t\)</span>는 백색잡음</p></li>
<li><p><span class="math notranslate nohighlight">\(\phi_1 &lt; 0\)</span>: 부호를 바꿔가면서(진동하면서) 지수적으로 감소</p></li>
<li><p><span class="math notranslate nohighlight">\(\phi_1 &gt; 0\)</span>: 시차가 증가하면서 자기상관계수는 지수적으로 감소</p></li>
<li><p><span class="math notranslate nohighlight">\(\phi_1 = 1\)</span>: <span class="math notranslate nohighlight">\(Y_t\)</span>는 비정상성인 랜덤워크(Random Walk)
\begin{align*}
Y_t &amp;= Y_{t-1} + \epsilon_t \
Var(Y_t) &amp;= Var(Y_{t-1} + \epsilon_t) \
&amp;= Var(Y_{t-1}) + Var(\epsilon_t)  ;; (\text{independence}) \
Var(Y_t) &amp;&gt; Var(Y_{t-1})
\end{align*}</p></li>
<li><p><strong>Stationarity Condition:</strong> <span class="math notranslate nohighlight">\(|\phi_1| &lt; 1\)</span></p></li>
<li><p><strong>AR(2):</strong><br />
\begin{align*}
\text{Main Equation} &amp;&amp; Y_t &amp;= \phi_1 Y_{t-1} + \phi_2 Y_{t-2} + \epsilon_t \
&amp;&amp; &amp;= \phi_1 (\phi_1 Y_{t-2} + \epsilon_{t-1}) + \phi_2 (\phi_2 Y_{t-3} + \epsilon_{t-2}) + \epsilon_t \
&amp;&amp; &amp;= \phi_1^2 Y_{t-2} + \phi_1 \epsilon_{t-1} + \phi_2^2 Y_{t-3} + \phi_2 \epsilon_{t-2} + \epsilon_t \
&amp;&amp; &amp;= \phi_1^2 (\phi_1 Y_{t-3} + \phi_2 Y_{t-4} + \epsilon_{t-3}) + \phi_1 \epsilon_{t-1} +
\phi_2^2 (\phi_1 Y_{t-4} + \phi_2 Y_{t-5} + \epsilon_{t-4}) + \phi_2 \epsilon_{t-2} + \epsilon_t \
&amp;&amp; &amp; \vdots \
&amp;&amp; &amp;= \epsilon_t + \phi_1 \epsilon_{t-1} + \phi_2 \epsilon_{t-1} + \phi_1^2 \epsilon_{t-2} + \phi_2^2 \epsilon_{t-2} + \phi_1^3 \epsilon_{t-3} + \phi_2^3 \epsilon_{t-3} + \cdots  \
&amp;&amp; &amp;= MA(\infty) \
\text{Expectation}   &amp;&amp; E(Y_t) &amp;= \mu = E(\phi_1 Y_{t-1} + \phi_2 Y_{t-2} + \epsilon_t) = \phi_1 E(Y_{t-1}) + \phi_2 E(Y_{t-2}) + E(\epsilon_{t}) = \phi_1 \mu + \phi_2 \mu + 0 \
&amp;&amp; (1-\phi_1-\phi_2)\mu &amp;= 0 \
&amp;&amp; \mu &amp;= 0~~if~~\phi_1+\phi_2 \neq 1 \
\text{Covariance(“Yule-Walker Equation”)} &amp;&amp; \gamma_i &amp;= E(Y_tY_{t-i}) = E[(\phi_1 Y_{t-1} + \phi_2 Y_{t-2} + \epsilon_t)Y_{t-i}] \
&amp;&amp; &amp;= E(\phi_1 Y_{t-1}Y_{t-i}) + E(\phi_2 Y_{t-2}Y_{t-i}) + E(\epsilon_t Y_{t-i}) \
&amp;&amp; &amp;= \phi_1 \gamma_{i-1} + \phi_2 \gamma_{i-2} \
\text{Autocorrelation} &amp;&amp; Corr(Y_t, Y_{t-i}) &amp;= \rho_i = \phi_1 \rho_{i-1} + \phi_2 \rho_{i-2} \
&amp;&amp; \rho_1 &amp;= \phi_1 \rho_{0} + \phi_2 \rho_{-1} = \phi_1 \cdot 1 + \phi_2 \rho_{1} \
&amp;&amp; (1-\phi_2)\rho_1 &amp;= \phi_1 \
&amp;&amp; \rho_1 &amp;= \dfrac{\phi_1}{1-\phi_2} \
&amp;&amp; &amp; \vdots \
&amp;&amp; \rho_2 &amp;= \dfrac{\phi_1^2 + \phi_2(1-\phi_2)}{1-\phi_2} \
&amp;&amp; &amp; \vdots \
&amp;&amp; \rho_i &amp;= \left( 1+\dfrac{1+\phi_2}{1-\phi_2} \cdot i \right)\left(\dfrac{\phi_1}{2} \right)^i \
\end{align*}</p></li>
</ul>
<blockquote>
<div><p><strong>움직임 특성:</strong></p>
</div></blockquote>
<ul class="simple">
<li><p>시차가 증가하면서 자기상관계수의 절대값은 지수적으로 감소</p></li>
<li><p>진동 주파수에 따라 다르지만 진동 가능</p></li>
<li><p><strong>Stationarity Condition:</strong> <span class="math notranslate nohighlight">\(|\phi_1| &lt; 1\)</span>, <span class="math notranslate nohighlight">\(\phi_1 + \phi_2 &lt; 1\)</span>, <span class="math notranslate nohighlight">\(\phi_2 - \phi_1 &lt; 1\)</span></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="nn">sm</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### AR(1)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">123</span><span class="p">)</span>
<span class="n">ar_params</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.9</span><span class="p">])</span>
<span class="n">ma_params</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
<span class="n">ar</span><span class="p">,</span> <span class="n">ma</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="n">ar_params</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">ma_params</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">ArmaProcess</span><span class="p">(</span><span class="n">ar</span><span class="p">,</span> <span class="n">ma</span><span class="p">)</span><span class="o">.</span><span class="n">generate_sample</span><span class="p">(</span><span class="mi">500</span><span class="p">,</span> <span class="n">burnin</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="s1">&#39;o-&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">311</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">sm</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">ArmaProcess</span><span class="p">(</span><span class="n">ar</span><span class="p">,</span> <span class="n">ma</span><span class="p">)</span><span class="o">.</span><span class="n">acf</span><span class="p">(</span><span class="n">lags</span><span class="o">=</span><span class="mi">10</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Theoretical autocorrelation function of an ARMA process&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">312</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">sm</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">ArmaProcess</span><span class="p">(</span><span class="n">ar</span><span class="p">,</span> <span class="n">ma</span><span class="p">)</span><span class="o">.</span><span class="n">pacf</span><span class="p">(</span><span class="n">lags</span><span class="o">=</span><span class="mi">10</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Theoretical partial autocorrelation function of an ARMA process&quot;</span><span class="p">)</span>

<span class="n">sm</span><span class="o">.</span><span class="n">graphics</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">plot_pacf</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">313</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Sampling partial autocorrelation function of an ARMA process&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/3_Algorithms_ML_TS_Linear_56_0.png" src="../_images/3_Algorithms_ML_TS_Linear_56_0.png" />
<img alt="../_images/3_Algorithms_ML_TS_Linear_56_1.png" src="../_images/3_Algorithms_ML_TS_Linear_56_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### AR(1)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">123</span><span class="p">)</span>
<span class="n">ar_params</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">0.9</span><span class="p">])</span>
<span class="n">ma_params</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
<span class="n">ar</span><span class="p">,</span> <span class="n">ma</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="n">ar_params</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">ma_params</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">ArmaProcess</span><span class="p">(</span><span class="n">ar</span><span class="p">,</span> <span class="n">ma</span><span class="p">)</span><span class="o">.</span><span class="n">generate_sample</span><span class="p">(</span><span class="mi">500</span><span class="p">,</span> <span class="n">burnin</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="s1">&#39;o-&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">311</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">sm</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">ArmaProcess</span><span class="p">(</span><span class="n">ar</span><span class="p">,</span> <span class="n">ma</span><span class="p">)</span><span class="o">.</span><span class="n">acf</span><span class="p">(</span><span class="n">lags</span><span class="o">=</span><span class="mi">10</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Theoretical autocorrelation function of an ARMA process&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">312</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">sm</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">ArmaProcess</span><span class="p">(</span><span class="n">ar</span><span class="p">,</span> <span class="n">ma</span><span class="p">)</span><span class="o">.</span><span class="n">pacf</span><span class="p">(</span><span class="n">lags</span><span class="o">=</span><span class="mi">10</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Theoretical partial autocorrelation function of an ARMA process&quot;</span><span class="p">)</span>

<span class="n">sm</span><span class="o">.</span><span class="n">graphics</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">plot_pacf</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">313</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Sampling partial autocorrelation function of an ARMA process&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/3_Algorithms_ML_TS_Linear_57_0.png" src="../_images/3_Algorithms_ML_TS_Linear_57_0.png" />
<img alt="../_images/3_Algorithms_ML_TS_Linear_57_1.png" src="../_images/3_Algorithms_ML_TS_Linear_57_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### AR(2)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">123</span><span class="p">)</span>
<span class="n">ar_params</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">])</span>
<span class="n">ma_params</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
<span class="n">ar</span><span class="p">,</span> <span class="n">ma</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="n">ar_params</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">ma_params</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">ArmaProcess</span><span class="p">(</span><span class="n">ar</span><span class="p">,</span> <span class="n">ma</span><span class="p">)</span><span class="o">.</span><span class="n">generate_sample</span><span class="p">(</span><span class="mi">500</span><span class="p">,</span> <span class="n">burnin</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="s1">&#39;o-&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">311</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">sm</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">ArmaProcess</span><span class="p">(</span><span class="n">ar</span><span class="p">,</span> <span class="n">ma</span><span class="p">)</span><span class="o">.</span><span class="n">acf</span><span class="p">(</span><span class="n">lags</span><span class="o">=</span><span class="mi">10</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Theoretical autocorrelation function of an ARMA process&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">312</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">sm</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">ArmaProcess</span><span class="p">(</span><span class="n">ar</span><span class="p">,</span> <span class="n">ma</span><span class="p">)</span><span class="o">.</span><span class="n">pacf</span><span class="p">(</span><span class="n">lags</span><span class="o">=</span><span class="mi">10</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Theoretical partial autocorrelation function of an ARMA process&quot;</span><span class="p">)</span>

<span class="n">sm</span><span class="o">.</span><span class="n">graphics</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">plot_pacf</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">313</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Sampling partial autocorrelation function of an ARMA process&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/3_Algorithms_ML_TS_Linear_58_0.png" src="../_images/3_Algorithms_ML_TS_Linear_58_0.png" />
<img alt="../_images/3_Algorithms_ML_TS_Linear_58_1.png" src="../_images/3_Algorithms_ML_TS_Linear_58_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### AR(2)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">123</span><span class="p">)</span>
<span class="n">ar_params</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">])</span>
<span class="n">ma_params</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
<span class="n">ar</span><span class="p">,</span> <span class="n">ma</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="n">ar_params</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">ma_params</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">ArmaProcess</span><span class="p">(</span><span class="n">ar</span><span class="p">,</span> <span class="n">ma</span><span class="p">)</span><span class="o">.</span><span class="n">generate_sample</span><span class="p">(</span><span class="mi">500</span><span class="p">,</span> <span class="n">burnin</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="s1">&#39;o-&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">311</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">sm</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">ArmaProcess</span><span class="p">(</span><span class="n">ar</span><span class="p">,</span> <span class="n">ma</span><span class="p">)</span><span class="o">.</span><span class="n">acf</span><span class="p">(</span><span class="n">lags</span><span class="o">=</span><span class="mi">10</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Theoretical autocorrelation function of an ARMA process&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">312</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">sm</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">ArmaProcess</span><span class="p">(</span><span class="n">ar</span><span class="p">,</span> <span class="n">ma</span><span class="p">)</span><span class="o">.</span><span class="n">pacf</span><span class="p">(</span><span class="n">lags</span><span class="o">=</span><span class="mi">10</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Theoretical partial autocorrelation function of an ARMA process&quot;</span><span class="p">)</span>

<span class="n">sm</span><span class="o">.</span><span class="n">graphics</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">plot_pacf</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">313</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Sampling partial autocorrelation function of an ARMA process&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/3_Algorithms_ML_TS_Linear_59_0.png" src="../_images/3_Algorithms_ML_TS_Linear_59_0.png" />
<img alt="../_images/3_Algorithms_ML_TS_Linear_59_1.png" src="../_images/3_Algorithms_ML_TS_Linear_59_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### AR(5)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">123</span><span class="p">)</span>
<span class="n">ar_params</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1</span><span class="p">])</span>
<span class="n">ma_params</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
<span class="n">ar</span><span class="p">,</span> <span class="n">ma</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="n">ar_params</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">ma_params</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">ArmaProcess</span><span class="p">(</span><span class="n">ar</span><span class="p">,</span> <span class="n">ma</span><span class="p">)</span><span class="o">.</span><span class="n">generate_sample</span><span class="p">(</span><span class="mi">500</span><span class="p">,</span> <span class="n">burnin</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="s1">&#39;o-&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">311</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">sm</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">ArmaProcess</span><span class="p">(</span><span class="n">ar</span><span class="p">,</span> <span class="n">ma</span><span class="p">)</span><span class="o">.</span><span class="n">acf</span><span class="p">(</span><span class="n">lags</span><span class="o">=</span><span class="mi">10</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Theoretical autocorrelation function of an ARMA process&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">312</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">sm</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">ArmaProcess</span><span class="p">(</span><span class="n">ar</span><span class="p">,</span> <span class="n">ma</span><span class="p">)</span><span class="o">.</span><span class="n">pacf</span><span class="p">(</span><span class="n">lags</span><span class="o">=</span><span class="mi">10</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Theoretical partial autocorrelation function of an ARMA process&quot;</span><span class="p">)</span>

<span class="n">sm</span><span class="o">.</span><span class="n">graphics</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">plot_pacf</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">313</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Sampling partial autocorrelation function of an ARMA process&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/3_Algorithms_ML_TS_Linear_60_0.png" src="../_images/3_Algorithms_ML_TS_Linear_60_0.png" />
<img alt="../_images/3_Algorithms_ML_TS_Linear_60_1.png" src="../_images/3_Algorithms_ML_TS_Linear_60_1.png" />
</div>
</div>
</div>
<div class="section" id="relation-of-ma-and-ar">
<h3>Relation of MA and AR<a class="headerlink" href="#relation-of-ma-and-ar" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p><strong>가역성 조건(Invertibility Condition):</strong></p></li>
</ul>
<blockquote>
<div><p><strong>1)</strong> <span class="math notranslate nohighlight">\(MA(q)\)</span> -&gt; <span class="math notranslate nohighlight">\(AR(\infty)\)</span>: 변환 후 AR 모형이 Stationary Condition이면 “Invertibility”<br />
<strong>2)</strong> <span class="math notranslate nohighlight">\(AR(p)\)</span> -&gt; <span class="math notranslate nohighlight">\(MA(\infty)\)</span>: 여러개 모형변환 가능하지만 “Invertibility” 조건을 만족하는 MA 모형은 단 1개만 존재</p>
</div></blockquote>
</div>
<div class="section" id="arma-auto-regressive-moving-average">
<h3>ARMA(Auto-Regressive Moving Average)<a class="headerlink" href="#arma-auto-regressive-moving-average" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><p><strong>“<span class="math notranslate nohighlight">\(ARMA(p,q)\)</span>: 알고리즘의 차수(<span class="math notranslate nohighlight">\(p~and~q\)</span>)가 유한한 <span class="math notranslate nohighlight">\(AR(p)\)</span>와 <span class="math notranslate nohighlight">\(MA(q)\)</span>의 선형조합”</strong></p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(AR\)</span>과 <span class="math notranslate nohighlight">\(MA\)</span>의 정상성 조건과 가역성 조건이 동일하게 <span class="math notranslate nohighlight">\(ARMA\)</span> 알고리즘들에 적용</p></li>
<li><p>종속변수 <span class="math notranslate nohighlight">\(Y_t\)</span>는 종속변수 <span class="math notranslate nohighlight">\(Y_t\)</span>와 백색잡음(<span class="math notranslate nohighlight">\(\epsilon_t\)</span>) 차분들(Lagged Variables)의 합으로 예측가능</p></li>
</ul>
</div></blockquote>
<p>\begin{align*}
Y_t = \phi_1Y_{t-1} + \phi_2Y_{t-2} + \cdots + \phi_pY_{t-p} +
\theta_1\epsilon_{t-1} + \theta_2\epsilon_{t-2} + \cdots + \theta_q\epsilon_{t-q} + \epsilon_t \
\end{align*}
\begin{align*}
where~\epsilon_i \sim i.i.d.~WN(0, \sigma_{\epsilon_i}^2)~and~\displaystyle \sum_{i=1}^{\infty}\phi_i^2 &lt; \infty, \displaystyle \sum_{i=1}^{\infty}\theta_i^2 &lt; \infty
\end{align*}
\begin{align*}
\phi(L)Y_t &amp;= \theta(L)\epsilon_t \
Y_t &amp;= \dfrac{\theta(L)}{\phi(L)}\epsilon_t \
\end{align*}</p>
<p>\begin{align*}
\text{Main Equation} &amp;&amp; Y_t &amp;= \dfrac{\theta(L)}{\phi(L)}\epsilon_t \
&amp;&amp; &amp;= \psi(L)\epsilon_t \text{ where } \psi(L) = \dfrac{\theta(L)}{\phi(L)} \
&amp;&amp; &amp;= (1 + \psi_1L + \psi_2L^2 + \cdots)\epsilon_t \
&amp;&amp; &amp;= \epsilon_t + \psi_1\epsilon_{t-1} + \psi_2\epsilon_{t-2} + \cdots \
&amp;&amp; &amp; \text{ where } \
&amp;&amp; \psi_1 &amp;= \theta_1 - \phi_1 \
&amp;&amp; \psi_2 &amp;= \theta_2 - \phi_2 - \phi_1 \psi_1 \
&amp;&amp; &amp; \vdots \
&amp;&amp; \psi_j &amp;= \theta_j - \phi_p\psi_{j-p} - \phi_2 \psi_{p-1} - \cdots - \phi_1 \psi_{j-1} \
\text{Autocorrelation(“Yule-Walker Equation”)} &amp;&amp; \rho_i &amp;= \phi_1 \rho_{i-1} + \cdots + \phi_p \rho_{i-p} \
\end{align*}</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">statsmodels</span>
<span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="nn">sm</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### ARMA(1,0) = AR(1)</span>
<span class="c1"># Setting</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">123</span><span class="p">)</span>
<span class="n">ar_params</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.75</span><span class="p">])</span>
<span class="n">ma_params</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
<span class="n">index_name</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;const&#39;</span><span class="p">,</span> <span class="s1">&#39;ar(1)&#39;</span><span class="p">]</span>
<span class="n">ahead</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">ar</span><span class="p">,</span> <span class="n">ma</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="n">ar_params</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">ma_params</span><span class="p">]</span>
<span class="n">ar_order</span><span class="p">,</span> <span class="n">ma_order</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">ar</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">ma</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span>

<span class="c1"># Generator</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">statsmodels</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">arima_process</span><span class="o">.</span><span class="n">arma_generate_sample</span><span class="p">(</span><span class="n">ar</span><span class="p">,</span> <span class="n">ma</span><span class="p">,</span> <span class="n">nsample</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">burnin</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
<span class="n">fit</span> <span class="o">=</span> <span class="n">statsmodels</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">arima_model</span><span class="o">.</span><span class="n">ARMA</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="p">(</span><span class="n">ar_order</span><span class="p">,</span><span class="n">ma_order</span><span class="p">))</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">trend</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="n">disp</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">pred_ts_point</span> <span class="o">=</span> <span class="n">fit</span><span class="o">.</span><span class="n">forecast</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="n">ahead</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">pred_ts_interval</span> <span class="o">=</span> <span class="n">fit</span><span class="o">.</span><span class="n">forecast</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="n">ahead</span><span class="p">)[</span><span class="mi">2</span><span class="p">]</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">forecast_index</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">+</span><span class="n">ahead</span><span class="o">+</span><span class="mi">1</span><span class="p">)]</span>
<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">pred_ts_point</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">forecast_index</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;forecast&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">pred_ts_interval</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">forecast_index</span><span class="p">)</span><span class="o">.</span><span class="n">index</span><span class="p">,</span>
                <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">pred_ts_interval</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">forecast_index</span><span class="p">)</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span>
                <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">pred_ts_interval</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">forecast_index</span><span class="p">)</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.15</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;observed&#39;</span><span class="p">,</span> <span class="s1">&#39;forecast&#39;</span><span class="p">])</span>
<span class="n">display</span><span class="p">(</span><span class="n">fit</span><span class="o">.</span><span class="n">summary2</span><span class="p">())</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="n">statsmodels</span><span class="o">.</span><span class="n">graphics</span><span class="o">.</span><span class="n">tsaplots</span><span class="o">.</span><span class="n">plot_acf</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">zero</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">use_vlines</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">121</span><span class="p">))</span>
<span class="n">statsmodels</span><span class="o">.</span><span class="n">graphics</span><span class="o">.</span><span class="n">tsaplots</span><span class="o">.</span><span class="n">plot_pacf</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">zero</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">use_vlines</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">122</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="simpletable">
<tr>
        <td>Model:</td>              <td>ARMA</td>               <td>BIC:</td>         <td>2775.2536</td>
</tr>
<tr>
  <td>Dependent Variable:</td>         <td>y</td>           <td>Log-Likelihood:</td>    <td>-1377.3</td> 
</tr>
<tr>
         <td>Date:</td>        <td>2020-07-31 22:45</td>        <td>Scale:</td>         <td>1.0000</td>  
</tr>
<tr>
   <td>No. Observations:</td>        <td>1000</td>              <td>Method:</td>        <td>css-mle</td> 
</tr>
<tr>
       <td>Df Model:</td>              <td>2</td>               <td>Sample:</td>           <td>0</td>    
</tr>
<tr>
     <td>Df Residuals:</td>           <td>998</td>                 <td></td>               <td>0</td>    
</tr>
<tr>
      <td>Converged:</td>           <td>1.0000</td>      <td>S.D. of innovations:</td>   <td>0.959</td>  
</tr>
<tr>
    <td>No. Iterations:</td>        <td>4.0000</td>              <td>HQIC:</td>        <td>2766.126</td> 
</tr>
<tr>
         <td>AIC:</td>             <td>2760.5304</td>              <td></td>               <td></td>     
</tr>
</table>
<table class="simpletable">
<tr>
     <td></td>      <th>Coef.</th> <th>Std.Err.</th>    <th>t</th>     <th>P>|t|</th> <th>[0.025</th>  <th>0.975]</th>
</tr>
<tr>
  <th>const</th>   <td>0.0406</td>  <td>0.1197</td>  <td>0.3389</td>  <td>0.7347</td> <td>-0.1940</td> <td>0.2752</td>
</tr>
<tr>
  <th>ar.L1.y</th> <td>0.7475</td>  <td>0.0210</td>  <td>35.6193</td> <td>0.0000</td> <td>0.7063</td>  <td>0.7886</td>
</tr>
</table>
<table class="simpletable">
<tr>
    <td></td>    <th>Real</th>  <th>Imaginary</th> <th>Modulus</th> <th>Frequency</th>
</tr>
<tr>
  <th>AR.1</th> <td>1.3379</td>  <td>0.0000</td>   <td>1.3379</td>   <td>0.0000</td>  
</tr>
</table></div><img alt="../_images/3_Algorithms_ML_TS_Linear_64_1.png" src="../_images/3_Algorithms_ML_TS_Linear_64_1.png" />
<img alt="../_images/3_Algorithms_ML_TS_Linear_64_2.png" src="../_images/3_Algorithms_ML_TS_Linear_64_2.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### ARMA(2,0) = AR(2)</span>
<span class="c1"># Setting</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">123</span><span class="p">)</span>
<span class="n">ar_params</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.75</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.25</span><span class="p">])</span>
<span class="n">ma_params</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
<span class="n">index_name</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;const&#39;</span><span class="p">,</span> <span class="s1">&#39;ar(1)&#39;</span><span class="p">,</span> <span class="s1">&#39;ar(2)&#39;</span><span class="p">]</span>
<span class="n">ahead</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">ar</span><span class="p">,</span> <span class="n">ma</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="n">ar_params</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">ma_params</span><span class="p">]</span>
<span class="n">ar_order</span><span class="p">,</span> <span class="n">ma_order</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">ar</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">ma</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span>

<span class="c1"># Generator</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">statsmodels</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">arima_process</span><span class="o">.</span><span class="n">arma_generate_sample</span><span class="p">(</span><span class="n">ar</span><span class="p">,</span> <span class="n">ma</span><span class="p">,</span> <span class="n">nsample</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">burnin</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
<span class="n">fit</span> <span class="o">=</span> <span class="n">statsmodels</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">arima_model</span><span class="o">.</span><span class="n">ARMA</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="p">(</span><span class="n">ar_order</span><span class="p">,</span><span class="n">ma_order</span><span class="p">))</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">trend</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="n">disp</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">pred_ts_point</span> <span class="o">=</span> <span class="n">fit</span><span class="o">.</span><span class="n">forecast</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="n">ahead</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">pred_ts_interval</span> <span class="o">=</span> <span class="n">fit</span><span class="o">.</span><span class="n">forecast</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="n">ahead</span><span class="p">)[</span><span class="mi">2</span><span class="p">]</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">forecast_index</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">+</span><span class="n">ahead</span><span class="o">+</span><span class="mi">1</span><span class="p">)]</span>
<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">pred_ts_point</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">forecast_index</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;forecast&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">pred_ts_interval</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">forecast_index</span><span class="p">)</span><span class="o">.</span><span class="n">index</span><span class="p">,</span>
                <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">pred_ts_interval</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">forecast_index</span><span class="p">)</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span>
                <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">pred_ts_interval</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">forecast_index</span><span class="p">)</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.15</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;observed&#39;</span><span class="p">,</span> <span class="s1">&#39;forecast&#39;</span><span class="p">])</span>
<span class="n">display</span><span class="p">(</span><span class="n">fit</span><span class="o">.</span><span class="n">summary2</span><span class="p">())</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="n">statsmodels</span><span class="o">.</span><span class="n">graphics</span><span class="o">.</span><span class="n">tsaplots</span><span class="o">.</span><span class="n">plot_acf</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">zero</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">use_vlines</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">121</span><span class="p">))</span>
<span class="n">statsmodels</span><span class="o">.</span><span class="n">graphics</span><span class="o">.</span><span class="n">tsaplots</span><span class="o">.</span><span class="n">plot_pacf</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">zero</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">use_vlines</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">122</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="simpletable">
<tr>
        <td>Model:</td>              <td>ARMA</td>               <td>BIC:</td>         <td>2781.5944</td>
</tr>
<tr>
  <td>Dependent Variable:</td>         <td>y</td>           <td>Log-Likelihood:</td>    <td>-1377.0</td> 
</tr>
<tr>
         <td>Date:</td>        <td>2020-07-31 22:45</td>        <td>Scale:</td>         <td>1.0000</td>  
</tr>
<tr>
   <td>No. Observations:</td>        <td>1000</td>              <td>Method:</td>        <td>css-mle</td> 
</tr>
<tr>
       <td>Df Model:</td>              <td>3</td>               <td>Sample:</td>           <td>0</td>    
</tr>
<tr>
     <td>Df Residuals:</td>           <td>997</td>                 <td></td>               <td>0</td>    
</tr>
<tr>
      <td>Converged:</td>           <td>1.0000</td>      <td>S.D. of innovations:</td>   <td>0.959</td>  
</tr>
<tr>
    <td>No. Iterations:</td>        <td>5.0000</td>              <td>HQIC:</td>        <td>2769.424</td> 
</tr>
<tr>
         <td>AIC:</td>             <td>2761.9633</td>              <td></td>               <td></td>     
</tr>
</table>
<table class="simpletable">
<tr>
     <td></td>      <th>Coef.</th>  <th>Std.Err.</th>    <th>t</th>     <th>P>|t|</th> <th>[0.025</th>  <th>0.975]</th> 
</tr>
<tr>
  <th>const</th>   <td>0.0193</td>   <td>0.0592</td>  <td>0.3255</td>  <td>0.7448</td> <td>-0.0967</td> <td>0.1352</td> 
</tr>
<tr>
  <th>ar.L1.y</th> <td>0.7557</td>   <td>0.0305</td>  <td>24.7647</td> <td>0.0000</td> <td>0.6959</td>  <td>0.8155</td> 
</tr>
<tr>
  <th>ar.L2.y</th> <td>-0.2678</td>  <td>0.0305</td>  <td>-8.7791</td> <td>0.0000</td> <td>-0.3276</td> <td>-0.2080</td>
</tr>
</table>
<table class="simpletable">
<tr>
    <td></td>    <th>Real</th>  <th>Imaginary</th> <th>Modulus</th> <th>Frequency</th>
</tr>
<tr>
  <th>AR.1</th> <td>1.4111</td>  <td>-1.3203</td>  <td>1.9324</td>   <td>-0.1197</td> 
</tr>
<tr>
  <th>AR.2</th> <td>1.4111</td>  <td>1.3203</td>   <td>1.9324</td>   <td>0.1197</td>  
</tr>
</table></div><img alt="../_images/3_Algorithms_ML_TS_Linear_65_1.png" src="../_images/3_Algorithms_ML_TS_Linear_65_1.png" />
<img alt="../_images/3_Algorithms_ML_TS_Linear_65_2.png" src="../_images/3_Algorithms_ML_TS_Linear_65_2.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### ARMA(4,0) = AR(4)</span>
<span class="c1"># Setting</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">123</span><span class="p">)</span>
<span class="n">ar_params</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.75</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">])</span>
<span class="n">ma_params</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
<span class="n">index_name</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;const&#39;</span><span class="p">,</span> <span class="s1">&#39;ar(1)&#39;</span><span class="p">,</span> <span class="s1">&#39;ar(2)&#39;</span><span class="p">,</span> <span class="s1">&#39;ar(3)&#39;</span><span class="p">,</span> <span class="s1">&#39;ar(4)&#39;</span><span class="p">]</span>
<span class="n">ahead</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">ar</span><span class="p">,</span> <span class="n">ma</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="n">ar_params</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">ma_params</span><span class="p">]</span>
<span class="n">ar_order</span><span class="p">,</span> <span class="n">ma_order</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">ar</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">ma</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span>

<span class="c1"># Generator</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">statsmodels</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">arima_process</span><span class="o">.</span><span class="n">arma_generate_sample</span><span class="p">(</span><span class="n">ar</span><span class="p">,</span> <span class="n">ma</span><span class="p">,</span> <span class="n">nsample</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">burnin</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
<span class="n">fit</span> <span class="o">=</span> <span class="n">statsmodels</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">arima_model</span><span class="o">.</span><span class="n">ARMA</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="p">(</span><span class="n">ar_order</span><span class="p">,</span><span class="n">ma_order</span><span class="p">))</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">trend</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="n">disp</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">pred_ts_point</span> <span class="o">=</span> <span class="n">fit</span><span class="o">.</span><span class="n">forecast</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="n">ahead</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">pred_ts_interval</span> <span class="o">=</span> <span class="n">fit</span><span class="o">.</span><span class="n">forecast</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="n">ahead</span><span class="p">)[</span><span class="mi">2</span><span class="p">]</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">forecast_index</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">+</span><span class="n">ahead</span><span class="o">+</span><span class="mi">1</span><span class="p">)]</span>
<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">pred_ts_point</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">forecast_index</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;forecast&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">pred_ts_interval</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">forecast_index</span><span class="p">)</span><span class="o">.</span><span class="n">index</span><span class="p">,</span>
                <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">pred_ts_interval</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">forecast_index</span><span class="p">)</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span>
                <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">pred_ts_interval</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">forecast_index</span><span class="p">)</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.15</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;observed&#39;</span><span class="p">,</span> <span class="s1">&#39;forecast&#39;</span><span class="p">])</span>
<span class="n">display</span><span class="p">(</span><span class="n">fit</span><span class="o">.</span><span class="n">summary2</span><span class="p">())</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="n">statsmodels</span><span class="o">.</span><span class="n">graphics</span><span class="o">.</span><span class="n">tsaplots</span><span class="o">.</span><span class="n">plot_acf</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">zero</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">use_vlines</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">121</span><span class="p">))</span>
<span class="n">statsmodels</span><span class="o">.</span><span class="n">graphics</span><span class="o">.</span><span class="n">tsaplots</span><span class="o">.</span><span class="n">plot_pacf</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">zero</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">use_vlines</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">122</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="simpletable">
<tr>
        <td>Model:</td>              <td>ARMA</td>               <td>BIC:</td>         <td>2796.4388</td>
</tr>
<tr>
  <td>Dependent Variable:</td>         <td>y</td>           <td>Log-Likelihood:</td>    <td>-1377.5</td> 
</tr>
<tr>
         <td>Date:</td>        <td>2020-07-31 22:45</td>        <td>Scale:</td>         <td>1.0000</td>  
</tr>
<tr>
   <td>No. Observations:</td>        <td>1000</td>              <td>Method:</td>        <td>css-mle</td> 
</tr>
<tr>
       <td>Df Model:</td>              <td>5</td>               <td>Sample:</td>           <td>0</td>    
</tr>
<tr>
     <td>Df Residuals:</td>           <td>995</td>                 <td></td>               <td>0</td>    
</tr>
<tr>
      <td>Converged:</td>           <td>1.0000</td>      <td>S.D. of innovations:</td>   <td>0.958</td>  
</tr>
<tr>
    <td>No. Iterations:</td>        <td>12.0000</td>             <td>HQIC:</td>        <td>2778.184</td> 
</tr>
<tr>
         <td>AIC:</td>             <td>2766.9923</td>              <td></td>               <td></td>     
</tr>
</table>
<table class="simpletable">
<tr>
     <td></td>      <th>Coef.</th>  <th>Std.Err.</th>     <th>t</th>     <th>P>|t|</th> <th>[0.025</th>  <th>0.975]</th> 
</tr>
<tr>
  <th>const</th>   <td>0.0093</td>   <td>0.0374</td>   <td>0.2500</td>  <td>0.8026</td> <td>-0.0639</td> <td>0.0826</td> 
</tr>
<tr>
  <th>ar.L1.y</th> <td>0.7470</td>   <td>0.0279</td>   <td>26.7627</td> <td>0.0000</td> <td>0.6923</td>  <td>0.8017</td> 
</tr>
<tr>
  <th>ar.L2.y</th> <td>-0.2521</td>  <td>0.0362</td>   <td>-6.9600</td> <td>0.0000</td> <td>-0.3231</td> <td>-0.1811</td>
</tr>
<tr>
  <th>ar.L3.y</th> <td>0.1631</td>   <td>0.0362</td>   <td>4.4995</td>  <td>0.0000</td> <td>0.0920</td>  <td>0.2341</td> 
</tr>
<tr>
  <th>ar.L4.y</th> <td>-0.4699</td>  <td>0.0279</td>  <td>-16.8256</td> <td>0.0000</td> <td>-0.5247</td> <td>-0.4152</td>
</tr>
</table>
<table class="simpletable">
<tr>
    <td></td>    <th>Real</th>   <th>Imaginary</th> <th>Modulus</th> <th>Frequency</th>
</tr>
<tr>
  <th>AR.1</th> <td>0.8756</td>   <td>-0.6261</td>  <td>1.0764</td>   <td>-0.0988</td> 
</tr>
<tr>
  <th>AR.2</th> <td>0.8756</td>   <td>0.6261</td>   <td>1.0764</td>   <td>0.0988</td>  
</tr>
<tr>
  <th>AR.3</th> <td>-0.7021</td>  <td>-1.1592</td>  <td>1.3553</td>   <td>-0.3367</td> 
</tr>
<tr>
  <th>AR.4</th> <td>-0.7021</td>  <td>1.1592</td>   <td>1.3553</td>   <td>0.3367</td>  
</tr>
</table></div><img alt="../_images/3_Algorithms_ML_TS_Linear_66_1.png" src="../_images/3_Algorithms_ML_TS_Linear_66_1.png" />
<img alt="../_images/3_Algorithms_ML_TS_Linear_66_2.png" src="../_images/3_Algorithms_ML_TS_Linear_66_2.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### ARMA(0,1) = MA(1)</span>
<span class="c1"># Setting</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">123</span><span class="p">)</span>
<span class="n">ar_params</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
<span class="n">ma_params</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.65</span><span class="p">])</span>
<span class="n">index_name</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;const&#39;</span><span class="p">,</span> <span class="s1">&#39;ma(1)&#39;</span><span class="p">]</span>
<span class="n">ahead</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">ar</span><span class="p">,</span> <span class="n">ma</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="n">ar_params</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">ma_params</span><span class="p">]</span>
<span class="n">ar_order</span><span class="p">,</span> <span class="n">ma_order</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">ar</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">ma</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span>

<span class="c1"># Generator</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">statsmodels</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">arima_process</span><span class="o">.</span><span class="n">arma_generate_sample</span><span class="p">(</span><span class="n">ar</span><span class="p">,</span> <span class="n">ma</span><span class="p">,</span> <span class="n">nsample</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">burnin</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
<span class="n">fit</span> <span class="o">=</span> <span class="n">statsmodels</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">arima_model</span><span class="o">.</span><span class="n">ARMA</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="p">(</span><span class="n">ar_order</span><span class="p">,</span><span class="n">ma_order</span><span class="p">))</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">trend</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="n">disp</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">pred_ts_point</span> <span class="o">=</span> <span class="n">fit</span><span class="o">.</span><span class="n">forecast</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="n">ahead</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">pred_ts_interval</span> <span class="o">=</span> <span class="n">fit</span><span class="o">.</span><span class="n">forecast</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="n">ahead</span><span class="p">)[</span><span class="mi">2</span><span class="p">]</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">forecast_index</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">+</span><span class="n">ahead</span><span class="o">+</span><span class="mi">1</span><span class="p">)]</span>
<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">pred_ts_point</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">forecast_index</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;forecast&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">pred_ts_interval</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">forecast_index</span><span class="p">)</span><span class="o">.</span><span class="n">index</span><span class="p">,</span>
                <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">pred_ts_interval</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">forecast_index</span><span class="p">)</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span>
                <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">pred_ts_interval</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">forecast_index</span><span class="p">)</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.15</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;observed&#39;</span><span class="p">,</span> <span class="s1">&#39;forecast&#39;</span><span class="p">])</span>
<span class="n">display</span><span class="p">(</span><span class="n">fit</span><span class="o">.</span><span class="n">summary2</span><span class="p">())</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="n">statsmodels</span><span class="o">.</span><span class="n">graphics</span><span class="o">.</span><span class="n">tsaplots</span><span class="o">.</span><span class="n">plot_acf</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">zero</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">use_vlines</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">121</span><span class="p">))</span>
<span class="n">statsmodels</span><span class="o">.</span><span class="n">graphics</span><span class="o">.</span><span class="n">tsaplots</span><span class="o">.</span><span class="n">plot_pacf</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">zero</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">use_vlines</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">122</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="simpletable">
<tr>
        <td>Model:</td>              <td>ARMA</td>               <td>BIC:</td>         <td>2775.2511</td>
</tr>
<tr>
  <td>Dependent Variable:</td>         <td>y</td>           <td>Log-Likelihood:</td>    <td>-1377.3</td> 
</tr>
<tr>
         <td>Date:</td>        <td>2020-07-31 22:45</td>        <td>Scale:</td>         <td>1.0000</td>  
</tr>
<tr>
   <td>No. Observations:</td>        <td>1000</td>              <td>Method:</td>        <td>css-mle</td> 
</tr>
<tr>
       <td>Df Model:</td>              <td>2</td>               <td>Sample:</td>           <td>0</td>    
</tr>
<tr>
     <td>Df Residuals:</td>           <td>998</td>                 <td></td>               <td>0</td>    
</tr>
<tr>
      <td>Converged:</td>           <td>1.0000</td>      <td>S.D. of innovations:</td>   <td>0.959</td>  
</tr>
<tr>
    <td>No. Iterations:</td>        <td>3.0000</td>              <td>HQIC:</td>        <td>2766.124</td> 
</tr>
<tr>
         <td>AIC:</td>             <td>2760.5278</td>              <td></td>               <td></td>     
</tr>
</table>
<table class="simpletable">
<tr>
     <td></td>      <th>Coef.</th> <th>Std.Err.</th>    <th>t</th>     <th>P>|t|</th> <th>[0.025</th>  <th>0.975]</th>
</tr>
<tr>
  <th>const</th>   <td>0.0157</td>  <td>0.0500</td>  <td>0.3146</td>  <td>0.7531</td> <td>-0.0823</td> <td>0.1138</td>
</tr>
<tr>
  <th>ma.L1.y</th> <td>0.6508</td>  <td>0.0246</td>  <td>26.5050</td> <td>0.0000</td> <td>0.6027</td>  <td>0.6989</td>
</tr>
</table>
<table class="simpletable">
<tr>
    <td></td>    <th>Real</th>   <th>Imaginary</th> <th>Modulus</th> <th>Frequency</th>
</tr>
<tr>
  <th>MA.1</th> <td>-1.5365</td>  <td>0.0000</td>   <td>1.5365</td>   <td>0.5000</td>  
</tr>
</table></div><img alt="../_images/3_Algorithms_ML_TS_Linear_67_1.png" src="../_images/3_Algorithms_ML_TS_Linear_67_1.png" />
<img alt="../_images/3_Algorithms_ML_TS_Linear_67_2.png" src="../_images/3_Algorithms_ML_TS_Linear_67_2.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### ARMA(0,2) = MA(2)</span>
<span class="c1"># Setting</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">123</span><span class="p">)</span>
<span class="n">ar_params</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
<span class="n">ma_params</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.65</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.25</span><span class="p">])</span>
<span class="n">index_name</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;const&#39;</span><span class="p">,</span> <span class="s1">&#39;ma(1)&#39;</span><span class="p">,</span> <span class="s1">&#39;ma(2)&#39;</span><span class="p">]</span>
<span class="n">ahead</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">ar</span><span class="p">,</span> <span class="n">ma</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="n">ar_params</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">ma_params</span><span class="p">]</span>
<span class="n">ar_order</span><span class="p">,</span> <span class="n">ma_order</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">ar</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">ma</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span>

<span class="c1"># Generator</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">statsmodels</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">arima_process</span><span class="o">.</span><span class="n">arma_generate_sample</span><span class="p">(</span><span class="n">ar</span><span class="p">,</span> <span class="n">ma</span><span class="p">,</span> <span class="n">nsample</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">burnin</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
<span class="n">fit</span> <span class="o">=</span> <span class="n">statsmodels</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">arima_model</span><span class="o">.</span><span class="n">ARMA</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="p">(</span><span class="n">ar_order</span><span class="p">,</span><span class="n">ma_order</span><span class="p">))</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">trend</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="n">disp</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">pred_ts_point</span> <span class="o">=</span> <span class="n">fit</span><span class="o">.</span><span class="n">forecast</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="n">ahead</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">pred_ts_interval</span> <span class="o">=</span> <span class="n">fit</span><span class="o">.</span><span class="n">forecast</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="n">ahead</span><span class="p">)[</span><span class="mi">2</span><span class="p">]</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">forecast_index</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">+</span><span class="n">ahead</span><span class="o">+</span><span class="mi">1</span><span class="p">)]</span>
<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">pred_ts_point</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">forecast_index</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;forecast&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">pred_ts_interval</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">forecast_index</span><span class="p">)</span><span class="o">.</span><span class="n">index</span><span class="p">,</span>
                <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">pred_ts_interval</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">forecast_index</span><span class="p">)</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span>
                <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">pred_ts_interval</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">forecast_index</span><span class="p">)</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.15</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;observed&#39;</span><span class="p">,</span> <span class="s1">&#39;forecast&#39;</span><span class="p">])</span>
<span class="n">display</span><span class="p">(</span><span class="n">fit</span><span class="o">.</span><span class="n">summary2</span><span class="p">())</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="n">statsmodels</span><span class="o">.</span><span class="n">graphics</span><span class="o">.</span><span class="n">tsaplots</span><span class="o">.</span><span class="n">plot_acf</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">zero</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">use_vlines</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">121</span><span class="p">))</span>
<span class="n">statsmodels</span><span class="o">.</span><span class="n">graphics</span><span class="o">.</span><span class="n">tsaplots</span><span class="o">.</span><span class="n">plot_pacf</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">zero</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">use_vlines</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">122</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="simpletable">
<tr>
        <td>Model:</td>              <td>ARMA</td>               <td>BIC:</td>         <td>2783.1398</td>
</tr>
<tr>
  <td>Dependent Variable:</td>         <td>y</td>           <td>Log-Likelihood:</td>    <td>-1377.8</td> 
</tr>
<tr>
         <td>Date:</td>        <td>2020-07-31 22:45</td>        <td>Scale:</td>         <td>1.0000</td>  
</tr>
<tr>
   <td>No. Observations:</td>        <td>1000</td>              <td>Method:</td>        <td>css-mle</td> 
</tr>
<tr>
       <td>Df Model:</td>              <td>3</td>               <td>Sample:</td>           <td>0</td>    
</tr>
<tr>
     <td>Df Residuals:</td>           <td>997</td>                 <td></td>               <td>0</td>    
</tr>
<tr>
      <td>Converged:</td>           <td>1.0000</td>      <td>S.D. of innovations:</td>   <td>0.959</td>  
</tr>
<tr>
    <td>No. Iterations:</td>        <td>8.0000</td>              <td>HQIC:</td>        <td>2770.970</td> 
</tr>
<tr>
         <td>AIC:</td>             <td>2763.5088</td>              <td></td>               <td></td>     
</tr>
</table>
<table class="simpletable">
<tr>
     <td></td>      <th>Coef.</th>  <th>Std.Err.</th>    <th>t</th>     <th>P>|t|</th> <th>[0.025</th>  <th>0.975]</th> 
</tr>
<tr>
  <th>const</th>   <td>0.0130</td>   <td>0.0425</td>  <td>0.3053</td>  <td>0.7602</td> <td>-0.0703</td> <td>0.0962</td> 
</tr>
<tr>
  <th>ma.L1.y</th> <td>0.6501</td>   <td>0.0310</td>  <td>20.9416</td> <td>0.0000</td> <td>0.5892</td>  <td>0.7109</td> 
</tr>
<tr>
  <th>ma.L2.y</th> <td>-0.2487</td>  <td>0.0307</td>  <td>-8.0906</td> <td>0.0000</td> <td>-0.3090</td> <td>-0.1885</td>
</tr>
</table>
<table class="simpletable">
<tr>
    <td></td>    <th>Real</th>   <th>Imaginary</th> <th>Modulus</th> <th>Frequency</th>
</tr>
<tr>
  <th>MA.1</th> <td>-1.0865</td>  <td>0.0000</td>   <td>1.0865</td>   <td>0.5000</td>  
</tr>
<tr>
  <th>MA.2</th> <td>3.7001</td>   <td>0.0000</td>   <td>3.7001</td>   <td>0.0000</td>  
</tr>
</table></div><img alt="../_images/3_Algorithms_ML_TS_Linear_68_1.png" src="../_images/3_Algorithms_ML_TS_Linear_68_1.png" />
<img alt="../_images/3_Algorithms_ML_TS_Linear_68_2.png" src="../_images/3_Algorithms_ML_TS_Linear_68_2.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### ARMA(0,4) = MA(4)</span>
<span class="c1"># Setting</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">123</span><span class="p">)</span>
<span class="n">ar_params</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
<span class="n">ma_params</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.65</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.9</span><span class="p">])</span>
<span class="n">index_name</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;const&#39;</span><span class="p">,</span> <span class="s1">&#39;ma(1)&#39;</span><span class="p">,</span> <span class="s1">&#39;ma(2)&#39;</span><span class="p">,</span> <span class="s1">&#39;ma(3)&#39;</span><span class="p">,</span> <span class="s1">&#39;ma(4)&#39;</span><span class="p">]</span>
<span class="n">ahead</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">ar</span><span class="p">,</span> <span class="n">ma</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="n">ar_params</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">ma_params</span><span class="p">]</span>
<span class="n">ar_order</span><span class="p">,</span> <span class="n">ma_order</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">ar</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">ma</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span>

<span class="c1"># Generator</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">statsmodels</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">arima_process</span><span class="o">.</span><span class="n">arma_generate_sample</span><span class="p">(</span><span class="n">ar</span><span class="p">,</span> <span class="n">ma</span><span class="p">,</span> <span class="n">nsample</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">burnin</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
<span class="n">fit</span> <span class="o">=</span> <span class="n">statsmodels</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">arima_model</span><span class="o">.</span><span class="n">ARMA</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="p">(</span><span class="n">ar_order</span><span class="p">,</span><span class="n">ma_order</span><span class="p">))</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">trend</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="n">disp</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">pred_ts_point</span> <span class="o">=</span> <span class="n">fit</span><span class="o">.</span><span class="n">forecast</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="n">ahead</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">pred_ts_interval</span> <span class="o">=</span> <span class="n">fit</span><span class="o">.</span><span class="n">forecast</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="n">ahead</span><span class="p">)[</span><span class="mi">2</span><span class="p">]</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">forecast_index</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">+</span><span class="n">ahead</span><span class="o">+</span><span class="mi">1</span><span class="p">)]</span>
<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">pred_ts_point</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">forecast_index</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;forecast&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">pred_ts_interval</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">forecast_index</span><span class="p">)</span><span class="o">.</span><span class="n">index</span><span class="p">,</span>
                <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">pred_ts_interval</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">forecast_index</span><span class="p">)</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span>
                <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">pred_ts_interval</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">forecast_index</span><span class="p">)</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.15</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;observed&#39;</span><span class="p">,</span> <span class="s1">&#39;forecast&#39;</span><span class="p">])</span>
<span class="n">display</span><span class="p">(</span><span class="n">fit</span><span class="o">.</span><span class="n">summary2</span><span class="p">())</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="n">statsmodels</span><span class="o">.</span><span class="n">graphics</span><span class="o">.</span><span class="n">tsaplots</span><span class="o">.</span><span class="n">plot_acf</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">zero</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">use_vlines</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">121</span><span class="p">))</span>
<span class="n">statsmodels</span><span class="o">.</span><span class="n">graphics</span><span class="o">.</span><span class="n">tsaplots</span><span class="o">.</span><span class="n">plot_pacf</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">zero</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">use_vlines</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">122</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="simpletable">
<tr>
        <td>Model:</td>              <td>ARMA</td>               <td>BIC:</td>         <td>3472.2476</td>
</tr>
<tr>
  <td>Dependent Variable:</td>         <td>y</td>           <td>Log-Likelihood:</td>    <td>-1715.4</td> 
</tr>
<tr>
         <td>Date:</td>        <td>2020-07-31 22:45</td>        <td>Scale:</td>         <td>1.0000</td>  
</tr>
<tr>
   <td>No. Observations:</td>        <td>1000</td>              <td>Method:</td>        <td>css-mle</td> 
</tr>
<tr>
       <td>Df Model:</td>              <td>5</td>               <td>Sample:</td>           <td>0</td>    
</tr>
<tr>
     <td>Df Residuals:</td>           <td>995</td>                 <td></td>               <td>0</td>    
</tr>
<tr>
      <td>Converged:</td>           <td>1.0000</td>      <td>S.D. of innovations:</td>   <td>1.344</td>  
</tr>
<tr>
    <td>No. Iterations:</td>        <td>12.0000</td>             <td>HQIC:</td>        <td>3453.993</td> 
</tr>
<tr>
         <td>AIC:</td>             <td>3442.8011</td>              <td></td>               <td></td>     
</tr>
</table>
<table class="simpletable">
<tr>
     <td></td>      <th>Coef.</th>  <th>Std.Err.</th>     <th>t</th>     <th>P>|t|</th> <th>[0.025</th>  <th>0.975]</th> 
</tr>
<tr>
  <th>const</th>   <td>0.0079</td>   <td>0.0297</td>   <td>0.2653</td>  <td>0.7908</td> <td>-0.0504</td> <td>0.0662</td> 
</tr>
<tr>
  <th>ma.L1.y</th> <td>-0.0418</td>  <td>0.0275</td>   <td>-1.5186</td> <td>0.1289</td> <td>-0.0957</td> <td>0.0121</td> 
</tr>
<tr>
  <th>ma.L2.y</th> <td>0.2823</td>   <td>0.0276</td>   <td>10.2186</td> <td>0.0000</td> <td>0.2282</td>  <td>0.3365</td> 
</tr>
<tr>
  <th>ma.L3.y</th> <td>-0.0569</td>  <td>0.0273</td>   <td>-2.0805</td> <td>0.0375</td> <td>-0.1105</td> <td>-0.0033</td>
</tr>
<tr>
  <th>ma.L4.y</th> <td>-0.4858</td>  <td>0.0279</td>  <td>-17.4311</td> <td>0.0000</td> <td>-0.5404</td> <td>-0.4311</td>
</tr>
</table>
<table class="simpletable">
<tr>
    <td></td>    <th>Real</th>   <th>Imaginary</th> <th>Modulus</th> <th>Frequency</th>
</tr>
<tr>
  <th>MA.1</th> <td>1.2761</td>   <td>-0.0000</td>  <td>1.2761</td>   <td>-0.0000</td> 
</tr>
<tr>
  <th>MA.2</th> <td>-0.0088</td>  <td>-1.0828</td>  <td>1.0829</td>   <td>-0.2513</td> 
</tr>
<tr>
  <th>MA.3</th> <td>-0.0088</td>  <td>1.0828</td>   <td>1.0829</td>   <td>0.2513</td>  
</tr>
<tr>
  <th>MA.4</th> <td>-1.3757</td>  <td>-0.0000</td>  <td>1.3757</td>   <td>-0.5000</td> 
</tr>
</table></div><img alt="../_images/3_Algorithms_ML_TS_Linear_69_1.png" src="../_images/3_Algorithms_ML_TS_Linear_69_1.png" />
<img alt="../_images/3_Algorithms_ML_TS_Linear_69_2.png" src="../_images/3_Algorithms_ML_TS_Linear_69_2.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### ARMA(1,1)</span>
<span class="c1"># Setting</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">123</span><span class="p">)</span>
<span class="n">ar_params</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.75</span><span class="p">])</span>
<span class="n">ma_params</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.65</span><span class="p">])</span>
<span class="n">index_name</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;const&#39;</span><span class="p">,</span> <span class="s1">&#39;ar(1)&#39;</span><span class="p">,</span> <span class="s1">&#39;ma(1)&#39;</span><span class="p">]</span>
<span class="n">ahead</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">ar</span><span class="p">,</span> <span class="n">ma</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="n">ar_params</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">ma_params</span><span class="p">]</span>
<span class="n">ar_order</span><span class="p">,</span> <span class="n">ma_order</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">ar</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">ma</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span>

<span class="c1"># Generator</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">statsmodels</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">arima_process</span><span class="o">.</span><span class="n">arma_generate_sample</span><span class="p">(</span><span class="n">ar</span><span class="p">,</span> <span class="n">ma</span><span class="p">,</span> <span class="n">nsample</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">burnin</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
<span class="n">fit</span> <span class="o">=</span> <span class="n">statsmodels</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">arima_model</span><span class="o">.</span><span class="n">ARMA</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="p">(</span><span class="n">ar_order</span><span class="p">,</span><span class="n">ma_order</span><span class="p">))</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">trend</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="n">disp</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">pred_ts_point</span> <span class="o">=</span> <span class="n">fit</span><span class="o">.</span><span class="n">forecast</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="n">ahead</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">pred_ts_interval</span> <span class="o">=</span> <span class="n">fit</span><span class="o">.</span><span class="n">forecast</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="n">ahead</span><span class="p">)[</span><span class="mi">2</span><span class="p">]</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">forecast_index</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">+</span><span class="n">ahead</span><span class="o">+</span><span class="mi">1</span><span class="p">)]</span>
<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">pred_ts_point</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">forecast_index</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;forecast&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">pred_ts_interval</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">forecast_index</span><span class="p">)</span><span class="o">.</span><span class="n">index</span><span class="p">,</span>
                <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">pred_ts_interval</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">forecast_index</span><span class="p">)</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span>
                <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">pred_ts_interval</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">forecast_index</span><span class="p">)</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.15</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;observed&#39;</span><span class="p">,</span> <span class="s1">&#39;forecast&#39;</span><span class="p">])</span>
<span class="n">display</span><span class="p">(</span><span class="n">fit</span><span class="o">.</span><span class="n">summary2</span><span class="p">())</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="n">statsmodels</span><span class="o">.</span><span class="n">graphics</span><span class="o">.</span><span class="n">tsaplots</span><span class="o">.</span><span class="n">plot_acf</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">zero</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">use_vlines</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">121</span><span class="p">))</span>
<span class="n">statsmodels</span><span class="o">.</span><span class="n">graphics</span><span class="o">.</span><span class="n">tsaplots</span><span class="o">.</span><span class="n">plot_pacf</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">zero</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">use_vlines</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">122</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="simpletable">
<tr>
        <td>Model:</td>              <td>ARMA</td>               <td>BIC:</td>         <td>2783.7601</td>
</tr>
<tr>
  <td>Dependent Variable:</td>         <td>y</td>           <td>Log-Likelihood:</td>    <td>-1378.1</td> 
</tr>
<tr>
         <td>Date:</td>        <td>2020-07-31 22:45</td>        <td>Scale:</td>         <td>1.0000</td>  
</tr>
<tr>
   <td>No. Observations:</td>        <td>1000</td>              <td>Method:</td>        <td>css-mle</td> 
</tr>
<tr>
       <td>Df Model:</td>              <td>3</td>               <td>Sample:</td>           <td>0</td>    
</tr>
<tr>
     <td>Df Residuals:</td>           <td>997</td>                 <td></td>               <td>0</td>    
</tr>
<tr>
      <td>Converged:</td>           <td>1.0000</td>      <td>S.D. of innovations:</td>   <td>0.959</td>  
</tr>
<tr>
    <td>No. Iterations:</td>        <td>9.0000</td>              <td>HQIC:</td>        <td>2771.590</td> 
</tr>
<tr>
         <td>AIC:</td>             <td>2764.1291</td>              <td></td>               <td></td>     
</tr>
</table>
<table class="simpletable">
<tr>
     <td></td>      <th>Coef.</th> <th>Std.Err.</th>    <th>t</th>     <th>P>|t|</th> <th>[0.025</th>  <th>0.975]</th>
</tr>
<tr>
  <th>const</th>   <td>0.0641</td>  <td>0.1970</td>  <td>0.3252</td>  <td>0.7450</td> <td>-0.3220</td> <td>0.4501</td>
</tr>
<tr>
  <th>ar.L1.y</th> <td>0.7465</td>  <td>0.0224</td>  <td>33.3502</td> <td>0.0000</td> <td>0.7027</td>  <td>0.7904</td>
</tr>
<tr>
  <th>ma.L1.y</th> <td>0.6519</td>  <td>0.0261</td>  <td>24.9637</td> <td>0.0000</td> <td>0.6007</td>  <td>0.7031</td>
</tr>
</table>
<table class="simpletable">
<tr>
    <td></td>    <th>Real</th>   <th>Imaginary</th> <th>Modulus</th> <th>Frequency</th>
</tr>
<tr>
  <th>AR.1</th> <td>1.3395</td>   <td>0.0000</td>   <td>1.3395</td>   <td>0.0000</td>  
</tr>
<tr>
  <th>MA.1</th> <td>-1.5340</td>  <td>0.0000</td>   <td>1.5340</td>   <td>0.5000</td>  
</tr>
</table></div><img alt="../_images/3_Algorithms_ML_TS_Linear_70_1.png" src="../_images/3_Algorithms_ML_TS_Linear_70_1.png" />
<img alt="../_images/3_Algorithms_ML_TS_Linear_70_2.png" src="../_images/3_Algorithms_ML_TS_Linear_70_2.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### ARMA(2,2)</span>
<span class="c1"># Setting</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">123</span><span class="p">)</span>
<span class="n">ar_params</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.75</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.25</span><span class="p">])</span>
<span class="n">ma_params</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.65</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">])</span>
<span class="n">index_name</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;const&#39;</span><span class="p">,</span> <span class="s1">&#39;ar(1)&#39;</span><span class="p">,</span> <span class="s1">&#39;ar(2)&#39;</span><span class="p">,</span> <span class="s1">&#39;ma(1)&#39;</span><span class="p">,</span> <span class="s1">&#39;ma(2)&#39;</span><span class="p">]</span>
<span class="n">ahead</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">ar</span><span class="p">,</span> <span class="n">ma</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="n">ar_params</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">ma_params</span><span class="p">]</span>
<span class="n">ar_order</span><span class="p">,</span> <span class="n">ma_order</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">ar</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">ma</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span>

<span class="c1"># Generator</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">statsmodels</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">arima_process</span><span class="o">.</span><span class="n">arma_generate_sample</span><span class="p">(</span><span class="n">ar</span><span class="p">,</span> <span class="n">ma</span><span class="p">,</span> <span class="n">nsample</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">burnin</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
<span class="n">fit</span> <span class="o">=</span> <span class="n">statsmodels</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">arima_model</span><span class="o">.</span><span class="n">ARMA</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="p">(</span><span class="n">ar_order</span><span class="p">,</span><span class="n">ma_order</span><span class="p">))</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">trend</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="n">disp</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">pred_ts_point</span> <span class="o">=</span> <span class="n">fit</span><span class="o">.</span><span class="n">forecast</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="n">ahead</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">pred_ts_interval</span> <span class="o">=</span> <span class="n">fit</span><span class="o">.</span><span class="n">forecast</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="n">ahead</span><span class="p">)[</span><span class="mi">2</span><span class="p">]</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">forecast_index</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">+</span><span class="n">ahead</span><span class="o">+</span><span class="mi">1</span><span class="p">)]</span>
<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">pred_ts_point</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">forecast_index</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;forecast&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">pred_ts_interval</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">forecast_index</span><span class="p">)</span><span class="o">.</span><span class="n">index</span><span class="p">,</span>
                <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">pred_ts_interval</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">forecast_index</span><span class="p">)</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span>
                <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">pred_ts_interval</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">forecast_index</span><span class="p">)</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.15</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;observed&#39;</span><span class="p">,</span> <span class="s1">&#39;forecast&#39;</span><span class="p">])</span>
<span class="n">display</span><span class="p">(</span><span class="n">fit</span><span class="o">.</span><span class="n">summary2</span><span class="p">())</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="n">statsmodels</span><span class="o">.</span><span class="n">graphics</span><span class="o">.</span><span class="n">tsaplots</span><span class="o">.</span><span class="n">plot_acf</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">zero</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">use_vlines</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">121</span><span class="p">))</span>
<span class="n">statsmodels</span><span class="o">.</span><span class="n">graphics</span><span class="o">.</span><span class="n">tsaplots</span><span class="o">.</span><span class="n">plot_pacf</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">zero</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">use_vlines</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">122</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="simpletable">
<tr>
        <td>Model:</td>              <td>ARMA</td>               <td>BIC:</td>         <td>2796.4977</td>
</tr>
<tr>
  <td>Dependent Variable:</td>         <td>y</td>           <td>Log-Likelihood:</td>    <td>-1377.5</td> 
</tr>
<tr>
         <td>Date:</td>        <td>2020-07-31 22:45</td>        <td>Scale:</td>         <td>1.0000</td>  
</tr>
<tr>
   <td>No. Observations:</td>        <td>1000</td>              <td>Method:</td>        <td>css-mle</td> 
</tr>
<tr>
       <td>Df Model:</td>              <td>5</td>               <td>Sample:</td>           <td>0</td>    
</tr>
<tr>
     <td>Df Residuals:</td>           <td>995</td>                 <td></td>               <td>0</td>    
</tr>
<tr>
      <td>Converged:</td>           <td>1.0000</td>      <td>S.D. of innovations:</td>   <td>0.958</td>  
</tr>
<tr>
    <td>No. Iterations:</td>        <td>12.0000</td>             <td>HQIC:</td>        <td>2778.243</td> 
</tr>
<tr>
         <td>AIC:</td>             <td>2767.0512</td>              <td></td>               <td></td>     
</tr>
</table>
<table class="simpletable">
<tr>
     <td></td>      <th>Coef.</th>  <th>Std.Err.</th>    <th>t</th>     <th>P>|t|</th> <th>[0.025</th>  <th>0.975]</th> 
</tr>
<tr>
  <th>const</th>   <td>0.0415</td>   <td>0.1265</td>  <td>0.3283</td>  <td>0.7427</td> <td>-0.2065</td> <td>0.2895</td> 
</tr>
<tr>
  <th>ar.L1.y</th> <td>0.7472</td>   <td>0.0597</td>  <td>12.5090</td> <td>0.0000</td> <td>0.6301</td>  <td>0.8643</td> 
</tr>
<tr>
  <th>ar.L2.y</th> <td>-0.2675</td>  <td>0.0518</td>  <td>-5.1626</td> <td>0.0000</td> <td>-0.3691</td> <td>-0.1660</td>
</tr>
<tr>
  <th>ma.L1.y</th> <td>0.6544</td>   <td>0.0553</td>  <td>11.8393</td> <td>0.0000</td> <td>0.5460</td>  <td>0.7627</td> 
</tr>
<tr>
  <th>ma.L2.y</th> <td>0.5209</td>   <td>0.0384</td>  <td>13.5542</td> <td>0.0000</td> <td>0.4456</td>  <td>0.5963</td> 
</tr>
</table>
<table class="simpletable">
<tr>
    <td></td>    <th>Real</th>   <th>Imaginary</th> <th>Modulus</th> <th>Frequency</th>
</tr>
<tr>
  <th>AR.1</th> <td>1.3966</td>   <td>-1.3371</td>  <td>1.9334</td>   <td>-0.1215</td> 
</tr>
<tr>
  <th>AR.2</th> <td>1.3966</td>   <td>1.3371</td>   <td>1.9334</td>   <td>0.1215</td>  
</tr>
<tr>
  <th>MA.1</th> <td>-0.6281</td>  <td>-1.2350</td>  <td>1.3855</td>   <td>-0.3249</td> 
</tr>
<tr>
  <th>MA.2</th> <td>-0.6281</td>  <td>1.2350</td>   <td>1.3855</td>   <td>0.3249</td>  
</tr>
</table></div><img alt="../_images/3_Algorithms_ML_TS_Linear_71_1.png" src="../_images/3_Algorithms_ML_TS_Linear_71_1.png" />
<img alt="../_images/3_Algorithms_ML_TS_Linear_71_2.png" src="../_images/3_Algorithms_ML_TS_Linear_71_2.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### ARMA(5,5)</span>
<span class="c1"># Setting</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">123</span><span class="p">)</span>
<span class="n">ar_params</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.75</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1</span><span class="p">])</span>
<span class="n">ma_params</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.65</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1</span><span class="p">])</span>
<span class="n">index_name</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;const&#39;</span><span class="p">,</span> <span class="s1">&#39;ar(1)&#39;</span><span class="p">,</span> <span class="s1">&#39;ar(2)&#39;</span><span class="p">,</span> <span class="s1">&#39;ar(3)&#39;</span><span class="p">,</span> <span class="s1">&#39;ar(4)&#39;</span><span class="p">,</span> <span class="s1">&#39;ar(5)&#39;</span><span class="p">,</span> <span class="s1">&#39;ma(1)&#39;</span><span class="p">,</span> <span class="s1">&#39;ma(2)&#39;</span><span class="p">,</span> <span class="s1">&#39;ma(3)&#39;</span><span class="p">,</span> <span class="s1">&#39;ma(4)&#39;</span><span class="p">,</span> <span class="s1">&#39;ma(5)&#39;</span><span class="p">]</span>
<span class="n">ahead</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">ar</span><span class="p">,</span> <span class="n">ma</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="n">ar_params</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">ma_params</span><span class="p">]</span>
<span class="n">ar_order</span><span class="p">,</span> <span class="n">ma_order</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">ar</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">ma</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span>

<span class="c1"># Generator</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">statsmodels</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">arima_process</span><span class="o">.</span><span class="n">arma_generate_sample</span><span class="p">(</span><span class="n">ar</span><span class="p">,</span> <span class="n">ma</span><span class="p">,</span> <span class="n">nsample</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">burnin</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
<span class="n">fit</span> <span class="o">=</span> <span class="n">statsmodels</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">arima_model</span><span class="o">.</span><span class="n">ARMA</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="p">(</span><span class="n">ar_order</span><span class="p">,</span><span class="n">ma_order</span><span class="p">))</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">trend</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="n">disp</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">pred_ts_point</span> <span class="o">=</span> <span class="n">fit</span><span class="o">.</span><span class="n">forecast</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="n">ahead</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">pred_ts_interval</span> <span class="o">=</span> <span class="n">fit</span><span class="o">.</span><span class="n">forecast</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="n">ahead</span><span class="p">)[</span><span class="mi">2</span><span class="p">]</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">forecast_index</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">+</span><span class="n">ahead</span><span class="o">+</span><span class="mi">1</span><span class="p">)]</span>
<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">pred_ts_point</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">forecast_index</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;forecast&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">pred_ts_interval</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">forecast_index</span><span class="p">)</span><span class="o">.</span><span class="n">index</span><span class="p">,</span>
                <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">pred_ts_interval</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">forecast_index</span><span class="p">)</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span>
                <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">pred_ts_interval</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">forecast_index</span><span class="p">)</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.15</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;observed&#39;</span><span class="p">,</span> <span class="s1">&#39;forecast&#39;</span><span class="p">])</span>
<span class="n">display</span><span class="p">(</span><span class="n">fit</span><span class="o">.</span><span class="n">summary2</span><span class="p">())</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="n">statsmodels</span><span class="o">.</span><span class="n">graphics</span><span class="o">.</span><span class="n">tsaplots</span><span class="o">.</span><span class="n">plot_acf</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">zero</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">use_vlines</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">121</span><span class="p">))</span>
<span class="n">statsmodels</span><span class="o">.</span><span class="n">graphics</span><span class="o">.</span><span class="n">tsaplots</span><span class="o">.</span><span class="n">plot_pacf</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">zero</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">use_vlines</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">122</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># ACF가 오히려 증가되는 이유는?</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="simpletable">
<tr>
        <td>Model:</td>              <td>ARMA</td>               <td>BIC:</td>         <td>2844.4865</td>
</tr>
<tr>
  <td>Dependent Variable:</td>         <td>y</td>           <td>Log-Likelihood:</td>    <td>-1380.8</td> 
</tr>
<tr>
         <td>Date:</td>        <td>2020-07-31 22:46</td>        <td>Scale:</td>         <td>1.0000</td>  
</tr>
<tr>
   <td>No. Observations:</td>        <td>1000</td>              <td>Method:</td>        <td>css-mle</td> 
</tr>
<tr>
       <td>Df Model:</td>             <td>11</td>               <td>Sample:</td>           <td>0</td>    
</tr>
<tr>
     <td>Df Residuals:</td>           <td>989</td>                 <td></td>               <td>0</td>    
</tr>
<tr>
      <td>Converged:</td>           <td>1.0000</td>      <td>S.D. of innovations:</td>   <td>0.959</td>  
</tr>
<tr>
    <td>No. Iterations:</td>        <td>52.0000</td>             <td>HQIC:</td>        <td>2807.977</td> 
</tr>
<tr>
         <td>AIC:</td>             <td>2785.5934</td>              <td></td>               <td></td>     
</tr>
</table>
<table class="simpletable">
<tr>
     <td></td>      <th>Coef.</th>  <th>Std.Err.</th>    <th>t</th>     <th>P>|t|</th> <th>[0.025</th>  <th>0.975]</th> 
</tr>
<tr>
  <th>const</th>   <td>0.0308</td>   <td>0.0864</td>  <td>0.3569</td>  <td>0.7212</td> <td>-0.1386</td> <td>0.2003</td> 
</tr>
<tr>
  <th>ar.L1.y</th> <td>1.3387</td>   <td>0.4949</td>  <td>2.7049</td>  <td>0.0068</td> <td>0.3687</td>  <td>2.3087</td> 
</tr>
<tr>
  <th>ar.L2.y</th> <td>-0.7833</td>  <td>0.4780</td>  <td>-1.6387</td> <td>0.1013</td> <td>-1.7202</td> <td>0.1536</td> 
</tr>
<tr>
  <th>ar.L3.y</th> <td>0.7138</td>   <td>0.2246</td>  <td>3.1786</td>  <td>0.0015</td> <td>0.2737</td>  <td>1.1540</td> 
</tr>
<tr>
  <th>ar.L4.y</th> <td>-0.7758</td>  <td>0.2729</td>  <td>-2.8428</td> <td>0.0045</td> <td>-1.3106</td> <td>-0.2409</td>
</tr>
<tr>
  <th>ar.L5.y</th> <td>0.2339</td>   <td>0.2687</td>  <td>0.8705</td>  <td>0.3840</td> <td>-0.2927</td> <td>0.7604</td> 
</tr>
<tr>
  <th>ma.L1.y</th> <td>0.0678</td>   <td>0.4967</td>  <td>0.1365</td>  <td>0.8914</td> <td>-0.9057</td> <td>1.0413</td> 
</tr>
<tr>
  <th>ma.L2.y</th> <td>0.2093</td>   <td>0.2164</td>  <td>0.9674</td>  <td>0.3334</td> <td>-0.2148</td> <td>0.6334</td> 
</tr>
<tr>
  <th>ma.L3.y</th> <td>-0.0514</td>  <td>0.1982</td>  <td>-0.2592</td> <td>0.7955</td> <td>-0.4398</td> <td>0.3371</td> 
</tr>
<tr>
  <th>ma.L4.y</th> <td>-0.6159</td>  <td>0.0713</td>  <td>-8.6360</td> <td>0.0000</td> <td>-0.7557</td> <td>-0.4762</td>
</tr>
<tr>
  <th>ma.L5.y</th> <td>0.1658</td>   <td>0.2752</td>  <td>0.6027</td>  <td>0.5467</td> <td>-0.3735</td> <td>0.7052</td> 
</tr>
</table>
<table class="simpletable">
<tr>
    <td></td>    <th>Real</th>   <th>Imaginary</th> <th>Modulus</th> <th>Frequency</th>
</tr>
<tr>
  <th>AR.1</th> <td>-0.4994</td>  <td>-1.1024</td>  <td>1.2103</td>   <td>-0.3177</td> 
</tr>
<tr>
  <th>AR.2</th> <td>-0.4994</td>  <td>1.1024</td>   <td>1.2103</td>   <td>0.3177</td>  
</tr>
<tr>
  <th>AR.3</th> <td>1.0036</td>   <td>-0.5072</td>  <td>1.1245</td>   <td>-0.0745</td> 
</tr>
<tr>
  <th>AR.4</th> <td>1.0036</td>   <td>0.5072</td>   <td>1.1245</td>   <td>0.0745</td>  
</tr>
<tr>
  <th>AR.5</th> <td>2.3086</td>   <td>-0.0000</td>  <td>2.3086</td>   <td>-0.0000</td> 
</tr>
<tr>
  <th>MA.1</th> <td>-1.1194</td>  <td>-0.0000</td>  <td>1.1194</td>   <td>-0.5000</td> 
</tr>
<tr>
  <th>MA.2</th> <td>-0.0971</td>  <td>-1.0335</td>  <td>1.0381</td>   <td>-0.2649</td> 
</tr>
<tr>
  <th>MA.3</th> <td>-0.0971</td>  <td>1.0335</td>   <td>1.0381</td>   <td>0.2649</td>  
</tr>
<tr>
  <th>MA.4</th> <td>1.3648</td>   <td>-0.0000</td>  <td>1.3648</td>   <td>-0.0000</td> 
</tr>
<tr>
  <th>MA.5</th> <td>3.6627</td>   <td>-0.0000</td>  <td>3.6627</td>   <td>-0.0000</td> 
</tr>
</table></div><img alt="../_images/3_Algorithms_ML_TS_Linear_72_1.png" src="../_images/3_Algorithms_ML_TS_Linear_72_1.png" />
<img alt="../_images/3_Algorithms_ML_TS_Linear_72_2.png" src="../_images/3_Algorithms_ML_TS_Linear_72_2.png" />
</div>
</div>
</div>
<div class="section" id="id11">
<h3>모형 차수결정 정리<a class="headerlink" href="#id11" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><p><strong>1) 추정 및 예측을 하기 전에 파라미터에 따라 모형이 어떠한 결과를 도출할지 이해(예상) 필요</strong><br />
<strong>2) 결과이해(예상)는 기계의 실수를 방지하고 결과의 확신을 증가시킴</strong></p>
</div></blockquote>
<ul class="simple">
<li><p><strong><span class="math notranslate nohighlight">\(p\)</span>, <span class="math notranslate nohighlight">\(q\)</span> 파라미터 추론(by ACF and PACF):</strong></p></li>
</ul>
<ol class="simple">
<li><p>정상성 형태 변환: 차분/로그변환/계절성제거 등을 통해 데이터를 정상성 형태로 변환</p></li>
<li><p><span class="math notranslate nohighlight">\(ACF\)</span>, <span class="math notranslate nohighlight">\(PACF\)</span>를 도식화 하여 ARMA의 파라미터 차수를 추론</p></li>
</ol>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>-</p></th>
<th class="head"><p>자기회귀: <span class="math notranslate nohighlight">\(AR(p)\)</span></p></th>
<th class="head"><p>이동평균: <span class="math notranslate nohighlight">\(MA(q)\)</span></p></th>
<th class="head"><p>자기회귀이동평균: <span class="math notranslate nohighlight">\(ARMA(p,q)\)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(ACF\)</span></p></td>
<td><p>지수적 감소, 진동하는 사인 형태</p></td>
<td><p><span class="math notranslate nohighlight">\(q+1\)</span> 차항부터 절단모양(0수렴)</p></td>
<td><p><span class="math notranslate nohighlight">\(q+1\)</span> 차항부터 지수적 감소 혹은 진동하는 사인형태</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(PACF\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(p+1\)</span> 차항부터 절단모양(0수렴)</p></td>
<td><p>지수적 감소, 진동하는 사인 형태</p></td>
<td><p><span class="math notranslate nohighlight">\(p+1\)</span> 차항부터 지수적 감소 혹은 진동하는 사인형태</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="arma">
<h3>실습: 항체형성 호르몬수지 ARMA 모델링<a class="headerlink" href="#arma" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="nn">sm</span>

<span class="c1"># 데이터로딩 및 확인</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">get_rdataset</span><span class="p">(</span><span class="s2">&quot;lh&quot;</span><span class="p">)</span>
<span class="n">raw</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">data</span>
<span class="n">raw</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;value&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># ACF/PACF 확인</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">sm</span><span class="o">.</span><span class="n">graphics</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">plot_acf</span><span class="p">(</span><span class="n">raw</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">211</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;ACF&quot;</span><span class="p">)</span>

<span class="n">sm</span><span class="o">.</span><span class="n">graphics</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">plot_pacf</span><span class="p">(</span><span class="n">raw</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">212</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;PACF&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># MA(1) 모델링</span>
<span class="n">fit</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">ARMA</span><span class="p">(</span><span class="n">raw</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">display</span><span class="p">(</span><span class="n">fit</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>

<span class="c1"># AR(1) 모델링</span>
<span class="n">fit</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">ARMA</span><span class="p">(</span><span class="n">raw</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">display</span><span class="p">(</span><span class="n">fit</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>

<span class="c1"># ARMA(1,1) 모델링</span>
<span class="n">fit</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">ARMA</span><span class="p">(</span><span class="n">raw</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">display</span><span class="p">(</span><span class="n">fit</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/3_Algorithms_ML_TS_Linear_75_0.png" src="../_images/3_Algorithms_ML_TS_Linear_75_0.png" />
<img alt="../_images/3_Algorithms_ML_TS_Linear_75_1.png" src="../_images/3_Algorithms_ML_TS_Linear_75_1.png" />
<div class="output text_html"><table class="simpletable">
<caption>ARMA Model Results</caption>
<tr>
  <th>Dep. Variable:</th>       <td>value</td>      <th>  No. Observations:  </th>   <td>48</td>   
</tr>
<tr>
  <th>Model:</th>            <td>ARMA(0, 1)</td>    <th>  Log Likelihood     </th> <td>-31.052</td>
</tr>
<tr>
  <th>Method:</th>             <td>css-mle</td>     <th>  S.D. of innovations</th>  <td>0.461</td> 
</tr>
<tr>
  <th>Date:</th>          <td>Fri, 31 Jul 2020</td> <th>  AIC                </th> <td>68.104</td> 
</tr>
<tr>
  <th>Time:</th>              <td>22:46:04</td>     <th>  BIC                </th> <td>73.717</td> 
</tr>
<tr>
  <th>Sample:</th>                <td>0</td>        <th>  HQIC               </th> <td>70.225</td> 
</tr>
<tr>
  <th></th>                       <td> </td>        <th>                     </th>    <td> </td>   
</tr>
</table>
<table class="simpletable">
<tr>
       <td></td>          <th>coef</th>     <th>std err</th>      <th>z</th>      <th>P>|z|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>const</th>       <td>    2.4050</td> <td>    0.098</td> <td>   24.576</td> <td> 0.000</td> <td>    2.213</td> <td>    2.597</td>
</tr>
<tr>
  <th>ma.L1.value</th> <td>    0.4810</td> <td>    0.094</td> <td>    5.093</td> <td> 0.000</td> <td>    0.296</td> <td>    0.666</td>
</tr>
</table>
<table class="simpletable">
<caption>Roots</caption>
<tr>
    <td></td>   <th>            Real</th>  <th>         Imaginary</th> <th>         Modulus</th>  <th>        Frequency</th>
</tr>
<tr>
  <th>MA.1</th> <td>          -2.0790</td> <td>          +0.0000j</td> <td>           2.0790</td> <td>           0.5000</td>
</tr>
</table></div><div class="output text_html"><table class="simpletable">
<caption>ARMA Model Results</caption>
<tr>
  <th>Dep. Variable:</th>       <td>value</td>      <th>  No. Observations:  </th>   <td>48</td>   
</tr>
<tr>
  <th>Model:</th>            <td>ARMA(1, 0)</td>    <th>  Log Likelihood     </th> <td>-29.379</td>
</tr>
<tr>
  <th>Method:</th>             <td>css-mle</td>     <th>  S.D. of innovations</th>  <td>0.444</td> 
</tr>
<tr>
  <th>Date:</th>          <td>Fri, 31 Jul 2020</td> <th>  AIC                </th> <td>64.758</td> 
</tr>
<tr>
  <th>Time:</th>              <td>22:46:04</td>     <th>  BIC                </th> <td>70.372</td> 
</tr>
<tr>
  <th>Sample:</th>                <td>0</td>        <th>  HQIC               </th> <td>66.880</td> 
</tr>
<tr>
  <th></th>                       <td> </td>        <th>                     </th>    <td> </td>   
</tr>
</table>
<table class="simpletable">
<tr>
       <td></td>          <th>coef</th>     <th>std err</th>      <th>z</th>      <th>P>|z|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>const</th>       <td>    2.4133</td> <td>    0.147</td> <td>   16.460</td> <td> 0.000</td> <td>    2.126</td> <td>    2.701</td>
</tr>
<tr>
  <th>ar.L1.value</th> <td>    0.5739</td> <td>    0.116</td> <td>    4.939</td> <td> 0.000</td> <td>    0.346</td> <td>    0.802</td>
</tr>
</table>
<table class="simpletable">
<caption>Roots</caption>
<tr>
    <td></td>   <th>            Real</th>  <th>         Imaginary</th> <th>         Modulus</th>  <th>        Frequency</th>
</tr>
<tr>
  <th>AR.1</th> <td>           1.7424</td> <td>          +0.0000j</td> <td>           1.7424</td> <td>           0.0000</td>
</tr>
</table></div><div class="output text_html"><table class="simpletable">
<caption>ARMA Model Results</caption>
<tr>
  <th>Dep. Variable:</th>       <td>value</td>      <th>  No. Observations:  </th>   <td>48</td>   
</tr>
<tr>
  <th>Model:</th>            <td>ARMA(1, 1)</td>    <th>  Log Likelihood     </th> <td>-28.762</td>
</tr>
<tr>
  <th>Method:</th>             <td>css-mle</td>     <th>  S.D. of innovations</th>  <td>0.439</td> 
</tr>
<tr>
  <th>Date:</th>          <td>Fri, 31 Jul 2020</td> <th>  AIC                </th> <td>65.524</td> 
</tr>
<tr>
  <th>Time:</th>              <td>22:46:04</td>     <th>  BIC                </th> <td>73.009</td> 
</tr>
<tr>
  <th>Sample:</th>                <td>0</td>        <th>  HQIC               </th> <td>68.353</td> 
</tr>
<tr>
  <th></th>                       <td> </td>        <th>                     </th>    <td> </td>   
</tr>
</table>
<table class="simpletable">
<tr>
       <td></td>          <th>coef</th>     <th>std err</th>      <th>z</th>      <th>P>|z|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>const</th>       <td>    2.4101</td> <td>    0.136</td> <td>   17.754</td> <td> 0.000</td> <td>    2.144</td> <td>    2.676</td>
</tr>
<tr>
  <th>ar.L1.value</th> <td>    0.4522</td> <td>    0.177</td> <td>    2.556</td> <td> 0.011</td> <td>    0.105</td> <td>    0.799</td>
</tr>
<tr>
  <th>ma.L1.value</th> <td>    0.1982</td> <td>    0.171</td> <td>    1.162</td> <td> 0.245</td> <td>   -0.136</td> <td>    0.532</td>
</tr>
</table>
<table class="simpletable">
<caption>Roots</caption>
<tr>
    <td></td>   <th>            Real</th>  <th>         Imaginary</th> <th>         Modulus</th>  <th>        Frequency</th>
</tr>
<tr>
  <th>AR.1</th> <td>           2.2114</td> <td>          +0.0000j</td> <td>           2.2114</td> <td>           0.0000</td>
</tr>
<tr>
  <th>MA.1</th> <td>          -5.0462</td> <td>          +0.0000j</td> <td>           5.0462</td> <td>           0.5000</td>
</tr>
</table></div></div>
</div>
</div>
<div class="section" id="id12">
<h3>실습: 호흡기질환 사망자수 ARMA 모델링<a class="headerlink" href="#id12" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;always&#39;</span><span class="p">)</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>

<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="nn">sm</span>

<span class="c1"># 데이터로딩 및 확인</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">get_rdataset</span><span class="p">(</span><span class="s2">&quot;deaths&quot;</span><span class="p">,</span> <span class="s2">&quot;MASS&quot;</span><span class="p">)</span>
<span class="n">raw</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">data</span>
<span class="n">raw</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">raw</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
<span class="n">raw</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;value&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># ACF/PACF 확인</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">sm</span><span class="o">.</span><span class="n">graphics</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">plot_acf</span><span class="p">(</span><span class="n">raw</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">211</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">51</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;ACF&quot;</span><span class="p">)</span>

<span class="n">sm</span><span class="o">.</span><span class="n">graphics</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">plot_pacf</span><span class="p">(</span><span class="n">raw</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">212</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">51</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;PACF&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># ARMA(1,1) 모델링</span>
<span class="n">fit</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">ARMA</span><span class="p">(</span><span class="n">raw</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">display</span><span class="p">(</span><span class="n">fit</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/3_Algorithms_ML_TS_Linear_77_0.png" src="../_images/3_Algorithms_ML_TS_Linear_77_0.png" />
<img alt="../_images/3_Algorithms_ML_TS_Linear_77_1.png" src="../_images/3_Algorithms_ML_TS_Linear_77_1.png" />
<div class="output text_html"><table class="simpletable">
<caption>ARMA Model Results</caption>
<tr>
  <th>Dep. Variable:</th>       <td>value</td>      <th>  No. Observations:  </th>   <td>72</td>   
</tr>
<tr>
  <th>Model:</th>            <td>ARMA(1, 1)</td>    <th>  Log Likelihood     </th> <td>31.983</td> 
</tr>
<tr>
  <th>Method:</th>             <td>css-mle</td>     <th>  S.D. of innovations</th>  <td>0.154</td> 
</tr>
<tr>
  <th>Date:</th>          <td>Fri, 31 Jul 2020</td> <th>  AIC                </th> <td>-55.965</td>
</tr>
<tr>
  <th>Time:</th>              <td>22:46:06</td>     <th>  BIC                </th> <td>-46.859</td>
</tr>
<tr>
  <th>Sample:</th>                <td>0</td>        <th>  HQIC               </th> <td>-52.340</td>
</tr>
<tr>
  <th></th>                       <td> </td>        <th>                     </th>    <td> </td>   
</tr>
</table>
<table class="simpletable">
<tr>
       <td></td>          <th>coef</th>     <th>std err</th>      <th>z</th>      <th>P>|z|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>const</th>       <td>    7.6037</td> <td>    0.080</td> <td>   94.470</td> <td> 0.000</td> <td>    7.446</td> <td>    7.761</td>
</tr>
<tr>
  <th>ar.L1.value</th> <td>    0.6796</td> <td>    0.098</td> <td>    6.970</td> <td> 0.000</td> <td>    0.489</td> <td>    0.871</td>
</tr>
<tr>
  <th>ma.L1.value</th> <td>    0.4680</td> <td>    0.111</td> <td>    4.214</td> <td> 0.000</td> <td>    0.250</td> <td>    0.686</td>
</tr>
</table>
<table class="simpletable">
<caption>Roots</caption>
<tr>
    <td></td>   <th>            Real</th>  <th>         Imaginary</th> <th>         Modulus</th>  <th>        Frequency</th>
</tr>
<tr>
  <th>AR.1</th> <td>           1.4713</td> <td>          +0.0000j</td> <td>           1.4713</td> <td>           0.0000</td>
</tr>
<tr>
  <th>MA.1</th> <td>          -2.1369</td> <td>          +0.0000j</td> <td>           2.1369</td> <td>           0.5000</td>
</tr>
</table></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">product</span>

<span class="c1"># ARMA(p,q) 모델링</span>
<span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">p</span><span class="p">,</span> <span class="n">q</span> <span class="ow">in</span> <span class="n">product</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">)):</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">p</span> <span class="o">==</span> <span class="mi">0</span> <span class="o">&amp;</span> <span class="n">q</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
        <span class="k">continue</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">ARMA</span><span class="p">(</span><span class="n">raw</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">q</span><span class="p">))</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;p&quot;</span><span class="p">:</span> <span class="n">p</span><span class="p">,</span> <span class="s2">&quot;q&quot;</span><span class="p">:</span> <span class="n">q</span><span class="p">,</span> <span class="s2">&quot;LLF&quot;</span><span class="p">:</span> <span class="n">model</span><span class="o">.</span><span class="n">llf</span><span class="p">,</span> <span class="s2">&quot;AIC&quot;</span><span class="p">:</span> <span class="n">model</span><span class="o">.</span><span class="n">aic</span><span class="p">,</span> <span class="s2">&quot;BIC&quot;</span><span class="p">:</span> <span class="n">model</span><span class="o">.</span><span class="n">bic</span><span class="p">})</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="k">pass</span>
   
<span class="c1"># 모형 최적모수 선택</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="n">opt_ar</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;AIC&#39;</span><span class="p">]),</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">opt_ma</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;AIC&#39;</span><span class="p">]),</span> <span class="mi">1</span><span class="p">]</span>

<span class="c1"># ARMA 모델링</span>
<span class="n">fit</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">ARMA</span><span class="p">(</span><span class="n">raw</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="p">(</span><span class="n">opt_ar</span><span class="p">,</span><span class="n">opt_ma</span><span class="p">))</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">display</span><span class="p">(</span><span class="n">fit</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>

<span class="c1"># 잔차 ACF/PACF 확인</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">sm</span><span class="o">.</span><span class="n">graphics</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">plot_acf</span><span class="p">(</span><span class="n">fit</span><span class="o">.</span><span class="n">resid</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">211</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">51</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;ACF&quot;</span><span class="p">)</span>

<span class="n">sm</span><span class="o">.</span><span class="n">graphics</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">plot_pacf</span><span class="p">(</span><span class="n">fit</span><span class="o">.</span><span class="n">resid</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">212</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">51</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;PACF&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>p</th>
      <th>q</th>
      <th>LLF</th>
      <th>AIC</th>
      <th>BIC</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>0</td>
      <td>24.89</td>
      <td>-43.79</td>
      <td>-36.96</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>1</td>
      <td>31.98</td>
      <td>-55.97</td>
      <td>-46.86</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>0</td>
      <td>35.74</td>
      <td>-63.48</td>
      <td>-54.37</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2</td>
      <td>1</td>
      <td>44.51</td>
      <td>-79.03</td>
      <td>-67.64</td>
    </tr>
    <tr>
      <th>4</th>
      <td>3</td>
      <td>0</td>
      <td>38.56</td>
      <td>-67.12</td>
      <td>-55.74</td>
    </tr>
    <tr>
      <th>5</th>
      <td>3</td>
      <td>1</td>
      <td>45.28</td>
      <td>-78.56</td>
      <td>-64.90</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output text_html"><table class="simpletable">
<caption>ARMA Model Results</caption>
<tr>
  <th>Dep. Variable:</th>       <td>value</td>      <th>  No. Observations:  </th>   <td>72</td>   
</tr>
<tr>
  <th>Model:</th>            <td>ARMA(2, 1)</td>    <th>  Log Likelihood     </th> <td>44.513</td> 
</tr>
<tr>
  <th>Method:</th>             <td>css-mle</td>     <th>  S.D. of innovations</th>  <td>0.128</td> 
</tr>
<tr>
  <th>Date:</th>          <td>Fri, 31 Jul 2020</td> <th>  AIC                </th> <td>-79.026</td>
</tr>
<tr>
  <th>Time:</th>              <td>22:46:07</td>     <th>  BIC                </th> <td>-67.642</td>
</tr>
<tr>
  <th>Sample:</th>                <td>0</td>        <th>  HQIC               </th> <td>-74.494</td>
</tr>
<tr>
  <th></th>                       <td> </td>        <th>                     </th>    <td> </td>   
</tr>
</table>
<table class="simpletable">
<tr>
       <td></td>          <th>coef</th>     <th>std err</th>      <th>z</th>      <th>P>|z|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>const</th>       <td>    7.5920</td> <td>    0.020</td> <td>  384.993</td> <td> 0.000</td> <td>    7.553</td> <td>    7.631</td>
</tr>
<tr>
  <th>ar.L1.value</th> <td>    1.6407</td> <td>    0.059</td> <td>   27.830</td> <td> 0.000</td> <td>    1.525</td> <td>    1.756</td>
</tr>
<tr>
  <th>ar.L2.value</th> <td>   -0.8787</td> <td>    0.055</td> <td>  -16.027</td> <td> 0.000</td> <td>   -0.986</td> <td>   -0.771</td>
</tr>
<tr>
  <th>ma.L1.value</th> <td>   -0.7021</td> <td>    0.075</td> <td>   -9.363</td> <td> 0.000</td> <td>   -0.849</td> <td>   -0.555</td>
</tr>
</table>
<table class="simpletable">
<caption>Roots</caption>
<tr>
    <td></td>   <th>            Real</th>  <th>         Imaginary</th> <th>         Modulus</th>  <th>        Frequency</th>
</tr>
<tr>
  <th>AR.1</th> <td>           0.9336</td> <td>          -0.5162j</td> <td>           1.0668</td> <td>          -0.0804</td>
</tr>
<tr>
  <th>AR.2</th> <td>           0.9336</td> <td>          +0.5162j</td> <td>           1.0668</td> <td>           0.0804</td>
</tr>
<tr>
  <th>MA.1</th> <td>           1.4243</td> <td>          +0.0000j</td> <td>           1.4243</td> <td>           0.0000</td>
</tr>
</table></div><img alt="../_images/3_Algorithms_ML_TS_Linear_78_2.png" src="../_images/3_Algorithms_ML_TS_Linear_78_2.png" />
</div>
</div>
</div>
<div class="section" id="armax-arma-with-exogenous">
<h3>ARMAX(ARMA with eXogenous)<a class="headerlink" href="#armax-arma-with-exogenous" title="Permalink to this headline">¶</a></h3>
<p>\begin{align*}
\text{Equation of ARMA} &amp;&amp; Y_t &amp;= \phi_1Y_{t-1} + \phi_2Y_{t-2} + \cdots + \phi_pY_{t-p} +
\theta_1\epsilon_{t-1} + \theta_2\epsilon_{t-2} + \cdots + \theta_q\epsilon_{t-q} + \epsilon_t \
\text{Equation of ARMAX} &amp;&amp; Y_t &amp;= \phi_1Y_{t-1} + \phi_2Y_{t-2} + \cdots + \phi_pY_{t-p} +
\theta_1\epsilon_{t-1} + \theta_2\epsilon_{t-2} + \cdots + \theta_q\epsilon_{t-q} + \epsilon_t + \beta X \
\end{align*}</p>
</div>
<div class="section" id="armax">
<h3>실습: 통화량을 고려한 소비자지출 ARMAX 모델링<a class="headerlink" href="#armax" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">from</span> <span class="nn">io</span> <span class="kn">import</span> <span class="n">BytesIO</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="nn">sm</span>

<span class="c1"># 데이터 로딩 및 확인</span>
<span class="n">source_url</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;http://www.stata-press.com/data/r12/friedman2.dta&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">content</span>
<span class="n">raw</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_stata</span><span class="p">(</span><span class="n">BytesIO</span><span class="p">(</span><span class="n">source_url</span><span class="p">))</span>
<span class="n">raw</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">raw</span><span class="o">.</span><span class="n">time</span>
<span class="n">raw_using</span> <span class="o">=</span> <span class="n">raw</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;1960&#39;</span><span class="p">:</span><span class="s1">&#39;1981&#39;</span><span class="p">,[</span><span class="s2">&quot;consump&quot;</span><span class="p">,</span> <span class="s2">&quot;m2&quot;</span><span class="p">]]</span>
<span class="n">raw_using</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># 모델링</span>
<span class="c1">## 회귀분석</span>
<span class="n">fit</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">OLS</span><span class="p">(</span><span class="n">raw_using</span><span class="o">.</span><span class="n">consump</span><span class="p">,</span> <span class="n">sm</span><span class="o">.</span><span class="n">add_constant</span><span class="p">(</span><span class="n">raw_using</span><span class="o">.</span><span class="n">m2</span><span class="p">))</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">display</span><span class="p">(</span><span class="n">fit</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>

<span class="c1">## 잔차 확인</span>
<span class="n">fit</span><span class="o">.</span><span class="n">resid</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1">## 잔차 ACF/PACF</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">sm</span><span class="o">.</span><span class="n">graphics</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">plot_acf</span><span class="p">(</span><span class="n">fit</span><span class="o">.</span><span class="n">resid</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">211</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">51</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Residual ACF&quot;</span><span class="p">)</span>

<span class="n">sm</span><span class="o">.</span><span class="n">graphics</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">plot_pacf</span><span class="p">(</span><span class="n">fit</span><span class="o">.</span><span class="n">resid</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">212</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">51</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Residual PACF&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># 모델링</span>
<span class="c1">## ARIMAX </span>
<span class="n">fit</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">ARMA</span><span class="p">(</span><span class="n">raw_using</span><span class="o">.</span><span class="n">consump</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">exog</span><span class="o">=</span><span class="n">raw_using</span><span class="o">.</span><span class="n">m2</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">display</span><span class="p">(</span><span class="n">fit</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>

<span class="c1">## 잔차 확인</span>
<span class="n">fit</span><span class="o">.</span><span class="n">resid</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1">## 잔차 ACF/PACF</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">sm</span><span class="o">.</span><span class="n">graphics</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">plot_acf</span><span class="p">(</span><span class="n">fit</span><span class="o">.</span><span class="n">resid</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">211</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">51</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Residual ACF&quot;</span><span class="p">)</span>

<span class="n">sm</span><span class="o">.</span><span class="n">graphics</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">plot_pacf</span><span class="p">(</span><span class="n">fit</span><span class="o">.</span><span class="n">resid</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">212</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">51</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Residual PACF&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/3_Algorithms_ML_TS_Linear_81_0.png" src="../_images/3_Algorithms_ML_TS_Linear_81_0.png" />
<div class="output text_html"><table class="simpletable">
<caption>OLS Regression Results</caption>
<tr>
  <th>Dep. Variable:</th>         <td>consump</td>     <th>  R-squared:         </th> <td>   0.995</td> 
</tr>
<tr>
  <th>Model:</th>                   <td>OLS</td>       <th>  Adj. R-squared:    </th> <td>   0.995</td> 
</tr>
<tr>
  <th>Method:</th>             <td>Least Squares</td>  <th>  F-statistic:       </th> <td>1.721e+04</td>
</tr>
<tr>
  <th>Date:</th>             <td>Fri, 31 Jul 2020</td> <th>  Prob (F-statistic):</th> <td>7.72e-101</td>
</tr>
<tr>
  <th>Time:</th>                 <td>22:46:10</td>     <th>  Log-Likelihood:    </th> <td> -434.48</td> 
</tr>
<tr>
  <th>No. Observations:</th>      <td>    88</td>      <th>  AIC:               </th> <td>   873.0</td> 
</tr>
<tr>
  <th>Df Residuals:</th>          <td>    86</td>      <th>  BIC:               </th> <td>   877.9</td> 
</tr>
<tr>
  <th>Df Model:</th>              <td>     1</td>      <th>                     </th>     <td> </td>    
</tr>
<tr>
  <th>Covariance Type:</th>      <td>nonrobust</td>    <th>                     </th>     <td> </td>    
</tr>
</table>
<table class="simpletable">
<tr>
    <td></td>       <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>const</th> <td>  -61.7547</td> <td>    7.788</td> <td>   -7.930</td> <td> 0.000</td> <td>  -77.237</td> <td>  -46.273</td>
</tr>
<tr>
  <th>m2</th>    <td>    1.1406</td> <td>    0.009</td> <td>  131.182</td> <td> 0.000</td> <td>    1.123</td> <td>    1.158</td>
</tr>
</table>
<table class="simpletable">
<tr>
  <th>Omnibus:</th>       <td> 0.847</td> <th>  Durbin-Watson:     </th> <td>   0.094</td>
</tr>
<tr>
  <th>Prob(Omnibus):</th> <td> 0.655</td> <th>  Jarque-Bera (JB):  </th> <td>   0.669</td>
</tr>
<tr>
  <th>Skew:</th>          <td> 0.213</td> <th>  Prob(JB):          </th> <td>   0.716</td>
</tr>
<tr>
  <th>Kurtosis:</th>      <td> 2.984</td> <th>  Cond. No.          </th> <td>1.92e+03</td>
</tr>
</table><br/><br/>Warnings:<br/>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.<br/>[2] The condition number is large, 1.92e+03. This might indicate that there are<br/>strong multicollinearity or other numerical problems.</div><img alt="../_images/3_Algorithms_ML_TS_Linear_81_2.png" src="../_images/3_Algorithms_ML_TS_Linear_81_2.png" />
<img alt="../_images/3_Algorithms_ML_TS_Linear_81_3.png" src="../_images/3_Algorithms_ML_TS_Linear_81_3.png" />
<div class="output text_html"><table class="simpletable">
<caption>ARMA Model Results</caption>
<tr>
  <th>Dep. Variable:</th>      <td>consump</td>     <th>  No. Observations:  </th>    <td>88</td>   
</tr>
<tr>
  <th>Model:</th>            <td>ARMA(1, 1)</td>    <th>  Log Likelihood     </th> <td>-327.699</td>
</tr>
<tr>
  <th>Method:</th>             <td>css-mle</td>     <th>  S.D. of innovations</th>   <td>9.873</td> 
</tr>
<tr>
  <th>Date:</th>          <td>Fri, 31 Jul 2020</td> <th>  AIC                </th>  <td>665.398</td>
</tr>
<tr>
  <th>Time:</th>              <td>22:46:11</td>     <th>  BIC                </th>  <td>677.784</td>
</tr>
<tr>
  <th>Sample:</th>           <td>01-01-1960</td>    <th>  HQIC               </th>  <td>670.388</td>
</tr>
<tr>
  <th></th>                 <td>- 10-01-1981</td>   <th>                     </th>     <td> </td>   
</tr>
</table>
<table class="simpletable">
<tr>
        <td></td>           <th>coef</th>     <th>std err</th>      <th>z</th>      <th>P>|z|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>const</th>         <td>  -37.6135</td> <td>   36.043</td> <td>   -1.044</td> <td> 0.297</td> <td> -108.256</td> <td>   33.029</td>
</tr>
<tr>
  <th>m2</th>            <td>    1.1232</td> <td>    0.034</td> <td>   33.282</td> <td> 0.000</td> <td>    1.057</td> <td>    1.189</td>
</tr>
<tr>
  <th>ar.L1.consump</th> <td>    0.9330</td> <td>    0.043</td> <td>   21.867</td> <td> 0.000</td> <td>    0.849</td> <td>    1.017</td>
</tr>
<tr>
  <th>ma.L1.consump</th> <td>    0.3106</td> <td>    0.116</td> <td>    2.682</td> <td> 0.007</td> <td>    0.084</td> <td>    0.538</td>
</tr>
</table>
<table class="simpletable">
<caption>Roots</caption>
<tr>
    <td></td>   <th>            Real</th>  <th>         Imaginary</th> <th>         Modulus</th>  <th>        Frequency</th>
</tr>
<tr>
  <th>AR.1</th> <td>           1.0718</td> <td>          +0.0000j</td> <td>           1.0718</td> <td>           0.0000</td>
</tr>
<tr>
  <th>MA.1</th> <td>          -3.2199</td> <td>          +0.0000j</td> <td>           3.2199</td> <td>           0.5000</td>
</tr>
</table></div><img alt="../_images/3_Algorithms_ML_TS_Linear_81_5.png" src="../_images/3_Algorithms_ML_TS_Linear_81_5.png" />
<img alt="../_images/3_Algorithms_ML_TS_Linear_81_6.png" src="../_images/3_Algorithms_ML_TS_Linear_81_6.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 좀 더 적합성능을 높이는 방법은? ARMA의 한계는 추세차분!</span>

<span class="c1"># SARIMAX 모델링</span>
<span class="n">fit</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">SARIMAX</span><span class="p">(</span><span class="n">raw_using</span><span class="o">.</span><span class="n">consump</span><span class="p">,</span> <span class="n">exog</span><span class="o">=</span><span class="n">raw_using</span><span class="o">.</span><span class="n">m2</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="n">seasonal_order</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">display</span><span class="p">(</span><span class="n">fit</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>

<span class="c1"># 잔차 확인</span>
<span class="n">fit</span><span class="o">.</span><span class="n">resid</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># 잔차 ACF/PACF</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">sm</span><span class="o">.</span><span class="n">graphics</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">plot_acf</span><span class="p">(</span><span class="n">fit</span><span class="o">.</span><span class="n">resid</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">211</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">51</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Residual ACF&quot;</span><span class="p">)</span>

<span class="n">sm</span><span class="o">.</span><span class="n">graphics</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">plot_pacf</span><span class="p">(</span><span class="n">fit</span><span class="o">.</span><span class="n">resid</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">212</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">51</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Residual PACF&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="simpletable">
<caption>SARIMAX Results</caption>
<tr>
  <th>Dep. Variable:</th>               <td>consump</td>             <th>  No. Observations:  </th>    <td>88</td>   
</tr>
<tr>
  <th>Model:</th>           <td>SARIMAX(1, 0, 0)x(1, 0, [1], 4)</td> <th>  Log Likelihood     </th> <td>-333.579</td>
</tr>
<tr>
  <th>Date:</th>                   <td>Fri, 31 Jul 2020</td>         <th>  AIC                </th>  <td>677.158</td>
</tr>
<tr>
  <th>Time:</th>                       <td>22:46:13</td>             <th>  BIC                </th>  <td>689.545</td>
</tr>
<tr>
  <th>Sample:</th>                    <td>01-01-1960</td>            <th>  HQIC               </th>  <td>682.148</td>
</tr>
<tr>
  <th></th>                          <td>- 10-01-1981</td>           <th>                     </th>     <td> </td>   
</tr>
<tr>
  <th>Covariance Type:</th>               <td>opg</td>               <th>                     </th>     <td> </td>   
</tr>
</table>
<table class="simpletable">
<tr>
     <td></td>        <th>coef</th>     <th>std err</th>      <th>z</th>      <th>P>|z|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>m2</th>      <td>    0.3645</td> <td>    0.140</td> <td>    2.604</td> <td> 0.009</td> <td>    0.090</td> <td>    0.639</td>
</tr>
<tr>
  <th>ar.L1</th>   <td>    0.9987</td> <td>    0.004</td> <td>  270.890</td> <td> 0.000</td> <td>    0.992</td> <td>    1.006</td>
</tr>
<tr>
  <th>ar.S.L4</th> <td>    0.9541</td> <td>    0.060</td> <td>   15.859</td> <td> 0.000</td> <td>    0.836</td> <td>    1.072</td>
</tr>
<tr>
  <th>ma.S.L4</th> <td>   -0.4736</td> <td>    0.159</td> <td>   -2.985</td> <td> 0.003</td> <td>   -0.785</td> <td>   -0.163</td>
</tr>
<tr>
  <th>sigma2</th>  <td>   95.1802</td> <td>    9.448</td> <td>   10.074</td> <td> 0.000</td> <td>   76.662</td> <td>  113.699</td>
</tr>
</table>
<table class="simpletable">
<tr>
  <th>Ljung-Box (Q):</th>          <td>47.49</td> <th>  Jarque-Bera (JB):  </th> <td>229.54</td>
</tr>
<tr>
  <th>Prob(Q):</th>                <td>0.19</td>  <th>  Prob(JB):          </th>  <td>0.00</td> 
</tr>
<tr>
  <th>Heteroskedasticity (H):</th> <td>23.47</td> <th>  Skew:              </th>  <td>-0.99</td>
</tr>
<tr>
  <th>Prob(H) (two-sided):</th>    <td>0.00</td>  <th>  Kurtosis:          </th>  <td>10.66</td>
</tr>
</table><br/><br/>Warnings:<br/>[1] Covariance matrix calculated using the outer product of gradients (complex-step).</div><img alt="../_images/3_Algorithms_ML_TS_Linear_82_1.png" src="../_images/3_Algorithms_ML_TS_Linear_82_1.png" />
<img alt="../_images/3_Algorithms_ML_TS_Linear_82_2.png" src="../_images/3_Algorithms_ML_TS_Linear_82_2.png" />
</div>
</div>
</div>
</div>
<div class="section" id="integrated-linear-process">
<h2>적분 선형확률과정(Integrated Linear Process)<a class="headerlink" href="#integrated-linear-process" title="Permalink to this headline">¶</a></h2>
<div class="section" id="arima-auto-regressive-integrated-moving-average">
<h3>ARIMA(Auto-Regressive Integrated Moving Average)<a class="headerlink" href="#arima-auto-regressive-integrated-moving-average" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><p><strong>“<span class="math notranslate nohighlight">\(ARIMA(p,d,q)\)</span>: 1이상의 차분이 적용된 <span class="math notranslate nohighlight">\(\Delta^d Y_t = (1-L)^d Y_{t}\)</span>가 알고리즘의 차수(<span class="math notranslate nohighlight">\(p~and~q\)</span>)가 유한한 <span class="math notranslate nohighlight">\(AR(p)\)</span>와 <span class="math notranslate nohighlight">\(MA(q)\)</span>의 선형조합”</strong></p>
<ul class="simple">
<li><p>비정상성인 시계열 데이터 <span class="math notranslate nohighlight">\(Y_t\)</span>를 차분한 결과로 만들어진 <span class="math notranslate nohighlight">\(\Delta Y_t = Y_t - Y_{t-1} = (1-L) Y_{t}\)</span>가 정상성인 데이터이고 ARMA 모형을 따르면 원래의 <span class="math notranslate nohighlight">\(Y_t\)</span>를 <strong>ARIMA 모형</strong>이라고 함<br />
<strong>=&gt; <span class="math notranslate nohighlight">\(d \geq 1\)</span>:</strong> <span class="math notranslate nohighlight">\(Y_t\)</span>는 비정상성 시계열 데이터이다(단위근을 갖는다)</p></li>
<li><p><span class="math notranslate nohighlight">\(d\)</span>번 차분한 후 시계열 <span class="math notranslate nohighlight">\(\Delta^d Y_t\)</span>가 정상성인 데이터이고 ARMA(p,q) 모형을 따른다면 적분차수(Order of Integrarion)가 <span class="math notranslate nohighlight">\(d\)</span>인 **ARIMA(p,d,q)**로 표기함<br />
- <span class="math notranslate nohighlight">\(p=0\)</span>: ARIMA(0,d,q) = IMA(d,q)
- <span class="math notranslate nohighlight">\(q=0\)</span>: ARIMA(p,d,0) = ARI(p,d)</p></li>
</ul>
</div></blockquote>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>Parameters</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(p\)</span></p></td>
<td><p>order of the autoregressive part</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(d\)</span></p></td>
<td><p>degree of differencing involved</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(q\)</span></p></td>
<td><p>order of the moving average part</p></td>
</tr>
</tbody>
</table>
<ul class="simple">
<li><p><strong>ARIMA(0,1,1) = IMA(1,1)</strong></p></li>
</ul>
<blockquote>
<div><p><strong>“자기상관계수(ACF)가 빠르게 감소하지 않는 것이 ARIMA와 같은 적분과정(Integrated Process)의 특징”</strong></p>
<ul class="simple">
<li><p>차분을 해야 정상성이 되는 <span class="math notranslate nohighlight">\(Y_t\)</span>이기에, 시차(Lag)가 증가해도 ACF가 1에 가까운 상관성을 유지하려 하기에 쉽게 감소하지 않음</p></li>
</ul>
</div></blockquote>
<p>\begin{align*}
Y_t &amp;= Y_{t-1} + \epsilon_t + \theta_1 \epsilon_{t-1} \
Y_t &amp;= \epsilon_t+(1+\theta)\epsilon_{t-1}+(1+\theta)\epsilon_{t-2}+(1+\theta)\epsilon_{t-3}+\cdots \
Corr(Y_t, Y_{t-1}) &amp;= \rho_i \approx 1
\end{align*}</p>
<ul class="simple">
<li><p><strong>ARIMA(0,2,1) = IMA(2,1)</strong></p></li>
</ul>
<p>\begin{align*}
\Delta^2 Y_t = (1-L)^2 Y_{t} = \epsilon_t + \theta_1 \epsilon_{t-1}\
\end{align*}</p>
</div>
<div class="section" id="arima">
<h3>ARIMA 모형 차수결정 정리<a class="headerlink" href="#arima" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><p><strong>1) 추정 및 예측을 하기 전에 파라미터에 따라 모형이 어떠한 결과를 도출할지 이해(예상) 필요</strong><br />
<strong>2) 결과이해(예상)는 기계의 실수를 방지하고 결과의 확신을 증가시킴</strong></p>
</div></blockquote>
<ul class="simple">
<li><p><strong><span class="math notranslate nohighlight">\(p\)</span>, <span class="math notranslate nohighlight">\(q\)</span> 파라미터 추론(by ACF and PACF):</strong></p></li>
</ul>
<ol class="simple">
<li><p>정상성 형태 변환: 차분/로그변환/계절성제거 등을 통해 데이터를 정상성 형태로 변환</p></li>
<li><p><span class="math notranslate nohighlight">\(ACF\)</span>, <span class="math notranslate nohighlight">\(PACF\)</span>를 도식화 하여 ARMA의 파라미터 차수를 추론</p></li>
</ol>
<center><img src='Image/ARIMA_Pattern.png' width='500'></center>
<ul class="simple">
<li><p><strong><span class="math notranslate nohighlight">\(c\)</span>, <span class="math notranslate nohighlight">\(d\)</span> 파라미터 이해: X가 반영되지 않고 추정된 시계열 알고리즘은 결국 상수항의 적합성을 높이는 것!</strong></p></li>
</ul>
<blockquote>
<div><p><strong>“상수항(Const)인 <span class="math notranslate nohighlight">\(c\)</span>는 이론수식 복잡성으로 생략되기도 하나 존재가능”</strong><br />
<strong>“높은 차수의 차분(<span class="math notranslate nohighlight">\(d\)</span>)은 예측 구간추정 범위를 급격하게 상승시킴”</strong></p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(c = 0, d = 0\)</span>: 점추정은 0, 예측의 구간추정은 과거데이터의 표준편차</p></li>
<li><p><span class="math notranslate nohighlight">\(c \neq 0, d = 0\)</span>: 점추정은 과거데이터의 평균, 예측의 구간추정은 과거데이터의 표준편차</p></li>
<li><p><span class="math notranslate nohighlight">\(p \geq 2\)</span>: 특정 변동(계절성, 싸이클)을 반영한 예측을 위해선 2이상의 차수 필수
- 예시: AR(2) 모형에서 <span class="math notranslate nohighlight">\(\phi_1^2+4\phi_2&lt;0\)</span>를 만족해야 싸이클 형태로 예측되며 이때의 발생 싸이클은 다음과 같다
\begin{align*}
\frac{2\pi}{\text{arc cos}(-\phi_1(1-\phi_2)/(4\phi_2))}
\end{align*}</p></li>
</ul>
</div></blockquote>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>Parameters</p></th>
<th class="head"><p>Long-term Forecasts</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(c = 0, \\ d = 0\)</span></p></td>
<td><p>go to zero</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(c = 0, \\ d = 1\)</span></p></td>
<td><p>go to a non-zero constant</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(c = 0, \\ d = 2\)</span></p></td>
<td><p>follow a straight line</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(c \neq 0, \\ d = 0\)</span></p></td>
<td><p>go to the mean of the data</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(c \neq 0, \\ d = 1\)</span></p></td>
<td><p>follow a straight line</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(c \neq 0, \\ d = 2\)</span></p></td>
<td><p>follow a quadratic trend</p></td>
</tr>
</tbody>
</table>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="nn">sm</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># 2차누적/1차누적/미누적 데이터생성 및 적분차수 이해</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">123</span><span class="p">)</span>
<span class="n">y2</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">ArmaProcess</span><span class="p">([</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">])</span><span class="o">.</span><span class="n">generate_sample</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()</span>
<span class="n">y1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">y2</span><span class="p">)</span>
<span class="n">y0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">y1</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">311</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;ARIMA Simulation&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y2</span><span class="p">,</span> <span class="s1">&#39;o-&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">312</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y1</span><span class="p">,</span> <span class="s1">&#39;o-&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">313</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y0</span><span class="p">,</span> <span class="s1">&#39;o-&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/3_Algorithms_ML_TS_Linear_86_0.png" src="../_images/3_Algorithms_ML_TS_Linear_86_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 2차누적/1차누적/미누적 데이터시각화</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="n">sm</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">graphics</span><span class="o">.</span><span class="n">plot_acf</span><span class="p">(</span><span class="n">y2</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">311</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">sm</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">graphics</span><span class="o">.</span><span class="n">plot_acf</span><span class="p">(</span><span class="n">y1</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">312</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">sm</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">graphics</span><span class="o">.</span><span class="n">plot_acf</span><span class="p">(</span><span class="n">y0</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">313</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/3_Algorithms_ML_TS_Linear_87_0.png" src="../_images/3_Algorithms_ML_TS_Linear_87_0.png" />
</div>
</div>
<ul class="simple">
<li><p><strong>과차분(Over-differencing):</strong></p></li>
</ul>
<blockquote>
<div><p><strong>“필요 적분차수 이상의 차분은 MA모형을 생성!”</strong></p>
<ul class="simple">
<li><p>ARIMA(0,d,0) 모형을 따르는 <span class="math notranslate nohighlight">\(Y_t\)</span>를 <span class="math notranslate nohighlight">\(d\)</span>번 차분하면 백색잡음만 남음</p></li>
<li><p>추가 1차분: MA(1), 추가 2차분: MA(2)</p></li>
<li><p>과적합은 ACF/PACF의 수치를 오히려 증가시킬 수 있음</p></li>
</ul>
</div></blockquote>
<p>\begin{align*}
\Delta^d Y_t &amp;= \epsilon_t \
\Delta^{d+1} Y_t &amp;= \epsilon_t - \epsilon_{t-1} \
\Delta^{d+2} Y_t &amp;= \epsilon_t - 2\epsilon_{t-1} + \epsilon_{t-2} \
\end{align*}</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 과적차분 데이터 이해</span>
<span class="n">y1_minus</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">y0</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">211</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y1_minus</span><span class="p">,</span> <span class="s1">&#39;o-&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Over-differencing 1 (Data)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">sm</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">graphics</span><span class="o">.</span><span class="n">plot_acf</span><span class="p">(</span><span class="n">y1_minus</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">212</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Over-differencing 1 (ACF)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">y2_minus</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">y1_minus</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">211</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y2_minus</span><span class="p">,</span> <span class="s1">&#39;o-&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Over-differencing 2 (Data)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">sm</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">graphics</span><span class="o">.</span><span class="n">plot_acf</span><span class="p">(</span><span class="n">y2_minus</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">212</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Over-differencing 2 (ACF)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/3_Algorithms_ML_TS_Linear_89_0.png" src="../_images/3_Algorithms_ML_TS_Linear_89_0.png" />
<img alt="../_images/3_Algorithms_ML_TS_Linear_89_1.png" src="../_images/3_Algorithms_ML_TS_Linear_89_1.png" />
</div>
</div>
<ul class="simple">
<li><p><strong>단위근 존재 의미:</strong></p></li>
</ul>
<blockquote>
<div><p><strong>“단위근을 갖는다는게 왜 비정상성 시계열 데이터라는 거지? -&gt; <span class="math notranslate nohighlight">\(d\)</span> 차분을 해야 정상성이 되니까!”</strong></p>
<ul class="simple">
<li><p>“<span class="math notranslate nohighlight">\(Y_t\)</span>가 ARIMA(p,1,q)를 따른다” <span class="math notranslate nohighlight">\(=\)</span> “<span class="math notranslate nohighlight">\(\Delta Y_t = Y_t - Y_{t-1}\)</span>가 정상성이며 ARMA(p,q)를 따른다”</p></li>
<li><p>단위근이 있다는 것은 추세가 존재한다는 의미 -&gt; 차분으로 추세제거 가능</p></li>
</ul>
</div></blockquote>
<p>\begin{align*}
\text{Main Equation of ARIMA} &amp;&amp; \Delta Y_t = \phi_1 \Delta Y_{t-1} + \phi_2 \Delta Y_{t-2} + \cdots + \phi_p \Delta Y_{t-p} + \theta_1 \epsilon_{t-1} + \theta_2 \epsilon_{t-2} + \cdots + \theta_q \epsilon_{t-q} + \epsilon_t
\end{align*}</p>
<p>\begin{align*}
\Delta Y_t - \phi_1 \Delta Y_{t-1} - \phi_2 \Delta Y_{t-2} - \cdots - \phi_p \Delta Y_{t-p} &amp;= \theta_1 \epsilon_{t-1} + \theta_2 \epsilon_{t-2} + \cdots + \theta_q \epsilon_{t-q} + \epsilon_t \
Y_t-Y_{t-1} - \phi_1 (Y_{t-1}-Y_{t-2}) - \phi_2 (Y_{t-2}-Y_{t-3}) - \cdots - \phi_p (Y_{t-p}-Y_{t-p-1}) &amp;= \epsilon_t + \theta_1 \epsilon_{t-1} + \theta_2 \epsilon_{t-2} + \cdots + \theta_q \epsilon_{t-q} \
Y_t - (\phi_1+1)Y_{t-1} - (\phi_2-\phi_1)Y_{t-2} - \cdots - (\phi_p-\phi_{p-1})Y_{t-p} + \phi_pY_{t-p-1} &amp;= \epsilon_t+\theta_1\epsilon_{t-1}+\theta_2 \epsilon_{t-2}+\cdots+\theta_q \epsilon_{t-q} \
1-(\phi_1+1)Y-(\phi_2-\phi_1)Y^2-\cdots-(\phi_p-\phi_{p-1})Y^p+\phi_pY^{p+1} &amp;= 0 \
(1-Y)(1-\phi_1Y-\phi_2Y^2-\cdots-\phi_pY^p) &amp;= 0 \
\end{align*}</p>
<p>\begin{align*}
\text{Solution of ARIMA} &amp;&amp; Y = 1 \text{ and } \sum_{i=1}^p \phi_i = 1
\end{align*}</p>
<p>\begin{align*}
1-\phi_1Y-\phi_2Y^2-\cdots-\phi_pY^p = 0 \
\end{align*}</p>
<p>\begin{align*}
\text{Solution of ARMA} &amp;&amp; \sum_{i=1}^p \phi_i = 1 \
\end{align*}</p>
<ul class="simple">
<li><p><strong>ARIMA 표현식 정리:</strong></p></li>
</ul>
<p>\begin{align*}
\text{Main Equation of ARMA} &amp;&amp; Y_t &amp;= \phi_1Y_{t-1} + \phi_2Y_{t-2} + \cdots + \phi_pY_{t-p} +
\theta_1\epsilon_{t-1} + \theta_2\epsilon_{t-2} + \cdots + \theta_q\epsilon_{t-q} + \epsilon_t \
&amp;&amp; \phi(L)Y_t &amp;= \theta(L)\epsilon_t \
\text{Main Equation of ARIMA} &amp;&amp; (1-L)^d Y_t &amp;= \phi_1 (1-L)^d Y_{t-1} + \phi_2 (1-L)^d Y_{t-2} + \cdots + \phi_p (1-L)^d Y_{t-p} +
\theta_1\epsilon_{t-1} + \theta_2\epsilon_{t-2} + \cdots + \theta_q\epsilon_{t-q} + \epsilon_t \
&amp;&amp; \phi(L)(1-L)^dY_t &amp;= \theta(L)\epsilon_t \
\end{align*}</p>
<p>\begin{equation}
\begin{array}{c c c c}
(1-\phi_1L - \cdots - \phi_p L^p) &amp; (1-L)^d Y_{t} &amp;= (1 + \theta_1 L + \cdots + \theta_q L^q)\epsilon_t\
{\uparrow} &amp; {\uparrow} &amp; {\uparrow}\
\text{AR(<span class="math notranslate nohighlight">\(p\)</span>)} &amp; \text{<span class="math notranslate nohighlight">\(d\)</span> differences} &amp; \text{MA(<span class="math notranslate nohighlight">\(q\)</span>)}\
\end{array}
\end{equation}</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>Time Series Algorithms</p></th>
<th class="head"><p>ARIMA Expressions</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>White noise</p></td>
<td><p>ARIMA(0,0,0)</p></td>
</tr>
<tr class="row-odd"><td><p>Random walk</p></td>
<td><p>ARIMA(0,1,0)</p></td>
</tr>
<tr class="row-even"><td><p>Autoregression(<span class="math notranslate nohighlight">\(AR(p)\)</span>)</p></td>
<td><p>ARIMA(<span class="math notranslate nohighlight">\(p\)</span>,0,0)</p></td>
</tr>
<tr class="row-odd"><td><p>Moving average(<span class="math notranslate nohighlight">\(MA(q)\)</span>)</p></td>
<td><p>ARIMA(0,0,<span class="math notranslate nohighlight">\(q\)</span>)</p></td>
</tr>
</tbody>
</table>
<p>\begin{align*}
\text{Main Equation of ARIMA} &amp;&amp; (1-\phi_1L - \cdots - \phi_p L^p) (1-L)^d Y_{t} &amp;= (1 + \theta_1 L + \cdots + \theta_q L^q)\epsilon_t\
\text{Main Equation of ARIMAX} &amp;&amp; (1-\phi_1L - \cdots - \phi_p L^p) (1-L)^d Y_{t} &amp;= \sum^{k}<em>{i=1}\beta</em>{i}Z_{it} + (1 + \theta_1 L + \cdots + \theta_q L^q)\epsilon_t\
\end{align*}</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">statsmodels</span> <span class="kn">import</span> <span class="n">datasets</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="nn">sm</span>
<span class="o">%</span><span class="k">reload_ext</span> autoreload
<span class="o">%</span><span class="k">autoreload</span> 2
<span class="kn">from</span> <span class="nn">module</span> <span class="kn">import</span> <span class="n">stationarity_adf_test</span><span class="p">,</span> <span class="n">stationarity_kpss_test</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># ARIMA 모형의 한계</span>
<span class="c1"># 데이터 로딩 및 시간변수 반영</span>
<span class="n">raw_set</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">get_rdataset</span><span class="p">(</span><span class="s2">&quot;accdeaths&quot;</span><span class="p">,</span> <span class="n">package</span><span class="o">=</span><span class="s2">&quot;MASS&quot;</span><span class="p">)</span>
<span class="n">raw</span> <span class="o">=</span> <span class="n">raw_set</span><span class="o">.</span><span class="n">data</span>
<span class="n">raw</span><span class="o">.</span><span class="n">time</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s1">&#39;1973-01-01&#39;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">raw</span><span class="p">),</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;M&#39;</span><span class="p">)</span>
<span class="n">raw</span><span class="p">[</span><span class="s1">&#39;month&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">raw</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">month</span>

<span class="c1"># 데이터 확인</span>
<span class="n">display</span><span class="p">(</span><span class="n">raw</span><span class="o">.</span><span class="n">tail</span><span class="p">())</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">raw</span><span class="o">.</span><span class="n">time</span><span class="p">,</span> <span class="n">raw</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># 정상성 확인</span>
<span class="n">display</span><span class="p">(</span><span class="n">stationarity_adf_test</span><span class="p">(</span><span class="n">raw</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="p">[]))</span>
<span class="n">display</span><span class="p">(</span><span class="n">stationarity_kpss_test</span><span class="p">(</span><span class="n">raw</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="p">[]))</span>
<span class="n">sm</span><span class="o">.</span><span class="n">graphics</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">plot_acf</span><span class="p">(</span><span class="n">raw</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">use_vlines</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>time</th>
      <th>value</th>
      <th>month</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>67</th>
      <td>1978-08-31</td>
      <td>9827</td>
      <td>8</td>
    </tr>
    <tr>
      <th>68</th>
      <td>1978-09-30</td>
      <td>9110</td>
      <td>9</td>
    </tr>
    <tr>
      <th>69</th>
      <td>1978-10-31</td>
      <td>9070</td>
      <td>10</td>
    </tr>
    <tr>
      <th>70</th>
      <td>1978-11-30</td>
      <td>8633</td>
      <td>11</td>
    </tr>
    <tr>
      <th>71</th>
      <td>1978-12-31</td>
      <td>9240</td>
      <td>12</td>
    </tr>
  </tbody>
</table>
</div></div><img alt="../_images/3_Algorithms_ML_TS_Linear_92_1.png" src="../_images/3_Algorithms_ML_TS_Linear_92_1.png" />
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Stationarity_adf</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Test Statistics</th>
      <td>-2.54</td>
    </tr>
    <tr>
      <th>p-value</th>
      <td>0.11</td>
    </tr>
    <tr>
      <th>Used Lag</th>
      <td>12.00</td>
    </tr>
    <tr>
      <th>Used Observations</th>
      <td>59.00</td>
    </tr>
    <tr>
      <th>Critical Value(1%)</th>
      <td>-3.55</td>
    </tr>
    <tr>
      <th>Maximum Information Criteria</th>
      <td>870.44</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Stationarity_kpss</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Test Statistics</th>
      <td>0.28</td>
    </tr>
    <tr>
      <th>p-value</th>
      <td>0.10</td>
    </tr>
    <tr>
      <th>Used Lag</th>
      <td>12.00</td>
    </tr>
    <tr>
      <th>Critical Value(10%)</th>
      <td>0.35</td>
    </tr>
  </tbody>
</table>
</div></div><img alt="../_images/3_Algorithms_ML_TS_Linear_92_4.png" src="../_images/3_Algorithms_ML_TS_Linear_92_4.png" />
</div>
</div>
</div>
<div class="section" id="sarima-seasonal-arima">
<h3>SARIMA(Seasonal ARIMA)<a class="headerlink" href="#sarima-seasonal-arima" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><p><strong>“ARIMA 모형은 Non-seasonal 데이터 또는 Non-seasonal ARIMA 모델을 가정 -&gt; 계절성 패턴 반영 모델 필요!”</strong></p>
</div></blockquote>
<ul class="simple">
<li><p>SARIMAX 클래스 이용하면 Multiplicated SARIMA(p,d,q)x(P,D,Q,m) 모형 추정 및 예측 가능</p></li>
<li><p>SARIMAX의 fit 메서드는 모수를 추정하여 그 결과를 SARIMAXResult 클래스 인스턴스로 반환</p></li>
</ul>
<p>\begin{align*}
\text{SARIMA} &amp;&amp; \underbrace{(p, d, q)} &amp;&amp; \underbrace{(P, D, Q)_m} \
&amp;&amp; {\uparrow} &amp;&amp; {\uparrow} \
&amp;&amp; \text{Non-seasonal part} &amp;&amp; \text{Seasonal part} \
&amp;&amp; \text{of the model} &amp;&amp; \text{of the model} \
\end{align*}</p>
<p>\begin{align*}
\text{where } m = \text{ seasonal lag of observations.}
\end{align*}</p>
<p>\begin{align*}
\text{Equation: ARIMA(p,d,q)} &amp;&amp; (1-\phi_1L - \cdots - \phi_p L^p) (1-L)^d Y_{t} &amp;=
(1 + \theta_1 L + \cdots + \theta_q L^q) \epsilon_t\
\text{Equation: ARIMA(1,1,1)} &amp;&amp; (1 - \phi_{1}L) (1 - L)Y_{t} &amp;= (1 + \theta_{1}L) \epsilon_{t}. \
\text{Equation: SARIMA(p,d,q)(P,D,Q)}<em>m &amp;&amp; (1-\phi_1L - \cdots - \phi_p L^p) (1 - \Phi</em>{1}L^{m} - \Phi_{2}L^{2m} - \cdots - \Phi_{P}L^{Pm}) (1-L)^d (1-L^{m})^D Y_{t} &amp;=
(1 + \theta_1 L + \cdots + \theta_q L^q) (1 + \Theta_{1}L^{m} + \Theta_{2}L^{2m} + \cdots + \Theta_{Q}L^{Qm}) \epsilon_t\
\text{Equation: SARIMA(1,1,1)(1,1,1)}<em>4 &amp;&amp; (1 - \phi</em>{1}L)~(1 - \Phi_{1}L^{4}) (1 - L) (1 - L^{4})Y_{t} &amp;=
(1 + \theta_{1}L)~ (1 + \Theta_{1}L^{4})\epsilon_{t}\
\text{Equation: SARIMA(1,2,1)(1,2,1)}<em>4 &amp;&amp; (1 - \phi</em>{1}L)~(1 - \Phi_{1}L^{4}) (1 - L)^2 (1 - L^{4})^2 Y_{t} &amp;=
(1 + \theta_{1}L)~ (1 + \Theta_{1}L^{4})\epsilon_{t}.
\end{align*}</p>
<div class="section" id="simple-sarima-acf">
<h4>Simple SARIMA: 계절성 시차에서만 ACF가 유의하지 않음<a class="headerlink" href="#simple-sarima-acf" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><p><strong>SARIMA(0,0,0)(0,0,1,12):</strong> 각 월의 시계열 자료의 값이 현재의 백색잡음과 작년 동월 백색잡음에 의해 생성</p></li>
</ul>
<blockquote>
<div><ul class="simple">
<li><p>ACF 그래프에서 계절성시차(Lag12)에서의 계수가 유의수준을 벗어난 증가를 보임(다른 시차에서는 유의수준 내 존재)</p></li>
<li><p>PACF 그래프에서 반복되는 계절성시차들의 지수적 감소를 보임</p></li>
</ul>
</div></blockquote>
<p>\begin{align*}
\text{Main Equation} &amp;&amp; Y_t &amp;= (1 + \Theta_{1}L^{12})\epsilon_{t} \
&amp;&amp; &amp;= \epsilon_t + \Theta \epsilon_{t-12} \
\text{Covariance} &amp;&amp; Cov(Y_t, Y_{t-1}) &amp;= \text{Cov}( \epsilon_t + \Theta \epsilon_{t-12} ,  \epsilon_{t-1} + \Theta \epsilon_{t-13} ) = 0 \
&amp;&amp; Cov(Y_t, Y_{t-12}) &amp;= \text{Cov}( \epsilon_t + \Theta \epsilon_{t-12} ,  \epsilon_{t-12} + \Theta \epsilon_{t-24} ) = -\Theta \sigma_e^2 \
\text{Autocorrelation} &amp;&amp; \rho_{k \cdot 12} &amp;= \dfrac{\Theta_k + \Theta_{1}\Theta_{k+1} + \Theta_{2}\Theta_{k+2} + \cdots + \Theta_{Q-k}\Theta_{k+Q}}{1 + \Theta_1^2 +\Theta_2^2 + \cdots + \Theta_Q^2} \
\end{align*}</p>
<ul class="simple">
<li><p><strong>SARIMA(0,0,0)(1,0,0,12):</strong> 각 월의 시계열 자료의 값이 작년 동월 자료값과 현재의 백색잡음에 의해 생성</p></li>
</ul>
<blockquote>
<div><ul class="simple">
<li><p>ACF 그래프에서 반복되는 계절성시차들의 지수적 감소를 보임</p></li>
<li><p>PACF 그래프에서 계절성시차(Lag12)에서의 계수가 유의수준을 벗어난 증가를 보임(다른 시차에서는 유의수준 내 존재)</p></li>
</ul>
</div></blockquote>
<p>\begin{align*}
\text{Main Equation} &amp;&amp; (1 - \Phi_{1}L^{12}) Y_{t} &amp;= \epsilon_t \
&amp;&amp; Y_t &amp;= \Phi Y_{t-12} + \epsilon_t \
\text{Stationary Condition} &amp;&amp; \Phi &amp;&lt; 1 \
\text{Autocorrelation} &amp;&amp; \rho_{k \cdot 12} &amp;= (-1)^{k+1}\Phi^k \
\end{align*}</p>
<ul class="simple">
<li><p><strong>SARIMA(0,0,0)(P,0,Q,12):</strong></p></li>
</ul>
<p>\begin{align*}
\text{Main Equation} &amp;&amp; (1 - \Phi_{1}L^{12} - \Phi_{2}L^{24} - \cdots - \Phi_{P}L^{12P}) Y_{t} &amp;= (1 + \Theta_{1}L^{12} + \Theta_{2}L^{24} + \cdots + \Theta_{Q}L^{12Q})\epsilon_{t} \
&amp;&amp; Y_t - \Phi_1 Y_{t-12} - \Phi_2 Y_{t-24} - \cdots - \Phi_P Y_{t-12P} &amp;= \epsilon_t + \Theta_1 \epsilon_{t-12} + \Theta_2 \epsilon_{t-24} + \cdots + \Theta_Q \epsilon_{t-12Q} \
\end{align*}</p>
<ul class="simple">
<li><p><strong>SARIMA(0,0,0)(P,1,Q,12):</strong></p></li>
</ul>
<p>\begin{align*}
\text{Main Equation} &amp;&amp; (1 - \Phi_{1}L^{12} - \Phi_{2}L^{24} - \cdots - \Phi_{P}L^{12P}) (1-L^{12}) Y_{t} &amp;= (1 + \Theta_{1}L^{12} + \Theta_{2}L^{24} + \cdots + \Theta_{Q}L^{12Q})\epsilon_{t} \
&amp;&amp; (Y_t-Y_{t-12}) - \Phi_1 (Y_{t-12}-Y_{t-24}) - \cdots - \Phi_P (Y_{t-12P}-Y_{t-12(P+1)}) \
&amp;&amp;= \epsilon_t + \Theta_1 \epsilon_{t-12} + \Theta_2 \epsilon_{t-24} + \cdots + \Theta_Q \epsilon_{t-12Q} \
\end{align*}</p>
<ul class="simple">
<li><p><strong>SARIMA(0,0,0)(0,1,1,12):</strong></p></li>
</ul>
<p>\begin{align*}
\text{Main Equation} &amp;&amp; (1-L^{12}) Y_{t} &amp;= (1 + \Theta_{1}L^{12})\epsilon_{t} \
&amp;&amp; Y_t-Y_{t-12} &amp;= \epsilon_t + \Theta_1 \epsilon_{t-12} \
&amp;&amp; Y_t &amp;= Y_{t-12} + \epsilon_t + \Theta_1 \epsilon_{t-12} \
\end{align*}</p>
<ul class="simple">
<li><p><strong>SARIMA(0,0,0)(1,1,0,12):</strong></p></li>
</ul>
<p>\begin{align*}
\text{Main Equation} &amp;&amp; (1 - \Phi_{1}L^{12}) (1-L^{12}) Y_{t} &amp;= \epsilon_{t} \
&amp;&amp; (Y_t-Y_{t-12}) - \Phi_1 (Y_{t-12}-Y_{t-24}) &amp;= \epsilon_t \
&amp;&amp; Y_t- (1 + \Phi_1)Y_{t-12} + \Phi_1 Y_{t-24} &amp;= \epsilon_t \
&amp;&amp; Y_t &amp;= (1 + \Phi_1)Y_{t-12} - \Phi_1 Y_{t-24} + \epsilon_t \
\end{align*}</p>
<ul class="simple">
<li><p><strong>계절성 차수 추정 정리:</strong> 계절성 부분의 AR과 MA 차수는 ACF/PACF의 계절성 시차(Lag) 형태로 파악 가능</p></li>
</ul>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>Parameters</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(p\)</span></p></td>
<td><p>Trend autoregression order</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(d\)</span></p></td>
<td><p>Trend difference order</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(q\)</span></p></td>
<td><p>Trend moving average order</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(m\)</span></p></td>
<td><p>the number of time steps for a single seasonal period</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(P\)</span></p></td>
<td><p>Seasonal autoregression order</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(D\)</span></p></td>
<td><p>Seasonal difference order</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(Q\)</span></p></td>
<td><p>Seasonal moving average order</p></td>
</tr>
</tbody>
</table>
<blockquote>
<div><p><strong>예시1:</strong> SARIMA(0,0,0)(0,0,1<span class="math notranslate nohighlight">\()_{12}\)</span></p>
<ul class="simple">
<li><p>ACF 그래프에서 계절성시차(Lag12)에서의 계수가 유의수준을 벗어난 증가를 보임(다른 시차에서는 유의수준 내 존재)</p></li>
<li><p>PACF 그래프에서 반복되는 계절성시차들의 지수적 감소를 보임</p></li>
</ul>
</div></blockquote>
<blockquote>
<div><p><strong>예시2:</strong> SARIMA(0,0,0)(1,0,0<span class="math notranslate nohighlight">\()_{12}\)</span></p>
<ul class="simple">
<li><p>ACF 그래프에서 반복되는 계절성시차들의 지수적 감소를 보임</p></li>
<li><p>PACF 그래프에서 계절성시차(Lag12)에서의 계수가 유의수준을 벗어난 증가를 보임(다른 시차에서는 유의수준 내 존재)</p></li>
</ul>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">statsmodels</span> <span class="kn">import</span> <span class="n">datasets</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="nn">sm</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># SARIMA(0,0,0)(0,0,1,12)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">123</span><span class="p">)</span>
<span class="n">ar_params</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
<span class="n">ma_params</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">])</span>
<span class="n">ar</span><span class="p">,</span> <span class="n">ma</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="n">ar_params</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">ma_params</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">ArmaProcess</span><span class="p">(</span><span class="n">ar</span><span class="p">,</span> <span class="n">ma</span><span class="p">)</span><span class="o">.</span><span class="n">generate_sample</span><span class="p">(</span><span class="mi">500</span><span class="p">,</span> <span class="n">burnin</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="s1">&#39;o-&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">9</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">411</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">sm</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">ArmaProcess</span><span class="p">(</span><span class="n">ar</span><span class="p">,</span> <span class="n">ma</span><span class="p">)</span><span class="o">.</span><span class="n">acf</span><span class="p">(</span><span class="n">lags</span><span class="o">=</span><span class="mi">50</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">51</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Theoretical ACF of an SARIMA process&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">412</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">sm</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">ArmaProcess</span><span class="p">(</span><span class="n">ar</span><span class="p">,</span> <span class="n">ma</span><span class="p">)</span><span class="o">.</span><span class="n">pacf</span><span class="p">(</span><span class="n">lags</span><span class="o">=</span><span class="mi">50</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">51</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Theoretical PACF of an SARIMA process&quot;</span><span class="p">)</span>

<span class="n">sm</span><span class="o">.</span><span class="n">graphics</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">plot_acf</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">413</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">51</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Sampling ACF of an SARIMA process&quot;</span><span class="p">)</span>

<span class="n">sm</span><span class="o">.</span><span class="n">graphics</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">plot_pacf</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">414</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">51</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Sampling PACF of an SARIMA process&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/3_Algorithms_ML_TS_Linear_96_0.png" src="../_images/3_Algorithms_ML_TS_Linear_96_0.png" />
<img alt="../_images/3_Algorithms_ML_TS_Linear_96_1.png" src="../_images/3_Algorithms_ML_TS_Linear_96_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># SARIMA(0,0,0)(1,0,0,12)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">123</span><span class="p">)</span>
<span class="n">ar_params</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">])</span>
<span class="n">ma_params</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
<span class="n">ar</span><span class="p">,</span> <span class="n">ma</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="n">ar_params</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">ma_params</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">ArmaProcess</span><span class="p">(</span><span class="n">ar</span><span class="p">,</span> <span class="n">ma</span><span class="p">)</span><span class="o">.</span><span class="n">generate_sample</span><span class="p">(</span><span class="mi">500</span><span class="p">,</span> <span class="n">burnin</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="s1">&#39;o-&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">9</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">411</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">sm</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">ArmaProcess</span><span class="p">(</span><span class="n">ar</span><span class="p">,</span> <span class="n">ma</span><span class="p">)</span><span class="o">.</span><span class="n">acf</span><span class="p">(</span><span class="n">lags</span><span class="o">=</span><span class="mi">50</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">51</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Theoretical ACF of an SARIMA process&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">412</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">sm</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">ArmaProcess</span><span class="p">(</span><span class="n">ar</span><span class="p">,</span> <span class="n">ma</span><span class="p">)</span><span class="o">.</span><span class="n">pacf</span><span class="p">(</span><span class="n">lags</span><span class="o">=</span><span class="mi">50</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">51</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Theoretical PACF of an SARIMA process&quot;</span><span class="p">)</span>

<span class="n">sm</span><span class="o">.</span><span class="n">graphics</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">plot_acf</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">413</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">51</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Sampling ACF of an SARIMA process&quot;</span><span class="p">)</span>

<span class="n">sm</span><span class="o">.</span><span class="n">graphics</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">plot_pacf</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">414</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">51</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Sampling PACF of an SARIMA process&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/3_Algorithms_ML_TS_Linear_97_0.png" src="../_images/3_Algorithms_ML_TS_Linear_97_0.png" />
<img alt="../_images/3_Algorithms_ML_TS_Linear_97_1.png" src="../_images/3_Algorithms_ML_TS_Linear_97_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># SARIMA(0,0,0)(0,1,1,12)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">123</span><span class="p">)</span>
<span class="n">ar_params</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.99</span><span class="p">])</span>
<span class="n">ma_params</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">])</span>
<span class="n">ar</span><span class="p">,</span> <span class="n">ma</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="n">ar_params</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">ma_params</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">ArmaProcess</span><span class="p">(</span><span class="n">ar</span><span class="p">,</span> <span class="n">ma</span><span class="p">)</span><span class="o">.</span><span class="n">generate_sample</span><span class="p">(</span><span class="mi">500</span><span class="p">,</span> <span class="n">burnin</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="s1">&#39;o-&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">9</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">411</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">sm</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">ArmaProcess</span><span class="p">(</span><span class="n">ar</span><span class="p">,</span> <span class="n">ma</span><span class="p">)</span><span class="o">.</span><span class="n">acf</span><span class="p">(</span><span class="n">lags</span><span class="o">=</span><span class="mi">50</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">51</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Theoretical ACF of an SARIMA process&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">412</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">sm</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">ArmaProcess</span><span class="p">(</span><span class="n">ar</span><span class="p">,</span> <span class="n">ma</span><span class="p">)</span><span class="o">.</span><span class="n">pacf</span><span class="p">(</span><span class="n">lags</span><span class="o">=</span><span class="mi">50</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">51</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Theoretical PACF of an SARIMA process&quot;</span><span class="p">)</span>

<span class="n">sm</span><span class="o">.</span><span class="n">graphics</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">plot_acf</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">413</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">51</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Sampling ACF of an SARIMA process&quot;</span><span class="p">)</span>

<span class="n">sm</span><span class="o">.</span><span class="n">graphics</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">plot_pacf</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">414</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">51</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Sampling PACF of an SARIMA process&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/3_Algorithms_ML_TS_Linear_98_0.png" src="../_images/3_Algorithms_ML_TS_Linear_98_0.png" />
<img alt="../_images/3_Algorithms_ML_TS_Linear_98_1.png" src="../_images/3_Algorithms_ML_TS_Linear_98_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># SARIMA(0,0,0)(1,1,0,12)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">123</span><span class="p">)</span>
<span class="n">ar_params</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.99</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.95</span><span class="p">])</span>
<span class="n">ma_params</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
<span class="n">ar</span><span class="p">,</span> <span class="n">ma</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="n">ar_params</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">ma_params</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">ArmaProcess</span><span class="p">(</span><span class="n">ar</span><span class="p">,</span> <span class="n">ma</span><span class="p">)</span><span class="o">.</span><span class="n">generate_sample</span><span class="p">(</span><span class="mi">500</span><span class="p">,</span> <span class="n">burnin</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="s1">&#39;o-&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">9</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">411</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">sm</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">ArmaProcess</span><span class="p">(</span><span class="n">ar</span><span class="p">,</span> <span class="n">ma</span><span class="p">)</span><span class="o">.</span><span class="n">acf</span><span class="p">(</span><span class="n">lags</span><span class="o">=</span><span class="mi">50</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">51</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Theoretical ACF of an SARIMA process&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">412</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">sm</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">ArmaProcess</span><span class="p">(</span><span class="n">ar</span><span class="p">,</span> <span class="n">ma</span><span class="p">)</span><span class="o">.</span><span class="n">pacf</span><span class="p">(</span><span class="n">lags</span><span class="o">=</span><span class="mi">50</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">51</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Theoretical PACF of an SARIMA process&quot;</span><span class="p">)</span>

<span class="n">sm</span><span class="o">.</span><span class="n">graphics</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">plot_acf</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">413</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">51</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Sampling ACF of an SARIMA process&quot;</span><span class="p">)</span>

<span class="n">sm</span><span class="o">.</span><span class="n">graphics</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">plot_pacf</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">414</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">51</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Sampling PACF of an SARIMA process&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/3_Algorithms_ML_TS_Linear_99_0.png" src="../_images/3_Algorithms_ML_TS_Linear_99_0.png" />
<img alt="../_images/3_Algorithms_ML_TS_Linear_99_1.png" src="../_images/3_Algorithms_ML_TS_Linear_99_1.png" />
</div>
</div>
</div>
<div class="section" id="multiplicated-sarima-acf">
<h4>Multiplicated SARIMA: 계절성 시차와 그 주변의 시차에서도 ACF가 유의하지 않음<a class="headerlink" href="#multiplicated-sarima-acf" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><p><strong>SARIMA(0,0,1)(0,0,1,12):</strong> 계절주기 12고 계절주기 자료들 간에는 ARIMA(0,0,1), 비계절 자료들 간에는 ARIMA(0,0,1)</p></li>
</ul>
<blockquote>
<div><ul class="simple">
<li><p>시차(Lag)가 1, 11, 12, 13인 경우를 제외하고는 자기상관계수가 모두 0</p></li>
</ul>
</div></blockquote>
<p>\begin{align*}
\text{Main Equation} &amp;&amp; Y_t &amp;= (1+\theta L)(1+\Theta L^{12}) \epsilon_t = \epsilon_t + \theta \epsilon_{t-1} + \Theta \epsilon_{t-12} + \theta\Theta \epsilon_{t-13} \
\text{Autocorrelation} &amp;&amp; \rho_1 &amp;= -\dfrac{\theta}{1+\theta^2} \
&amp;&amp; \rho_{11} = \rho_{13} &amp;= \dfrac{\theta\Theta}{(1+\theta^2)(1+\Theta^2)} \
&amp;&amp; \rho_{12} &amp;= -\dfrac{\Theta}{1+\Theta^2} \
\end{align*}</p>
<ul class="simple">
<li><p><strong>SARIMA(0,0,1)(1,0,0,12):</strong> 계절주기 12고 계절주기 자료들 간에는 ARIMA(1,0,0), 비계절 자료들 간에는 ARIMA(0,0,1)</p></li>
</ul>
<blockquote>
<div><ul class="simple">
<li><p>시차(Lag)가 12의 배수와 그 앞/뒤인 경우(12<span class="math notranslate nohighlight">\(k\)</span>, 12<span class="math notranslate nohighlight">\(k\)</span>+1, 12<span class="math notranslate nohighlight">\(k\)</span>-1)를 제외하고는 자기상관계수가 모두 0</p></li>
</ul>
</div></blockquote>
<p>\begin{align*}
\text{Main Equation} &amp;&amp; (1 - \Phi L^{12})Y_t &amp;= (1 + \theta L) \epsilon_t \
&amp;&amp; Y_t &amp;=  \Phi Y_{t-12} + \epsilon_t + \theta \epsilon_{t-1} \
\text{Autocorrelation} &amp;&amp; \rho_{12k} &amp;= (-1)^{k+1}\Phi^k \
&amp;&amp; \rho_1 &amp;= -\dfrac{\theta}{1+\theta^2} \
&amp;&amp; \rho_{12k-1} = \rho_{12k+1} &amp;= (-1)^{k+1}\dfrac{\theta}{1+\theta^2} \Phi^k \
\end{align*}</p>
<ul class="simple">
<li><p><strong>SARIMA(0,1,0)(0,1,0,12):</strong> 계절주기 12고 계절주기 간 1차 차분 ARIMA(0,0,0), 비계절 자료들 간 1차 차분 ARIMA(0,0,0)</p></li>
</ul>
<blockquote>
<div><ul class="simple">
<li><p>시계열을 1차 차분하고 그 시계열을 다시 12간격 차분하면 백색잡음</p></li>
</ul>
</div></blockquote>
<p>\begin{align*}
\text{Main Equation} &amp;&amp; (1 - L^{12})(1 - L)Y_t &amp;= \epsilon_t \
&amp;&amp; (1 - L^{12})(Y_t - Y_{t-1}) &amp;= \epsilon_t \
&amp;&amp; Y_t - Y_{t-1} - Y_{t-12} + Y_{t-13} &amp;= \epsilon_t \
&amp;&amp; Y_t &amp;= Y_{t-1} + Y_{t-12} - Y_{t-13} + \epsilon_t \
\end{align*}</p>
<ul class="simple">
<li><p><strong>SARIMA(0,1,1)(0,1,1,12):</strong> 계절주기 12고 계절/비계절 자료 모두 1차 차분 ARIMA(0,1,1)</p></li>
</ul>
<blockquote>
<div><ul class="simple">
<li><p>시계열을 1차 차분하고 그 시계열을 다시 12간격 차분하면 계절/비계절 자료 모두 ARIMA(0,0,1)</p></li>
</ul>
</div></blockquote>
<p>\begin{align*}
\text{Main Equation} &amp;&amp; (1 - L^{12})(1 - L)Y_t &amp;= (1 + \theta L)(1 + \Theta L^{12}) \epsilon_t \
&amp;&amp; (1 - L^{12})(Y_t - Y_{t-1}) &amp;= \epsilon_t + \theta \epsilon_{t-1} + \Theta \epsilon_{t-12} + \theta\Theta \epsilon_{t-13} \
&amp;&amp; Y_t - Y_{t-1} - Y_{t-12} + Y_{t-13} &amp;= \epsilon_t + \theta \epsilon_{t-1} + \Theta \epsilon_{t-12} + \theta\Theta \epsilon_{t-13} \
&amp;&amp; Y_t &amp;= Y_{t-1} + Y_{t-12} - Y_{t-13} + \epsilon_t + \theta \epsilon_{t-1} + \Theta \epsilon_{t-12} + \theta\Theta \epsilon_{t-13} \
\end{align*}</p>
<ul class="simple">
<li><p><strong>SARIMA(1,1,0)(1,1,0,12):</strong> 계절주기 12고 계절/비계절 자료 모두 1차 차분 ARIMA(1,1,0)</p></li>
</ul>
<blockquote>
<div><ul class="simple">
<li><p>시계열을 1차 차분하고 그 시계열을 다시 12간격 차분하면 계절/비계절 자료 모두 ARIMA(1,0,0)</p></li>
</ul>
</div></blockquote>
<p>\begin{align*}
\text{Main Equation} &amp;&amp; (1 - \phi L)(1 - \Phi L^{12})(1 - L^{12})(1 - L)Y_t &amp;= \epsilon_t \
&amp;&amp; (1 - \phi L)(1 - \Phi L^{12})(1 - L^{12})(Y_t - Y_{t-1}) &amp;= \epsilon_t \
&amp;&amp; (1 - \phi L)(1 - \Phi L^{12})(Y_t - Y_{t-1} - Y_{t-12} + Y_{t-13}) &amp;= \epsilon_t \
&amp;&amp; (1 - \phi L)(Y_t - Y_{t-1} - Y_{t-12} + Y_{t-13} - \Phi Y_{t-12} + \Phi Y_{t-13} + \Phi Y_{t-24} - \Phi Y_{t-25})  Y_t &amp;= \epsilon_t \
&amp;&amp; (1 - \phi L)(Y_t - Y_{t-1} - (1 + \Phi)Y_{t-12} + (1 + \Phi)Y_{t-13} + \Phi Y_{t-24} - \Phi Y_{t-25})  Y_t &amp;= \epsilon_t \
&amp;&amp; Y_t - Y_{t-1} - (1 + \Phi)Y_{t-12} + (1 + \Phi)Y_{t-13} + \Phi Y_{t-24} - \Phi Y_{t-25} &amp;\
&amp;&amp; - \phi Y_{t-1} +\phi Y_{t-2} +\phi (1 + \Phi)Y_{t-13} -\phi (1 + \Phi)Y_{t-14} -\phi \Phi Y_{t-25} +\phi \Phi Y_{t-26} &amp;= \epsilon_t \
&amp;&amp; Y_t - (1+\phi) Y_{t-1} +\phi Y_{t-2} - (1 + \Phi)Y_{t-12} +((1 + \Phi)+\phi (1 + \Phi))Y_{t-13} &amp;\
&amp;&amp; -\phi (1 + \Phi)Y_{t-14} + \Phi Y_{t-24} - (\Phi+\phi \Phi) Y_{t-25} +\phi \Phi Y_{t-26} &amp;= \epsilon_t \
\end{align*}</p>
<ul class="simple">
<li><p><strong>예시:</strong></p></li>
</ul>
<blockquote>
<div><p>(원 데이터)</p>
<center><img src='Image/TS_SARIMA_Example1.png' width='600'></center>  
</div></blockquote>
<blockquote>
<div><ul class="simple">
<li><p><span class="math notranslate nohighlight">\(p:2?\)</span> (PACF 기준 lag 2까지 유의하고 그 뒤로는 유의하지 않음)</p></li>
<li><p><span class="math notranslate nohighlight">\(d:1?\)</span> (ADF가 대중가설을 기각하므로 추세 1차 차분)</p></li>
<li><p><span class="math notranslate nohighlight">\(q:1?\)</span> (ACF 기준 필요성 인지)</p></li>
<li><p><span class="math notranslate nohighlight">\(P:1?\)</span> (PACF 기준 lag 24 간격 유의성으로 필요성 인지)</p></li>
<li><p><span class="math notranslate nohighlight">\(D:1?\)</span> (계절성 차분 필요함 인지)</p></li>
<li><p><span class="math notranslate nohighlight">\(Q:2?\)</span> (ACF 기준 lag 24 간격 유의성으로 필요성 인지)</p></li>
<li><p><span class="math notranslate nohighlight">\(m:24?\)</span> (ACF/PACF 기준 lag 24 간격으로 유의한 진동 존재)</p></li>
</ul>
</div></blockquote>
<blockquote>
<div><p>(계절차분 후 데이터)</p>
<center><img src='Image/TS_SARIMA_Example2.png' width='600'></center>  
</div></blockquote>
<blockquote>
<div><ul class="simple">
<li><p><span class="math notranslate nohighlight">\(p:1?\)</span> (PACF 기준 lag 1까지 유의하고 그 뒤로는 유의하지 않음)</p></li>
<li><p><span class="math notranslate nohighlight">\(d:1?\)</span> (ADF가 대중가설을 기각하고 그래프 상 추세가 보이므로 일단 추세 1차 차분)</p></li>
<li><p><span class="math notranslate nohighlight">\(q:3?\)</span> (ACF 기준 필요성 인지)</p></li>
<li><p><span class="math notranslate nohighlight">\(P:2?\)</span> (PACF 기준 lag 24 간격 유의성으로 필요성 인지)</p></li>
<li><p><span class="math notranslate nohighlight">\(D:1\)</span> (계절성 차분 필요)</p></li>
<li><p><span class="math notranslate nohighlight">\(Q:0?\)</span> (ACF 기준 lag 24 간격 유의성으로 필요성 인지)</p></li>
<li><p><span class="math notranslate nohighlight">\(m:24\)</span> (ACF/PACF 기준 lag 24 간격으로 유의한 진동 크게 사라짐)</p></li>
</ul>
</div></blockquote>
<blockquote>
<div><p>(계절성 및 추세차분 후 데이터)</p>
<center><img src='Image/TS_SARIMA_Example3.png' width='600'></center>  
</div></blockquote>
<blockquote>
<div><ul class="simple">
<li><p><span class="math notranslate nohighlight">\(p:max4\)</span> (PACF 기준 lag 4까지 유의하고 그 뒤로는 유의하지 않음)</p></li>
<li><p><span class="math notranslate nohighlight">\(d:1\)</span> (ADF가 대중가설을 기각하고 그래프 상 추세도 없어졌으므로 추세 1차 차분 확정)</p></li>
<li><p><span class="math notranslate nohighlight">\(q:max4\)</span> (ACF 기준 lag 4까지 유의하고 그 뒤로는 유의하지 않음)</p></li>
<li><p><span class="math notranslate nohighlight">\(P:max2\)</span> (PACF 기준 lag 24 간격으로 2번정도 유의함)</p></li>
<li><p><span class="math notranslate nohighlight">\(D:1\)</span> (계절성 차분 필요함 인지)</p></li>
<li><p><span class="math notranslate nohighlight">\(Q:max1\)</span> (ACF 기준 lag 24 간격으로 1번정도 유의함)</p></li>
<li><p><span class="math notranslate nohighlight">\(m:24\)</span> (lag 24 간격으로 진동 존재)</p></li>
</ul>
</div></blockquote>
<blockquote>
<div><p>(잔차검증)</p>
<center><img src='Image/TS_SARIMA_Example4.png' width='600'></center>  </div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># SARIMA(0,0,1)(0,0,1,12)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">123</span><span class="p">)</span>
<span class="n">phi</span><span class="p">,</span> <span class="n">Phi</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
<span class="n">theta</span><span class="p">,</span> <span class="n">Theta</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.8</span>
<span class="n">ar_params</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
<span class="n">ma_params</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">theta</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">Theta</span><span class="p">,</span> <span class="n">theta</span><span class="o">*</span><span class="n">Theta</span><span class="p">])</span>
<span class="n">ar</span><span class="p">,</span> <span class="n">ma</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="n">ar_params</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">ma_params</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">ArmaProcess</span><span class="p">(</span><span class="n">ar</span><span class="p">,</span> <span class="n">ma</span><span class="p">)</span><span class="o">.</span><span class="n">generate_sample</span><span class="p">(</span><span class="mi">500</span><span class="p">,</span> <span class="n">burnin</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="s1">&#39;o-&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">9</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">411</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">sm</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">ArmaProcess</span><span class="p">(</span><span class="n">ar</span><span class="p">,</span> <span class="n">ma</span><span class="p">)</span><span class="o">.</span><span class="n">acf</span><span class="p">(</span><span class="n">lags</span><span class="o">=</span><span class="mi">50</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">51</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Theoretical ACF of an SARIMA process&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">412</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">sm</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">ArmaProcess</span><span class="p">(</span><span class="n">ar</span><span class="p">,</span> <span class="n">ma</span><span class="p">)</span><span class="o">.</span><span class="n">pacf</span><span class="p">(</span><span class="n">lags</span><span class="o">=</span><span class="mi">50</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">51</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Theoretical PACF of an SARIMA process&quot;</span><span class="p">)</span>

<span class="n">sm</span><span class="o">.</span><span class="n">graphics</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">plot_acf</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">413</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">51</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Sampling ACF of an SARIMA process&quot;</span><span class="p">)</span>

<span class="n">sm</span><span class="o">.</span><span class="n">graphics</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">plot_pacf</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">414</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">51</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Sampling PACF of an SARIMA process&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/3_Algorithms_ML_TS_Linear_101_0.png" src="../_images/3_Algorithms_ML_TS_Linear_101_0.png" />
<img alt="../_images/3_Algorithms_ML_TS_Linear_101_1.png" src="../_images/3_Algorithms_ML_TS_Linear_101_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># SARIMA(0,0,1)(1,0,0,12)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">123</span><span class="p">)</span>
<span class="n">phi</span><span class="p">,</span> <span class="n">Phi</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.75</span>
<span class="n">theta</span><span class="p">,</span> <span class="n">Theta</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">0</span>
<span class="n">ar_params</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">Phi</span><span class="p">])</span>
<span class="n">ma_params</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">theta</span><span class="p">])</span>
<span class="n">ar</span><span class="p">,</span> <span class="n">ma</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="n">ar_params</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">ma_params</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">ArmaProcess</span><span class="p">(</span><span class="n">ar</span><span class="p">,</span> <span class="n">ma</span><span class="p">)</span><span class="o">.</span><span class="n">generate_sample</span><span class="p">(</span><span class="mi">500</span><span class="p">,</span> <span class="n">burnin</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="s1">&#39;o-&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">9</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">411</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">sm</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">ArmaProcess</span><span class="p">(</span><span class="n">ar</span><span class="p">,</span> <span class="n">ma</span><span class="p">)</span><span class="o">.</span><span class="n">acf</span><span class="p">(</span><span class="n">lags</span><span class="o">=</span><span class="mi">50</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">51</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Theoretical ACF of an SARIMA process&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">412</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">sm</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">ArmaProcess</span><span class="p">(</span><span class="n">ar</span><span class="p">,</span> <span class="n">ma</span><span class="p">)</span><span class="o">.</span><span class="n">pacf</span><span class="p">(</span><span class="n">lags</span><span class="o">=</span><span class="mi">50</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">51</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Theoretical PACF of an SARIMA process&quot;</span><span class="p">)</span>

<span class="n">sm</span><span class="o">.</span><span class="n">graphics</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">plot_acf</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">413</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">51</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Sampling ACF of an SARIMA process&quot;</span><span class="p">)</span>

<span class="n">sm</span><span class="o">.</span><span class="n">graphics</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">plot_pacf</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">414</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">51</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Sampling PACF of an SARIMA process&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/3_Algorithms_ML_TS_Linear_102_0.png" src="../_images/3_Algorithms_ML_TS_Linear_102_0.png" />
<img alt="../_images/3_Algorithms_ML_TS_Linear_102_1.png" src="../_images/3_Algorithms_ML_TS_Linear_102_1.png" />
</div>
</div>
</div>
</div>
<div class="section" id="sarima">
<h3>실습: 호흡기질환 사망자수 SARIMA 모델링<a class="headerlink" href="#sarima" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;always&#39;</span><span class="p">)</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>

<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="nn">sm</span>

<span class="c1"># 데이터로딩 및 확인</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">get_rdataset</span><span class="p">(</span><span class="s2">&quot;deaths&quot;</span><span class="p">,</span> <span class="s2">&quot;MASS&quot;</span><span class="p">)</span>
<span class="n">raw</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">data</span>
<span class="n">raw</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">raw</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
<span class="n">raw</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;value&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># ACF/PACF 확인</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">sm</span><span class="o">.</span><span class="n">graphics</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">plot_acf</span><span class="p">(</span><span class="n">raw</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">211</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">51</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;ACF&quot;</span><span class="p">)</span>

<span class="n">sm</span><span class="o">.</span><span class="n">graphics</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">plot_pacf</span><span class="p">(</span><span class="n">raw</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">212</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">51</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;PACF&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># ARMA(1,1) 모델링</span>
<span class="n">fit</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">SARIMAX</span><span class="p">(</span><span class="n">raw</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">trend</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">seasonal_order</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">display</span><span class="p">(</span><span class="n">fit</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>

<span class="c1"># 잔차진단</span>
<span class="n">fit</span><span class="o">.</span><span class="n">plot_diagnostics</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/3_Algorithms_ML_TS_Linear_104_0.png" src="../_images/3_Algorithms_ML_TS_Linear_104_0.png" />
<img alt="../_images/3_Algorithms_ML_TS_Linear_104_1.png" src="../_images/3_Algorithms_ML_TS_Linear_104_1.png" />
<div class="output text_html"><table class="simpletable">
<caption>SARIMAX Results</caption>
<tr>
  <th>Dep. Variable:</th>         <td>value</td>      <th>  No. Observations:  </th>   <td>72</td>   
</tr>
<tr>
  <th>Model:</th>           <td>SARIMAX(1, 0, 1)</td> <th>  Log Likelihood     </th> <td>31.982</td> 
</tr>
<tr>
  <th>Date:</th>            <td>Fri, 31 Jul 2020</td> <th>  AIC                </th> <td>-55.965</td>
</tr>
<tr>
  <th>Time:</th>                <td>22:46:34</td>     <th>  BIC                </th> <td>-46.858</td>
</tr>
<tr>
  <th>Sample:</th>                  <td>0</td>        <th>  HQIC               </th> <td>-52.339</td>
</tr>
<tr>
  <th></th>                       <td> - 72</td>      <th>                     </th>    <td> </td>   
</tr>
<tr>
  <th>Covariance Type:</th>        <td>opg</td>       <th>                     </th>    <td> </td>   
</tr>
</table>
<table class="simpletable">
<tr>
      <td></td>         <th>coef</th>     <th>std err</th>      <th>z</th>      <th>P>|z|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>intercept</th> <td>    2.4194</td> <td>    0.765</td> <td>    3.161</td> <td> 0.002</td> <td>    0.919</td> <td>    3.920</td>
</tr>
<tr>
  <th>ar.L1</th>     <td>    0.6818</td> <td>    0.100</td> <td>    6.846</td> <td> 0.000</td> <td>    0.487</td> <td>    0.877</td>
</tr>
<tr>
  <th>ma.L1</th>     <td>    0.4668</td> <td>    0.116</td> <td>    4.027</td> <td> 0.000</td> <td>    0.240</td> <td>    0.694</td>
</tr>
<tr>
  <th>sigma2</th>    <td>    0.0236</td> <td>    0.004</td> <td>    5.416</td> <td> 0.000</td> <td>    0.015</td> <td>    0.032</td>
</tr>
</table>
<table class="simpletable">
<tr>
  <th>Ljung-Box (Q):</th>          <td>161.08</td> <th>  Jarque-Bera (JB):  </th> <td>12.13</td>
</tr>
<tr>
  <th>Prob(Q):</th>                 <td>0.00</td>  <th>  Prob(JB):          </th> <td>0.00</td> 
</tr>
<tr>
  <th>Heteroskedasticity (H):</th>  <td>1.00</td>  <th>  Skew:              </th> <td>0.94</td> 
</tr>
<tr>
  <th>Prob(H) (two-sided):</th>     <td>0.99</td>  <th>  Kurtosis:          </th> <td>3.73</td> 
</tr>
</table><br/><br/>Warnings:<br/>[1] Covariance matrix calculated using the outer product of gradients (complex-step).</div><img alt="../_images/3_Algorithms_ML_TS_Linear_104_3.png" src="../_images/3_Algorithms_ML_TS_Linear_104_3.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># SARIMA 모델링</span>
<span class="n">fit</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">SARIMAX</span><span class="p">(</span><span class="n">raw</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">trend</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">seasonal_order</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">12</span><span class="p">))</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">display</span><span class="p">(</span><span class="n">fit</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>

<span class="c1"># 잔차진단</span>
<span class="n">fit</span><span class="o">.</span><span class="n">plot_diagnostics</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="simpletable">
<caption>SARIMAX Results</caption>
<tr>
  <th>Dep. Variable:</th>                <td>value</td>             <th>  No. Observations:  </th>   <td>72</td>   
</tr>
<tr>
  <th>Model:</th>           <td>SARIMAX(1, 0, 1)x(1, 1, 1, 12)</td> <th>  Log Likelihood     </th> <td>52.592</td> 
</tr>
<tr>
  <th>Date:</th>                   <td>Fri, 31 Jul 2020</td>        <th>  AIC                </th> <td>-93.184</td>
</tr>
<tr>
  <th>Time:</th>                       <td>22:46:36</td>            <th>  BIC                </th> <td>-80.618</td>
</tr>
<tr>
  <th>Sample:</th>                         <td>0</td>               <th>  HQIC               </th> <td>-88.269</td>
</tr>
<tr>
  <th></th>                              <td> - 72</td>             <th>                     </th>    <td> </td>   
</tr>
<tr>
  <th>Covariance Type:</th>               <td>opg</td>              <th>                     </th>    <td> </td>   
</tr>
</table>
<table class="simpletable">
<tr>
      <td></td>         <th>coef</th>     <th>std err</th>      <th>z</th>      <th>P>|z|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>intercept</th> <td>   -0.0480</td> <td>    0.022</td> <td>   -2.211</td> <td> 0.027</td> <td>   -0.091</td> <td>   -0.005</td>
</tr>
<tr>
  <th>ar.L1</th>     <td>   -0.1563</td> <td>    0.436</td> <td>   -0.359</td> <td> 0.720</td> <td>   -1.010</td> <td>    0.698</td>
</tr>
<tr>
  <th>ma.L1</th>     <td>    0.5718</td> <td>    0.273</td> <td>    2.097</td> <td> 0.036</td> <td>    0.037</td> <td>    1.106</td>
</tr>
<tr>
  <th>ar.S.L12</th>  <td>   -0.2861</td> <td>    0.203</td> <td>   -1.406</td> <td> 0.160</td> <td>   -0.685</td> <td>    0.113</td>
</tr>
<tr>
  <th>ma.S.L12</th>  <td>   -0.9670</td> <td>    4.319</td> <td>   -0.224</td> <td> 0.823</td> <td>   -9.431</td> <td>    7.497</td>
</tr>
<tr>
  <th>sigma2</th>    <td>    0.0066</td> <td>    0.028</td> <td>    0.239</td> <td> 0.811</td> <td>   -0.047</td> <td>    0.061</td>
</tr>
</table>
<table class="simpletable">
<tr>
  <th>Ljung-Box (Q):</th>          <td>28.57</td> <th>  Jarque-Bera (JB):  </th> <td>74.39</td>
</tr>
<tr>
  <th>Prob(Q):</th>                <td>0.91</td>  <th>  Prob(JB):          </th> <td>0.00</td> 
</tr>
<tr>
  <th>Heteroskedasticity (H):</th> <td>0.64</td>  <th>  Skew:              </th> <td>0.99</td> 
</tr>
<tr>
  <th>Prob(H) (two-sided):</th>    <td>0.32</td>  <th>  Kurtosis:          </th> <td>8.08</td> 
</tr>
</table><br/><br/>Warnings:<br/>[1] Covariance matrix calculated using the outer product of gradients (complex-step).</div><img alt="../_images/3_Algorithms_ML_TS_Linear_105_1.png" src="../_images/3_Algorithms_ML_TS_Linear_105_1.png" />
</div>
</div>
</div>
<div class="section" id="id13">
<h3>실습: 항공사 승객수요 SARIMA 모델링<a class="headerlink" href="#id13" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 라이브러리 호출</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="nn">sm</span>

<span class="c1"># 데이터 준비</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">get_rdataset</span><span class="p">(</span><span class="s2">&quot;AirPassengers&quot;</span><span class="p">)</span>
<span class="n">raw</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="c1"># 데이터 전처리</span>
<span class="c1">## 시간 인덱싱</span>
<span class="k">if</span> <span class="s1">&#39;time&#39;</span> <span class="ow">in</span> <span class="n">raw</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
    <span class="n">raw</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="s1">&#39;1/1/1949&#39;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">raw</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]),</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;M&#39;</span><span class="p">)</span>
    <span class="k">del</span> <span class="n">raw</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span>

<span class="c1">## 정상성 확보</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="n">raw</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">221</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">raw</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">222</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;log(Y)&#39;</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">raw</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">223</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;diff1(Y)&#39;</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">raw</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">224</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;diff1(log(Y))&#39;</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/3_Algorithms_ML_TS_Linear_107_0.png" src="../_images/3_Algorithms_ML_TS_Linear_107_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># ARIMA 모델링 (raw)</span>
<span class="n">fit</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">SARIMAX</span><span class="p">(</span><span class="n">raw</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">trend</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">seasonal_order</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">display</span><span class="p">(</span><span class="n">fit</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>

<span class="c1"># 잔차진단</span>
<span class="n">fit</span><span class="o">.</span><span class="n">plot_diagnostics</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># ARIMA 모델링 (log(raw))</span>
<span class="n">fit</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">SARIMAX</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">raw</span><span class="o">.</span><span class="n">value</span><span class="p">),</span> <span class="n">trend</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">seasonal_order</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">display</span><span class="p">(</span><span class="n">fit</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>

<span class="c1"># 잔차진단</span>
<span class="n">fit</span><span class="o">.</span><span class="n">plot_diagnostics</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="simpletable">
<caption>SARIMAX Results</caption>
<tr>
  <th>Dep. Variable:</th>         <td>value</td>      <th>  No. Observations:  </th>    <td>144</td>  
</tr>
<tr>
  <th>Model:</th>           <td>SARIMAX(1, 1, 1)</td> <th>  Log Likelihood     </th> <td>-694.060</td>
</tr>
<tr>
  <th>Date:</th>            <td>Fri, 31 Jul 2020</td> <th>  AIC                </th> <td>1396.121</td>
</tr>
<tr>
  <th>Time:</th>                <td>22:46:41</td>     <th>  BIC                </th> <td>1407.972</td>
</tr>
<tr>
  <th>Sample:</th>             <td>01-31-1949</td>    <th>  HQIC               </th> <td>1400.937</td>
</tr>
<tr>
  <th></th>                   <td>- 12-31-1960</td>   <th>                     </th>     <td> </td>   
</tr>
<tr>
  <th>Covariance Type:</th>        <td>opg</td>       <th>                     </th>     <td> </td>   
</tr>
</table>
<table class="simpletable">
<tr>
      <td></td>         <th>coef</th>     <th>std err</th>      <th>z</th>      <th>P>|z|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>intercept</th> <td>    3.6187</td> <td>    5.001</td> <td>    0.724</td> <td> 0.469</td> <td>   -6.183</td> <td>   13.421</td>
</tr>
<tr>
  <th>ar.L1</th>     <td>   -0.4768</td> <td>    0.128</td> <td>   -3.736</td> <td> 0.000</td> <td>   -0.727</td> <td>   -0.227</td>
</tr>
<tr>
  <th>ma.L1</th>     <td>    0.8646</td> <td>    0.080</td> <td>   10.746</td> <td> 0.000</td> <td>    0.707</td> <td>    1.022</td>
</tr>
<tr>
  <th>sigma2</th>    <td>  958.4116</td> <td>  107.040</td> <td>    8.954</td> <td> 0.000</td> <td>  748.616</td> <td> 1168.207</td>
</tr>
</table>
<table class="simpletable">
<tr>
  <th>Ljung-Box (Q):</th>          <td>318.10</td> <th>  Jarque-Bera (JB):  </th> <td>2.17</td> 
</tr>
<tr>
  <th>Prob(Q):</th>                 <td>0.00</td>  <th>  Prob(JB):          </th> <td>0.34</td> 
</tr>
<tr>
  <th>Heteroskedasticity (H):</th>  <td>7.01</td>  <th>  Skew:              </th> <td>-0.21</td>
</tr>
<tr>
  <th>Prob(H) (two-sided):</th>     <td>0.00</td>  <th>  Kurtosis:          </th> <td>3.43</td> 
</tr>
</table><br/><br/>Warnings:<br/>[1] Covariance matrix calculated using the outer product of gradients (complex-step).</div><img alt="../_images/3_Algorithms_ML_TS_Linear_108_1.png" src="../_images/3_Algorithms_ML_TS_Linear_108_1.png" />
<div class="output text_html"><table class="simpletable">
<caption>SARIMAX Results</caption>
<tr>
  <th>Dep. Variable:</th>         <td>value</td>      <th>  No. Observations:  </th>    <td>144</td>  
</tr>
<tr>
  <th>Model:</th>           <td>SARIMAX(1, 1, 1)</td> <th>  Log Likelihood     </th>  <td>124.804</td>
</tr>
<tr>
  <th>Date:</th>            <td>Fri, 31 Jul 2020</td> <th>  AIC                </th> <td>-241.608</td>
</tr>
<tr>
  <th>Time:</th>                <td>22:46:41</td>     <th>  BIC                </th> <td>-229.756</td>
</tr>
<tr>
  <th>Sample:</th>             <td>01-31-1949</td>    <th>  HQIC               </th> <td>-236.792</td>
</tr>
<tr>
  <th></th>                   <td>- 12-31-1960</td>   <th>                     </th>     <td> </td>   
</tr>
<tr>
  <th>Covariance Type:</th>        <td>opg</td>       <th>                     </th>     <td> </td>   
</tr>
</table>
<table class="simpletable">
<tr>
      <td></td>         <th>coef</th>     <th>std err</th>      <th>z</th>      <th>P>|z|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>intercept</th> <td>    0.0155</td> <td>    0.016</td> <td>    0.963</td> <td> 0.336</td> <td>   -0.016</td> <td>    0.047</td>
</tr>
<tr>
  <th>ar.L1</th>     <td>   -0.5826</td> <td>    0.170</td> <td>   -3.430</td> <td> 0.001</td> <td>   -0.915</td> <td>   -0.250</td>
</tr>
<tr>
  <th>ma.L1</th>     <td>    0.8502</td> <td>    0.101</td> <td>    8.454</td> <td> 0.000</td> <td>    0.653</td> <td>    1.047</td>
</tr>
<tr>
  <th>sigma2</th>    <td>    0.0102</td> <td>    0.002</td> <td>    5.871</td> <td> 0.000</td> <td>    0.007</td> <td>    0.014</td>
</tr>
</table>
<table class="simpletable">
<tr>
  <th>Ljung-Box (Q):</th>          <td>355.82</td> <th>  Jarque-Bera (JB):  </th> <td>5.93</td>
</tr>
<tr>
  <th>Prob(Q):</th>                 <td>0.00</td>  <th>  Prob(JB):          </th> <td>0.05</td>
</tr>
<tr>
  <th>Heteroskedasticity (H):</th>  <td>1.07</td>  <th>  Skew:              </th> <td>0.04</td>
</tr>
<tr>
  <th>Prob(H) (two-sided):</th>     <td>0.81</td>  <th>  Kurtosis:          </th> <td>2.01</td>
</tr>
</table><br/><br/>Warnings:<br/>[1] Covariance matrix calculated using the outer product of gradients (complex-step).</div><img alt="../_images/3_Algorithms_ML_TS_Linear_108_3.png" src="../_images/3_Algorithms_ML_TS_Linear_108_3.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># SARIMA 모델링 (log(raw))</span>
<span class="n">fit</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">SARIMAX</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">raw</span><span class="o">.</span><span class="n">value</span><span class="p">),</span> <span class="n">trend</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">seasonal_order</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">12</span><span class="p">))</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">display</span><span class="p">(</span><span class="n">fit</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>

<span class="c1"># 잔차진단</span>
<span class="n">fit</span><span class="o">.</span><span class="n">plot_diagnostics</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="simpletable">
<caption>SARIMAX Results</caption>
<tr>
  <th>Dep. Variable:</th>                <td>value</td>             <th>  No. Observations:  </th>    <td>144</td>  
</tr>
<tr>
  <th>Model:</th>           <td>SARIMAX(1, 1, 1)x(1, 1, 1, 12)</td> <th>  Log Likelihood     </th>  <td>245.172</td>
</tr>
<tr>
  <th>Date:</th>                   <td>Fri, 31 Jul 2020</td>        <th>  AIC                </th> <td>-478.344</td>
</tr>
<tr>
  <th>Time:</th>                       <td>22:46:44</td>            <th>  BIC                </th> <td>-461.093</td>
</tr>
<tr>
  <th>Sample:</th>                    <td>01-31-1949</td>           <th>  HQIC               </th> <td>-471.334</td>
</tr>
<tr>
  <th></th>                          <td>- 12-31-1960</td>          <th>                     </th>     <td> </td>   
</tr>
<tr>
  <th>Covariance Type:</th>               <td>opg</td>              <th>                     </th>     <td> </td>   
</tr>
</table>
<table class="simpletable">
<tr>
      <td></td>         <th>coef</th>     <th>std err</th>      <th>z</th>      <th>P>|z|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>intercept</th> <td>   -0.0002</td> <td>    0.001</td> <td>   -0.192</td> <td> 0.848</td> <td>   -0.002</td> <td>    0.001</td>
</tr>
<tr>
  <th>ar.L1</th>     <td>    0.1728</td> <td>    0.214</td> <td>    0.809</td> <td> 0.418</td> <td>   -0.246</td> <td>    0.591</td>
</tr>
<tr>
  <th>ma.L1</th>     <td>   -0.5657</td> <td>    0.186</td> <td>   -3.046</td> <td> 0.002</td> <td>   -0.930</td> <td>   -0.202</td>
</tr>
<tr>
  <th>ar.S.L12</th>  <td>   -0.0949</td> <td>    0.202</td> <td>   -0.470</td> <td> 0.638</td> <td>   -0.491</td> <td>    0.301</td>
</tr>
<tr>
  <th>ma.S.L12</th>  <td>   -0.5019</td> <td>    0.218</td> <td>   -2.300</td> <td> 0.021</td> <td>   -0.930</td> <td>   -0.074</td>
</tr>
<tr>
  <th>sigma2</th>    <td>    0.0013</td> <td>    0.000</td> <td>    8.474</td> <td> 0.000</td> <td>    0.001</td> <td>    0.002</td>
</tr>
</table>
<table class="simpletable">
<tr>
  <th>Ljung-Box (Q):</th>          <td>37.14</td> <th>  Jarque-Bera (JB):  </th> <td>3.52</td> 
</tr>
<tr>
  <th>Prob(Q):</th>                <td>0.60</td>  <th>  Prob(JB):          </th> <td>0.17</td> 
</tr>
<tr>
  <th>Heteroskedasticity (H):</th> <td>0.61</td>  <th>  Skew:              </th> <td>-0.02</td>
</tr>
<tr>
  <th>Prob(H) (two-sided):</th>    <td>0.10</td>  <th>  Kurtosis:          </th> <td>3.80</td> 
</tr>
</table><br/><br/>Warnings:<br/>[1] Covariance matrix calculated using the outer product of gradients (complex-step).</div><img alt="../_images/3_Algorithms_ML_TS_Linear_109_1.png" src="../_images/3_Algorithms_ML_TS_Linear_109_1.png" />
</div>
</div>
</div>
</div>
<div class="section" id="id14">
<h2>선형확률과정의 분석싸이클<a class="headerlink" href="#id14" title="Permalink to this headline">¶</a></h2>
<div class="section" id="non-seasonal">
<h3>분석싸이클 정리(Non-seasonal)<a class="headerlink" href="#non-seasonal" title="Permalink to this headline">¶</a></h3>
<p><strong>1. 분석싸이클 제시: <a class="reference external" href="https://en.wikipedia.org/wiki/Box%E2%80%93Jenkins_method">&lt;박스-젠킨스 방법론&gt;</a></strong></p>
<blockquote>
<div><p><strong>1) 모형의 모수추정(Model Identification):</strong>
- 시계열 데이터의 정상성을 확인하고 계절변동이 있는지도 확인<br />
- ACF/PACF 를 사용해서 자기회귀이동평균 모형 p,q 차수를 결정</p>
</div></blockquote>
<blockquote>
<div><p><strong>2) 모델링 및 검증(Parameter Estimation):</strong><br />
- 회귀분석과 기계학습 등의 검증지표를 마찬가지로 사용<br />
- 모형 추정은 최소제곱방법과 유사하지만 가우스-뉴튼 아이디어에 기초한 수치해석방법을 적용</p>
</div></blockquote>
<blockquote>
<div><p><strong>3) 잔차진단(Model Diagnostics):</strong><br />
- 자기회귀이동평균 모형을 적용시키고 남은 잔차의 정상성을 확인하는데 중점<br />
- 잔차가 서로 독립이고 시간에 따라 평균과 분산이 일정한지 검증
- 시계열 데이터의 자기상관을 검정하기 위해 다양한 검정통계량을 사용하는데,<br />
Ljung-Box 통계량, 평균과 분산이 일정한지, ACF/PACF 사용하여 추가적으로 모형에 누락된 것이 없는지 검정</p>
</div></blockquote>
<p><strong>2. 분석싸이클 일반화</strong></p>
<blockquote>
<div><p><strong>0) 데이터 전처리 및 시각화를 통해 Outlier 확인/변경/제거</strong></p>
</div></blockquote>
<blockquote>
<div><p><strong>1) 비정상 과정에서 정상 과정 추출</strong></p>
</div></blockquote>
<ul class="simple">
<li><p>결정론적 추세나 확률적 추세가 있는지 확인</p>
<ul>
<li><p>결정론적 추세는 회귀분석, 다항식 등으로 모형화 후 이를 분리</p></li>
<li><p>확률적 추세인 경우, 즉 ARIMA 모형인 경우에는 ADF(Augmented Dickey Fuller) 검정을 사용하여 적분차수(Order of Integration)을 알아내서 차분</p></li>
</ul>
</li>
</ul>
<blockquote>
<div><p><strong>2) 정규성 확인</strong></p>
</div></blockquote>
<ul class="simple">
<li><p>정규성 검정을 통해 자료의 분포가 정규 분포인지 확인</p>
<ul>
<li><p>일반 선형 확률 과정인 경우에는 전체 시계열이 가우시안 백색 잡음의 선형 조합으로 이루어지기 때문에 시계열 자체도 가우시안 정규 분포</p></li>
<li><p>ARIMA 모형 등의 일반 선형 확률 과정으로 모형화하려면 우선 정규성 검정(Normality Test)을 사용하여 분포가 정규 분포인지 확인</p></li>
</ul>
</li>
<li><p>만약 시계열 자료의 분포가 로그 변환이나 Box-Cox 변환을 사용하여 정규성이 개선된다면 이러한 변환을 사용 가능</p></li>
</ul>
<blockquote>
<div><p><strong>3) 정상 과정에 대한 ARMA 모형 차수 결정</strong></p>
</div></blockquote>
<ul class="simple">
<li><p>ACF/PACF 분석으로 AR(p) 모형 또는 MA(q) 모형 결정</p>
<ul>
<li><p>ACF가 특정 차수 이상에서 없어지는 경우(Cut-off)에는 MA 모형을 사용 가능</p></li>
<li><p>PACF가 특정 차수 이상에서 없어지면 AR 모형을 사용 가능</p></li>
<li><p>ACF와 PACF 모두 특정 차수 이상에서 없어지는 현상이 나타나지 않는다면 ARMA 모형을 사용</p></li>
</ul>
</li>
<li><p>ARMA 모형인 경우 모수 추정시 AIC/BIC 값을 이용하여 차수 결정 및 모수추정도 동시에 이루어 짐</p></li>
</ul>
<blockquote>
<div><p><strong>4) ARMA 모형의 모수 추정</strong></p>
</div></blockquote>
<ul class="simple">
<li><p>MM(Method of Modent)/LS(Least Square)/MLE(Maximum Likelihood Estimation) 등의 방법론으로 모수 추정</p></li>
<li><p>ADF(Augmented Dickey Fuller) 검정을 사용하여 해당 수식에 대한 계수 즉 모수 값을 추정</p></li>
<li><p>부트스트래핑을 사용하여 모수의 표준 오차 추정</p></li>
</ul>
<blockquote>
<div><p><strong>5) 잔차 진단(모형 진단)</strong><br />
: 모형이 추정된 다음 진단(Diagnosis) 과정을 통해 추정이 올바르게 이루어졌는지 검증<br />
: 기본적으로 잔차(Residual)가 백색 잡음이 되어야 하므로 잔차에 대해 다음을 조사</p>
</div></blockquote>
<ul class="simple">
<li><p>잔차에 대한 정규성 검정</p></li>
<li><p>잔차에 대한 ACF 분석 또는 Ljung-Box Q 검정으로 모형 차수 재확인<br />
: 잔차가 백색잡음이 아니면 새로운 모형으로 위 모든 단계(0~4단계)를 새로 시작<br />
: 잔차가 백색잡음이면 일단은 예측력을 확인 -&gt; 예측력이 낮을 시 새로운 모형으로 위 모든 단계(0~4단계)를 새로 시작</p></li>
</ul>
<p><strong>3. 분석싸이클 비교:</strong></p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>단계</p></th>
<th class="head"><p>기계학습</p></th>
<th class="head"><p>시계열분석</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>전처리</p></td>
<td><p>변수 확장</p></td>
<td><p>정상성 확보</p></td>
</tr>
<tr class="row-odd"><td><p>시각화</p></td>
<td><p>모델/변수 선택</p></td>
<td><p>모델/파라미터 선택</p></td>
</tr>
<tr class="row-even"><td><p>모델링</p></td>
<td><p>상동</p></td>
<td><p>상동</p></td>
</tr>
<tr class="row-odd"><td><p>검증</p></td>
<td><p>상동</p></td>
<td><p>상동</p></td>
</tr>
<tr class="row-even"><td><p>잔차진단</p></td>
<td><p>상동</p></td>
<td><p>상동</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id15">
<h3>분석싸이클 자동화(Non-seasonal)<a class="headerlink" href="#id15" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p><strong>“Hyndman-Khandakar algorithm for automatic ARIMA modelling”</strong></p></li>
</ul>
<blockquote>
<div><p>차수가 높지않은 SARIMA 알고리즘을 자동화 한 것으로 <a class="reference external" href="https://www.jstatsoft.org/article/view/v027i03">Hyndman-Khandakar 알고리즘(2008)</a>을 기반으로 함<br />
정상성변환(Unit Root Calculation), 검증지표 최적화(AIC) 및 MLE 방법을 사용한 모수추정을 모두 포함</p>
</div></blockquote>
<ul class="simple">
<li><p><strong>자동화 과정:</strong> 일반화 분석싸이클의 2~4단계만 자동화</p></li>
</ul>
<blockquote>
<div><p><strong>1. KPSS 검정통계량을 사용한 독립변수(<span class="math notranslate nohighlight">\(Y_t\)</span>)의 적분차수/차분차수 결정(<span class="math notranslate nohighlight">\(0 \leq d \leq 2\)</span>)</strong></p>
</div></blockquote>
<blockquote>
<div><p><strong>2. 차분된 독립변수 <span class="math notranslate nohighlight">\((1 - L)^d Y_t\)</span>에 <span class="math notranslate nohighlight">\(AIC\)</span>를 줄여가며 초기모형 후보들 적합을 통한 Base모형의 차수 <span class="math notranslate nohighlight">\(p\)</span>와 <span class="math notranslate nohighlight">\(q\)</span>를 선택</strong></p>
<ul class="simple">
<li><p>만약 <span class="math notranslate nohighlight">\(d \leq 1\)</span>, 초기모형 후보 5종
- ARIMA(0,d,0) without constant
- ARIMA(0,d,0) with constant
- ARIMA(0,d,1) with constant
- ARIMA(1,d,0) with constant
- ARIMA(2,d,2) with constant</p></li>
<li><p>만약 <span class="math notranslate nohighlight">\(d = 2\)</span>, 초기모형 후보 4종
- ARIMA(0,d,0) without constant
- ARIMA(0,d,1) without constant
- ARIMA(1,d,0) without constant
- ARIMA(2,d,2) without constant</p></li>
</ul>
</div></blockquote>
<blockquote>
<div><p><strong>3. Base모형의 파라미터 튜닝을 통한 Agile모형 선택</strong></p>
</div></blockquote>
<ol class="simple">
<li><p>Base모형에서 <span class="math notranslate nohighlight">\(p\)</span>와 <span class="math notranslate nohighlight">\(q\)</span>를 <span class="math notranslate nohighlight">\(\pm 1\)</span> 변화시키며 AIC들을 추정</p></li>
<li><p><span class="math notranslate nohighlight">\(p\)</span>와 <span class="math notranslate nohighlight">\(q\)</span> 변경 및 상수항(Constant) 반영/미반영하며 AIC들을 추정</p></li>
<li><p>최적의 Agile모형 선택</p></li>
</ol>
<blockquote>
<div><p><strong>4. 최종 모형 선택</strong></p>
</div></blockquote>
<ol class="simple">
<li><p>추정된 Agile모형을 Base모형으로 변경</p></li>
<li><p>AIC가 더이상 줄어들지 않을 때까지 3번의 과정을 반복하여 Agile모형 재추정</p></li>
<li><p>최종 Agile모형이 최종 선택된 시계열모형</p></li>
</ol>
<center><img src='Image/TS_Analysis_Cycle.png' width='600'></center>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fit</span> <span class="o">=</span> <span class="n">auto_arima</span><span class="p">(</span><span class="n">Y_train</span><span class="p">,</span> <span class="n">stationary</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                 <span class="n">trend</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="n">start_p</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">start_q</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">max_p</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">max_q</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">max_d</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
                 <span class="n">seasonal</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">start_P</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">start_Q</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">max_P</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">max_Q</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">m</span><span class="o">=</span><span class="n">seasonal_diff_order</span><span class="p">,</span>
                 <span class="n">stepwise</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">trace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="auro-arima">
<h3>실습: 항공사 승객수요 Auro-ARIMA 모델링<a class="headerlink" href="#auro-arima" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 라이브러리 호출</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="nn">sm</span>
<span class="o">%</span><span class="k">reload_ext</span> autoreload
<span class="o">%</span><span class="k">autoreload</span> 2
<span class="kn">from</span> <span class="nn">module</span> <span class="kn">import</span> <span class="n">stationarity_adf_test</span><span class="p">,</span> <span class="n">stationarity_kpss_test</span>

<span class="c1"># 데이터 준비</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">get_rdataset</span><span class="p">(</span><span class="s2">&quot;AirPassengers&quot;</span><span class="p">)</span>
<span class="n">raw</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="c1"># 데이터 전처리</span>
<span class="c1">## 시간 인덱싱</span>
<span class="k">if</span> <span class="s1">&#39;time&#39;</span> <span class="ow">in</span> <span class="n">raw</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
    <span class="n">raw</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="s1">&#39;1/1/1949&#39;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">raw</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]),</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;M&#39;</span><span class="p">)</span>
    <span class="k">del</span> <span class="n">raw</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span>

<span class="c1">## 정상성 테스트</span>
<span class="c1">### 미변환</span>
<span class="n">candidate_none</span> <span class="o">=</span> <span class="n">raw</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">display</span><span class="p">(</span><span class="n">stationarity_adf_test</span><span class="p">(</span><span class="n">candidate_none</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="p">[]))</span>
<span class="n">display</span><span class="p">(</span><span class="n">stationarity_kpss_test</span><span class="p">(</span><span class="n">candidate_none</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="p">[]))</span>
<span class="n">sm</span><span class="o">.</span><span class="n">graphics</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">plot_acf</span><span class="p">(</span><span class="n">candidate_none</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">use_vlines</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1">### 로그 변환</span>
<span class="n">candidate_trend</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">raw</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">display</span><span class="p">(</span><span class="n">stationarity_adf_test</span><span class="p">(</span><span class="n">candidate_trend</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="p">[]))</span>
<span class="n">display</span><span class="p">(</span><span class="n">stationarity_kpss_test</span><span class="p">(</span><span class="n">candidate_trend</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="p">[]))</span>
<span class="n">sm</span><span class="o">.</span><span class="n">graphics</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">plot_acf</span><span class="p">(</span><span class="n">candidate_trend</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">use_vlines</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">trend_diff_order_initial</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">stationarity_adf_test</span><span class="p">(</span><span class="n">candidate_trend</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="p">[])</span><span class="o">.</span><span class="n">T</span>
<span class="k">if</span> <span class="n">result</span><span class="p">[</span><span class="s1">&#39;p-value&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mf">0.1</span><span class="p">:</span>
    <span class="n">trend_diff_order</span> <span class="o">=</span> <span class="n">trend_diff_order_initial</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">trend_diff_order</span> <span class="o">=</span> <span class="n">trend_diff_order_initial</span> <span class="o">+</span> <span class="mi">1</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Trend Difference: &#39;</span><span class="p">,</span> <span class="n">trend_diff_order</span><span class="p">)</span>

<span class="c1">### 로그+추세차분 변환</span>
<span class="n">candidate_seasonal</span> <span class="o">=</span> <span class="n">candidate_trend</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">trend_diff_order</span><span class="p">)</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">display</span><span class="p">(</span><span class="n">stationarity_adf_test</span><span class="p">(</span><span class="n">candidate_seasonal</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="p">[]))</span>
<span class="n">display</span><span class="p">(</span><span class="n">stationarity_kpss_test</span><span class="p">(</span><span class="n">candidate_seasonal</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="p">[]))</span>
<span class="n">sm</span><span class="o">.</span><span class="n">graphics</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">plot_acf</span><span class="p">(</span><span class="n">candidate_seasonal</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">use_vlines</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">seasonal_diff_order</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">acf</span><span class="p">(</span><span class="n">candidate_seasonal</span><span class="p">)[</span><span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">argmax</span><span class="p">()</span> <span class="o">+</span> <span class="mi">1</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Seasonal Difference: &#39;</span><span class="p">,</span> <span class="n">seasonal_diff_order</span><span class="p">)</span>

<span class="c1">### 로그+추세차분+계절차분 변환</span>
<span class="n">candidate_final</span> <span class="o">=</span> <span class="n">candidate_seasonal</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">seasonal_diff_order</span><span class="p">)</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">display</span><span class="p">(</span><span class="n">stationarity_adf_test</span><span class="p">(</span><span class="n">candidate_final</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="p">[]))</span>
<span class="n">display</span><span class="p">(</span><span class="n">stationarity_kpss_test</span><span class="p">(</span><span class="n">candidate_final</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="p">[]))</span>
<span class="n">sm</span><span class="o">.</span><span class="n">graphics</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">plot_acf</span><span class="p">(</span><span class="n">candidate_final</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">use_vlines</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Stationarity_adf</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Test Statistics</th>
      <td>0.82</td>
    </tr>
    <tr>
      <th>p-value</th>
      <td>0.99</td>
    </tr>
    <tr>
      <th>Used Lag</th>
      <td>13.00</td>
    </tr>
    <tr>
      <th>Used Observations</th>
      <td>130.00</td>
    </tr>
    <tr>
      <th>Critical Value(1%)</th>
      <td>-3.48</td>
    </tr>
    <tr>
      <th>Maximum Information Criteria</th>
      <td>996.69</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Stationarity_kpss</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Test Statistics</th>
      <td>1.05</td>
    </tr>
    <tr>
      <th>p-value</th>
      <td>0.01</td>
    </tr>
    <tr>
      <th>Used Lag</th>
      <td>14.00</td>
    </tr>
    <tr>
      <th>Critical Value(10%)</th>
      <td>0.35</td>
    </tr>
  </tbody>
</table>
</div></div><img alt="../_images/3_Algorithms_ML_TS_Linear_114_2.png" src="../_images/3_Algorithms_ML_TS_Linear_114_2.png" />
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Stationarity_adf</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Test Statistics</th>
      <td>-1.72</td>
    </tr>
    <tr>
      <th>p-value</th>
      <td>0.42</td>
    </tr>
    <tr>
      <th>Used Lag</th>
      <td>13.00</td>
    </tr>
    <tr>
      <th>Used Observations</th>
      <td>130.00</td>
    </tr>
    <tr>
      <th>Critical Value(1%)</th>
      <td>-3.48</td>
    </tr>
    <tr>
      <th>Maximum Information Criteria</th>
      <td>-445.40</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Stationarity_kpss</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Test Statistics</th>
      <td>1.05</td>
    </tr>
    <tr>
      <th>p-value</th>
      <td>0.01</td>
    </tr>
    <tr>
      <th>Used Lag</th>
      <td>14.00</td>
    </tr>
    <tr>
      <th>Critical Value(10%)</th>
      <td>0.35</td>
    </tr>
  </tbody>
</table>
</div></div><img alt="../_images/3_Algorithms_ML_TS_Linear_114_5.png" src="../_images/3_Algorithms_ML_TS_Linear_114_5.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Trend Difference:  1
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Stationarity_adf</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Test Statistics</th>
      <td>-2.72</td>
    </tr>
    <tr>
      <th>p-value</th>
      <td>0.07</td>
    </tr>
    <tr>
      <th>Used Lag</th>
      <td>14.00</td>
    </tr>
    <tr>
      <th>Used Observations</th>
      <td>128.00</td>
    </tr>
    <tr>
      <th>Critical Value(1%)</th>
      <td>-3.48</td>
    </tr>
    <tr>
      <th>Maximum Information Criteria</th>
      <td>-440.36</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Stationarity_kpss</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Test Statistics</th>
      <td>0.10</td>
    </tr>
    <tr>
      <th>p-value</th>
      <td>0.10</td>
    </tr>
    <tr>
      <th>Used Lag</th>
      <td>14.00</td>
    </tr>
    <tr>
      <th>Critical Value(10%)</th>
      <td>0.35</td>
    </tr>
  </tbody>
</table>
</div></div><img alt="../_images/3_Algorithms_ML_TS_Linear_114_9.png" src="../_images/3_Algorithms_ML_TS_Linear_114_9.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Seasonal Difference:  12
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Stationarity_adf</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Test Statistics</th>
      <td>-4.44</td>
    </tr>
    <tr>
      <th>p-value</th>
      <td>0.00</td>
    </tr>
    <tr>
      <th>Used Lag</th>
      <td>12.00</td>
    </tr>
    <tr>
      <th>Used Observations</th>
      <td>118.00</td>
    </tr>
    <tr>
      <th>Critical Value(1%)</th>
      <td>-3.49</td>
    </tr>
    <tr>
      <th>Maximum Information Criteria</th>
      <td>-415.56</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Stationarity_kpss</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Test Statistics</th>
      <td>0.11</td>
    </tr>
    <tr>
      <th>p-value</th>
      <td>0.10</td>
    </tr>
    <tr>
      <th>Used Lag</th>
      <td>13.00</td>
    </tr>
    <tr>
      <th>Critical Value(10%)</th>
      <td>0.35</td>
    </tr>
  </tbody>
</table>
</div></div><img alt="../_images/3_Algorithms_ML_TS_Linear_114_13.png" src="../_images/3_Algorithms_ML_TS_Linear_114_13.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## 최종 타겟 선정 및 Train/Test 데이터 분리</span>
<span class="n">candidate</span> <span class="o">=</span> <span class="n">candidate_trend</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">split_date</span> <span class="o">=</span> <span class="s1">&#39;1958-01-01&#39;</span>
<span class="n">Y_train</span> <span class="o">=</span> <span class="n">candidate</span><span class="p">[</span><span class="n">candidate</span><span class="o">.</span><span class="n">index</span> <span class="o">&lt;</span> <span class="n">split_date</span><span class="p">]</span>
<span class="n">Y_test</span> <span class="o">=</span> <span class="n">candidate</span><span class="p">[</span><span class="n">candidate</span><span class="o">.</span><span class="n">index</span> <span class="o">&gt;=</span> <span class="n">split_date</span><span class="p">]</span>

<span class="c1">## 시각화 및 모수추론(p=1, q=0, d=1, P=1, Q=1, D(m)=12)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="n">sm</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">graphics</span><span class="o">.</span><span class="n">plot_acf</span><span class="p">(</span><span class="n">Y_train</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">use_vlines</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">121</span><span class="p">))</span>
<span class="n">sm</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">graphics</span><span class="o">.</span><span class="n">plot_pacf</span><span class="p">(</span><span class="n">Y_train</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">use_vlines</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">122</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># 모델링</span>
<span class="c1">## SARIMAX</span>
<span class="n">logarithm</span><span class="p">,</span> <span class="n">differencing</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span>
<span class="c1"># fit_ts_sarimax = sm.tsa.SARIMAX(Y_train, order=(1,trend_diff_order,0), trend=&#39;ct&#39;).fit()</span>
<span class="c1"># fit_ts_sarimax = sm.tsa.SARIMAX(Y_train, order=(1,trend_diff_order,0), </span>
<span class="c1">#                                 seasonal_order=(0,0,1,seasonal_diff_order), trend=&#39;c&#39;).fit()</span>
<span class="c1"># fit_ts_sarimax = sm.tsa.SARIMAX(Y_train, order=(1,trend_diff_order,0), </span>
<span class="c1">#                                 seasonal_order=(1,0,0,seasonal_diff_order), trend=&#39;c&#39;).fit()</span>
<span class="n">fit_ts_sarimax</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">SARIMAX</span><span class="p">(</span><span class="n">Y_train</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">trend_diff_order</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> 
                                <span class="n">seasonal_order</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">seasonal_diff_order</span><span class="p">),</span> <span class="n">trend</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">display</span><span class="p">(</span><span class="n">fit_ts_sarimax</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
<span class="n">pred_tr_ts_sarimax</span> <span class="o">=</span> <span class="n">fit_ts_sarimax</span><span class="o">.</span><span class="n">predict</span><span class="p">()</span>
<span class="n">pred_te_ts_sarimax</span> <span class="o">=</span> <span class="n">fit_ts_sarimax</span><span class="o">.</span><span class="n">get_forecast</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">Y_test</span><span class="p">))</span><span class="o">.</span><span class="n">predicted_mean</span>
<span class="n">pred_te_ts_sarimax_ci</span> <span class="o">=</span> <span class="n">fit_ts_sarimax</span><span class="o">.</span><span class="n">get_forecast</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">Y_test</span><span class="p">))</span><span class="o">.</span><span class="n">conf_int</span><span class="p">()</span>
<span class="c1">## 비정상성으로 변환</span>
<span class="k">if</span> <span class="n">logarithm</span><span class="p">:</span>
    <span class="n">Y_train</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">Y_train</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">Y_test</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">Y_test</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">pred_tr_ts_sarimax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">pred_tr_ts_sarimax</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">pred_te_ts_sarimax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">pred_te_ts_sarimax</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">pred_te_ts_sarimax_ci</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">pred_te_ts_sarimax_ci</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="k">if</span> <span class="n">differencing</span><span class="p">:</span>
    <span class="n">pred_tr_ts_sarimax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">pred_tr_ts_sarimax</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    
<span class="c1"># 검증</span>
<span class="o">%</span><span class="k">reload_ext</span> autoreload
<span class="o">%</span><span class="k">autoreload</span> 2
<span class="kn">from</span> <span class="nn">module</span> <span class="kn">import</span> <span class="o">*</span>
<span class="n">Score_ts_sarimax</span><span class="p">,</span> <span class="n">Resid_tr_ts_sarimax</span><span class="p">,</span> <span class="n">Resid_te_ts_sarimax</span> <span class="o">=</span> <span class="n">evaluation_trte</span><span class="p">(</span><span class="n">Y_train</span><span class="p">,</span> <span class="n">pred_tr_ts_sarimax</span><span class="p">,</span> 
                                                                             <span class="n">Y_test</span><span class="p">,</span> <span class="n">pred_te_ts_sarimax</span><span class="p">,</span> <span class="n">graph_on</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">Score_ts_sarimax</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">Y_test</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">pred_te_ts_sarimax</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">Y_test</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;prediction&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;line&#39;</span><span class="p">,</span>
                                                                           <span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="n">Y_test</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span><span class="n">Y_test</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">max</span><span class="p">()),</span>
                                                                           <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">pred_te_ts_sarimax_ci</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">Y_test</span><span class="o">.</span><span class="n">index</span><span class="p">)</span><span class="o">.</span><span class="n">index</span><span class="p">,</span>
                <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">pred_te_ts_sarimax_ci</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">Y_test</span><span class="o">.</span><span class="n">index</span><span class="p">)</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span>
                <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">pred_te_ts_sarimax_ci</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">Y_test</span><span class="o">.</span><span class="n">index</span><span class="p">)</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.15</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># 잔차진단</span>
<span class="n">error_analysis</span><span class="p">(</span><span class="n">Resid_tr_ts_sarimax</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;Error&#39;</span><span class="p">],</span> <span class="n">Y_train</span><span class="p">,</span> <span class="n">graph_on</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/3_Algorithms_ML_TS_Linear_115_0.png" src="../_images/3_Algorithms_ML_TS_Linear_115_0.png" />
<div class="output text_html"><table class="simpletable">
<caption>SARIMAX Results</caption>
<tr>
  <th>Dep. Variable:</th>                 <td>value</td>              <th>  No. Observations:  </th>    <td>108</td>  
</tr>
<tr>
  <th>Model:</th>           <td>SARIMAX(1, 1, 0)x(1, 0, [1], 12)</td> <th>  Log Likelihood     </th>  <td>184.253</td>
</tr>
<tr>
  <th>Date:</th>                    <td>Fri, 31 Jul 2020</td>         <th>  AIC                </th> <td>-358.506</td>
</tr>
<tr>
  <th>Time:</th>                        <td>22:46:49</td>             <th>  BIC                </th> <td>-345.142</td>
</tr>
<tr>
  <th>Sample:</th>                     <td>01-31-1949</td>            <th>  HQIC               </th> <td>-353.089</td>
</tr>
<tr>
  <th></th>                           <td>- 12-31-1957</td>           <th>                     </th>     <td> </td>   
</tr>
<tr>
  <th>Covariance Type:</th>                <td>opg</td>               <th>                     </th>     <td> </td>   
</tr>
</table>
<table class="simpletable">
<tr>
      <td></td>         <th>coef</th>     <th>std err</th>      <th>z</th>      <th>P>|z|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>intercept</th> <td>    0.0001</td> <td>    0.000</td> <td>    0.330</td> <td> 0.741</td> <td>   -0.001</td> <td>    0.001</td>
</tr>
<tr>
  <th>ar.L1</th>     <td>   -0.2676</td> <td>    0.080</td> <td>   -3.352</td> <td> 0.001</td> <td>   -0.424</td> <td>   -0.111</td>
</tr>
<tr>
  <th>ar.S.L12</th>  <td>    0.9907</td> <td>    0.008</td> <td>  120.894</td> <td> 0.000</td> <td>    0.975</td> <td>    1.007</td>
</tr>
<tr>
  <th>ma.S.L12</th>  <td>   -0.6113</td> <td>    0.114</td> <td>   -5.341</td> <td> 0.000</td> <td>   -0.836</td> <td>   -0.387</td>
</tr>
<tr>
  <th>sigma2</th>    <td>    0.0014</td> <td>    0.000</td> <td>    7.243</td> <td> 0.000</td> <td>    0.001</td> <td>    0.002</td>
</tr>
</table>
<table class="simpletable">
<tr>
  <th>Ljung-Box (Q):</th>          <td>40.18</td> <th>  Jarque-Bera (JB):  </th> <td>0.23</td>
</tr>
<tr>
  <th>Prob(Q):</th>                <td>0.46</td>  <th>  Prob(JB):          </th> <td>0.89</td>
</tr>
<tr>
  <th>Heteroskedasticity (H):</th> <td>0.39</td>  <th>  Skew:              </th> <td>0.09</td>
</tr>
<tr>
  <th>Prob(H) (two-sided):</th>    <td>0.01</td>  <th>  Kurtosis:          </th> <td>3.15</td>
</tr>
</table><br/><br/>Warnings:<br/>[1] Covariance matrix calculated using the outer product of gradients (complex-step).</div><div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>MAE</th>
      <th>MSE</th>
      <th>MAPE</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Train</th>
      <td>8.27</td>
      <td>197.76</td>
      <td>4.53</td>
    </tr>
    <tr>
      <th>Test</th>
      <td>26.96</td>
      <td>910.97</td>
      <td>6.63</td>
    </tr>
  </tbody>
</table>
</div></div><img alt="../_images/3_Algorithms_ML_TS_Linear_115_3.png" src="../_images/3_Algorithms_ML_TS_Linear_115_3.png" />
<img alt="../_images/3_Algorithms_ML_TS_Linear_115_4.png" src="../_images/3_Algorithms_ML_TS_Linear_115_4.png" />
<img alt="../_images/3_Algorithms_ML_TS_Linear_115_5.png" src="../_images/3_Algorithms_ML_TS_Linear_115_5.png" />
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>*c* argument looks like a single numeric RGB or RGBA sequence, which should be avoided as value-mapping will have precedence in case its length matches with *x* &amp; *y*.  Please use the *color* keyword-argument or provide a 2-D array with a single row if you intend to specify the same RGB or RGBA value for all points.
*c* argument looks like a single numeric RGB or RGBA sequence, which should be avoided as value-mapping will have precedence in case its length matches with *x* &amp; *y*.  Please use the *color* keyword-argument or provide a 2-D array with a single row if you intend to specify the same RGB or RGBA value for all points.
*c* argument looks like a single numeric RGB or RGBA sequence, which should be avoided as value-mapping will have precedence in case its length matches with *x* &amp; *y*.  Please use the *color* keyword-argument or provide a 2-D array with a single row if you intend to specify the same RGB or RGBA value for all points.
*c* argument looks like a single numeric RGB or RGBA sequence, which should be avoided as value-mapping will have precedence in case its length matches with *x* &amp; *y*.  Please use the *color* keyword-argument or provide a 2-D array with a single row if you intend to specify the same RGB or RGBA value for all points.
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Stationarity_adf</th>
      <th>Stationarity_kpss</th>
      <th>Normality</th>
      <th>Autocorr(lag1)</th>
      <th>Autocorr(lag5)</th>
      <th>Autocorr(lag10)</th>
      <th>Autocorr(lag50)</th>
      <th>Heteroscedasticity</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Test Statistics</th>
      <td>-7.45</td>
      <td>0.33</td>
      <td>0.69</td>
      <td>0.34</td>
      <td>4.17</td>
      <td>12.70</td>
      <td>29.56</td>
      <td>0.23</td>
    </tr>
    <tr>
      <th>p-value</th>
      <td>0.00</td>
      <td>0.10</td>
      <td>0.00</td>
      <td>0.56</td>
      <td>0.53</td>
      <td>0.24</td>
      <td>0.99</td>
      <td>0.00</td>
    </tr>
    <tr>
      <th>Used Lag</th>
      <td>3.00</td>
      <td>13.00</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Used Observations</th>
      <td>104.00</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Critical Value(1%)</th>
      <td>-3.49</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Maximum Information Criteria</th>
      <td>677.41</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Critical Value(10%)</th>
      <td>nan</td>
      <td>0.35</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Alternative</th>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>two-sided</td>
    </tr>
  </tbody>
</table>
</div></div><img alt="../_images/3_Algorithms_ML_TS_Linear_115_8.png" src="../_images/3_Algorithms_ML_TS_Linear_115_8.png" />
<img alt="../_images/3_Algorithms_ML_TS_Linear_115_9.png" src="../_images/3_Algorithms_ML_TS_Linear_115_9.png" />
<img alt="../_images/3_Algorithms_ML_TS_Linear_115_10.png" src="../_images/3_Algorithms_ML_TS_Linear_115_10.png" />
<img alt="../_images/3_Algorithms_ML_TS_Linear_115_11.png" src="../_images/3_Algorithms_ML_TS_Linear_115_11.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># ## 최종 타겟 선정 및 Train/Test 데이터 분리</span>
<span class="c1"># candidate = candidate_trend.copy()</span>
<span class="c1"># split_date = &#39;1958-01-01&#39;</span>
<span class="c1"># Y_train = candidate[candidate.index &lt; split_date]</span>
<span class="c1"># Y_test = candidate[candidate.index &gt;= split_date]</span>

<span class="c1"># ## 시각화 및 모수추론(p=1, q=0, d=1, P=1, Q=1, D(m)=12)</span>
<span class="c1"># plt.figure(figsize=(14,4))</span>
<span class="c1"># sm.tsa.graphics.plot_acf(Y_train, lags=50, alpha=0.05, use_vlines=True, ax=plt.subplot(121))</span>
<span class="c1"># sm.tsa.graphics.plot_pacf(Y_train, lags=50, alpha=0.05, use_vlines=True, ax=plt.subplot(122))</span>
<span class="c1"># plt.show()</span>

<span class="c1"># # 모델링</span>
<span class="c1"># ## Auto-ARIMA</span>
<span class="c1"># logarithm, differencing = True, False</span>
<span class="c1"># fit_ts_autoarima = auto_arima(Y_train, stationary=False,</span>
<span class="c1">#                               trend=&#39;c&#39;, start_p=0, start_q=0, max_p=5, max_q=5, max_d=3,</span>
<span class="c1">#                               seasonal=True, start_P=0, start_Q=0, max_P=5, max_Q=5, m=seasonal_diff_order,</span>
<span class="c1">#                               stepwise=True, trace=True)</span>
<span class="c1"># display(fit_ts_autoarima.summary())</span>
<span class="c1"># pred_tr_ts_autoarima = fit_ts_autoarima.predict_in_sample()</span>
<span class="c1"># pred_te_ts_autoarima = fit_ts_autoarima.predict(len(Y_test), return_conf_int=True)[0]</span>
<span class="c1"># pred_te_ts_autoarima_ci = fit_ts_autoarima.predict(len(Y_test), return_conf_int=True)[1]</span>
<span class="c1"># ## 비정상성으로 변환</span>
<span class="c1"># if logarithm:</span>
<span class="c1">#     Y_train = np.exp(Y_train).copy()</span>
<span class="c1">#     Y_test = np.exp(Y_test).copy()</span>
<span class="c1">#     pred_tr_ts_autoarima = np.exp(pred_tr_ts_autoarima).copy()</span>
<span class="c1">#     pred_te_ts_autoarima = np.exp(pred_te_ts_autoarima).copy()</span>
<span class="c1">#     pred_te_ts_autoarima_ci = np.exp(pred_te_ts_autoarima_ci).copy()</span>
<span class="c1"># if differencing:</span>
<span class="c1">#     pred_tr_ts_autoarima = np.cumsum(pred_tr_ts_autoarima).copy()</span>
    
<span class="c1"># # 검증</span>
<span class="c1"># %reload_ext autoreload</span>
<span class="c1"># %autoreload 2</span>
<span class="c1"># from module import *</span>
<span class="c1"># Score_ts_autoarima, Resid_tr_ts_autoarima, Resid_te_ts_autoarima = evaluation_trte(Y_train, pred_tr_ts_autoarima, </span>
<span class="c1">#                                                                              Y_test, pred_te_ts_autoarima, graph_on=True)</span>
<span class="c1"># display(Score_ts_autoarima)</span>
<span class="c1"># ax = pd.DataFrame(Y_test).plot(figsize=(12,4))</span>
<span class="c1"># pd.DataFrame(pred_te_ts_autoarima, index=Y_test.index, columns=[&#39;prediction&#39;]).plot(kind=&#39;line&#39;,</span>
<span class="c1">#                                                                            xlim=(Y_test.index.min(),Y_test.index.max()),</span>
<span class="c1">#                                                                            linewidth=3, fontsize=20, ax=ax)</span>
<span class="c1"># ax.fill_between(pd.DataFrame(pred_te_ts_autoarima_ci, index=Y_test.index).index,</span>
<span class="c1">#                 pd.DataFrame(pred_te_ts_autoarima_ci, index=Y_test.index).iloc[:,0],</span>
<span class="c1">#                 pd.DataFrame(pred_te_ts_autoarima_ci, index=Y_test.index).iloc[:,1], color=&#39;k&#39;, alpha=0.15)</span>
<span class="c1"># plt.show()</span>

<span class="c1"># # 잔차진단</span>
<span class="c1"># error_analysis(Resid_tr_ts_autoarima, [&#39;Error&#39;], Y_train, graph_on=True)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./TimeSeriesData"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="2_Learning_TimeSeries.html" title="previous page">학습방향과 알고리즘(Learning Style and Algorithms)</a>
    <a class='right-next' id="next-link" href="4_Algorithms_TS_NonLinear.html" title="next page">비선형 시계열 알고리즘</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Raphael Kim<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="../_static/js/index.3da636dd464baa7582d2.js"></script>


    
  </body>
</html>